<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>双的鱼博客</title>
  
  <subtitle>想起那天夕陽下的奔跑，那是我逝去的青春</subtitle>
  <link href="https://shuangdeyu.github.io/atom.xml" rel="self"/>
  
  <link href="https://shuangdeyu.github.io/"/>
  <updated>2024-05-15T08:52:06.865Z</updated>
  <id>https://shuangdeyu.github.io/</id>
  
  <author>
    <name>JIANG XIAOFAN</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>通过wix4制作golang程序的windows安装包</title>
    <link href="https://shuangdeyu.github.io/2024/05/15/tong-guo-wix4-zhi-zuo-golang-cheng-xu-de-windows-an-zhuang-bao/"/>
    <id>https://shuangdeyu.github.io/2024/05/15/tong-guo-wix4-zhi-zuo-golang-cheng-xu-de-windows-an-zhuang-bao/</id>
    <published>2024-05-14T16:00:00.000Z</published>
    <updated>2024-05-15T08:52:06.865Z</updated>
    
    <content type="html"><![CDATA[<h2 id="以系统服务运行程序"><a href="#以系统服务运行程序" class="headerlink" title="以系统服务运行程序"></a>以系统服务运行程序</h2><p>在windows上运行golang程序的时候总会有一个令人讨厌的运行窗口，我们可以使用第三方库来将程序以windows系统服务的方式运行。<br />使用库：<a href="https://github.com/kardianos/service">https://github.com/kardianos/service</a><br />直接来看库里的简单示例：<a href="https://github.com/kardianos/service/blob/master/example/simple/main.go">https://github.com/kardianos/service/blob/master/example/simple/main.go</a></p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// simple does nothing except block while running the service.</span><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">"log"</span><span class="token string">"github.com/kardianos/service"</span><span class="token punctuation">)</span><span class="token keyword">var</span> logger service<span class="token punctuation">.</span>Logger<span class="token keyword">type</span> program <span class="token keyword">struct</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>program<span class="token punctuation">)</span> <span class="token function">Start</span><span class="token punctuation">(</span>s service<span class="token punctuation">.</span>Service<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">&#123;</span><span class="token comment">// Start should not block. Do the actual work async.</span><span class="token keyword">go</span> p<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>program<span class="token punctuation">)</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Do work here</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>program<span class="token punctuation">)</span> <span class="token function">Stop</span><span class="token punctuation">(</span>s service<span class="token punctuation">.</span>Service<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">&#123;</span><span class="token comment">// Stop should not block. Return with a few seconds.</span><span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">&#125;</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>svcConfig <span class="token operator">:=</span> <span class="token operator">&amp;</span>service<span class="token punctuation">.</span>Config<span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span>        <span class="token string">"GoServiceExampleSimple"</span><span class="token punctuation">,</span>DisplayName<span class="token punctuation">:</span> <span class="token string">"Go Service Example"</span><span class="token punctuation">,</span>Description<span class="token punctuation">:</span> <span class="token string">"This is an example Go service."</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>prg <span class="token operator">:=</span> <span class="token operator">&amp;</span>program<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>s<span class="token punctuation">,</span> err <span class="token operator">:=</span> service<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>prg<span class="token punctuation">,</span> svcConfig<span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>logger<span class="token punctuation">,</span> err <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>err <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>logger<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>在上述代码中，我们首先创建了一个<code>program</code>结构体，并实现了<code>Service</code>接口的<code>Start</code>和<code>Stop</code>方法。<br />在<code>Start</code>方法中，我们启动了一个协程来执行实际的服务逻辑。<br /><code>run</code>方法就是你自己的服务逻辑代码，你可以在其中编写你需要的功能。<br />然后，我们创建了一个<code>Config</code>对象来配置服务的名称、显示名称和描述。<br />接下来，我们创建了一个<code>Service</code>对象并使用<code>New</code>函数初始化。<br />最后，我们调用<code>Run</code>方法来以服务方式运行我们的程序。</p><p>在命令行中，你可以使用以下命令将Go程序编译为Windows服务：</p><pre class="language-bash" data-language="bash"><code class="language-bash">go build <span class="token parameter variable">-o</span> main.exe</code></pre><p><code>main.exe</code>是生成的服务可执行文件的名称。<br />然后，你可以使用以下命令来安装服务：</p><pre class="language-bash" data-language="bash"><code class="language-bash">main.exe <span class="token function">install</span></code></pre><p>安装成功后，你可以使用以下命令来启动、停止或卸载服务：</p><pre class="language-bash" data-language="bash"><code class="language-bash">main.exe startmain.exe stopmain.exe uninstall</code></pre><p>但是实际使用中会有点不同，我们只需要在windows下进行服务化就行了，mac和linux本身就有服务化运行的方式，不用多次一举，所以需要判定下系统环境：</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>runtime<span class="token punctuation">.</span><span class="token function">GOMAXPROCS</span><span class="token punctuation">(</span>runtime<span class="token punctuation">.</span><span class="token function">NumCPU</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>prg <span class="token operator">:=</span> <span class="token operator">&amp;</span>program<span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> runtime<span class="token punctuation">.</span>GOOS <span class="token operator">==</span> <span class="token string">"windows"</span> <span class="token punctuation">&#123;</span>svcConfig <span class="token operator">:=</span> <span class="token operator">&amp;</span>service<span class="token punctuation">.</span>Config<span class="token punctuation">&#123;</span>Name<span class="token punctuation">:</span>        <span class="token string">"User"</span><span class="token punctuation">,</span>DisplayName<span class="token punctuation">:</span> <span class="token string">"UserService"</span><span class="token punctuation">,</span>Description<span class="token punctuation">:</span> <span class="token string">"User Service."</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>s<span class="token punctuation">,</span> err <span class="token operator">:=</span> service<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>prg<span class="token punctuation">,</span> svcConfig<span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span><span class="token function">println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span>serviceLogger<span class="token punctuation">,</span> err <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">error</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span><span class="token function">println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Args<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token punctuation">&#123;</span>err <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">Control</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> os<span class="token punctuation">.</span>Args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>serviceLogger<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"Failed (%s) : %s\n"</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>Args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span>serviceLogger<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"Succeeded (%s)\n"</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>Args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span>err <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>serviceLogger<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"Run Failed : %s\n"</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>prg<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>类似于这样，不是windows的话，直接运行主流程逻辑<code>prg.run()</code>就行。</p><h2 id="安装wix4"><a href="#安装wix4" class="headerlink" title="安装wix4"></a>安装wix4</h2><p>wix最新的是版本5，其中4和5都是比较新的，3版本就比较老了，差异很大，不能直接拿来用，如果你们有老项目是用wix3打包的话，有个简单的方法可以将wix3的配置文件一键转换成wix4。<br />使用Visual Studio：<br /><img src="https://cdn.nlark.com/yuque/0/2024/png/115159/1715754661505-bc7a0645-a13c-4e01-82b5-a612500eb641.png#averageHue=%23ebeeed&clientId=u90aafb03-4b21-4&from=paste&height=1081&id=u48d8ef57&originHeight=2162&originWidth=3374&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1081959&status=done&style=none&taskId=u21d27d98-ac19-4d6f-959c-0c9106bac09&title=&width=1687" alt="image.png"><br />直接在右侧的解决方案管理器中右键项目就能看到“升级到wix4”的选项。</p><p>这是后续话题了，我们应该先安装好wix4，直接看官网文档：<a href="https://wixtoolset.org/docs/intro/">https://wixtoolset.org/docs/intro/</a><br /><img src="https://cdn.nlark.com/yuque/0/2024/png/115159/1715754976852-5cea1ba6-63f2-4ebd-92f3-3dc31b4eaf31.png#averageHue=%2351524e&clientId=u90aafb03-4b21-4&from=paste&height=539&id=ufda71e92&originHeight=1078&originWidth=2024&originalType=binary&ratio=2&rotation=0&showTitle=false&size=180644&status=done&style=none&taskId=u2c1ac726-0f43-4647-bcda-ef05a6b6c58&title=&width=1012" alt="截屏2024-05-15 14.35.55.png"><br />是说wix4已经加入了NET工具，使用NET指令安装即可，安装完打印下版本号检查下是否安装成功。</p><p>然后在windows上下载 visual studio 2022 ，这个IDE完全支持wix的编辑和运行。<br />首先打开空白的vs，点击顶部选项栏里的“扩展”-&gt;“管理扩展”，在“联机”一栏里搜索“wix”，安装wix插件：<br /><img src="https://cdn.nlark.com/yuque/0/2024/png/115159/1715755743395-ef12b613-e4ce-4d25-9766-bd819226063e.png#averageHue=%23e6ebe9&clientId=u90aafb03-4b21-4&from=paste&height=673&id=u3faff5e4&originHeight=1346&originWidth=1938&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1025025&status=done&style=none&taskId=u4af5faa8-a18d-4bd6-b8f0-9fa159388b1&title=&width=969" alt="image.png"><br />HeatWave是制作WiX脚本的辅助工具。</p><h2 id="制作配置文件"><a href="#制作配置文件" class="headerlink" title="制作配置文件"></a>制作配置文件</h2><p>刚开始的时候全程使用vs来编辑wix配置文件，可以便修改便验证，主要是方便，因为制作过程中是不可能一帆风顺的。</p><p>创建新项目，选择MSI模板，创建完成就会进入编辑界面，左边是文件编辑界面，右边是解决方案管理界面，这里就不放了<br /><img src="https://cdn.nlark.com/yuque/0/2024/png/115159/1715756921225-9d24e825-aa12-4713-bea7-4a952bc2c972.png#averageHue=%23ddd3c2&clientId=u90aafb03-4b21-4&from=paste&height=695&id=u13e3cc0c&originHeight=1390&originWidth=2080&originalType=binary&ratio=2&rotation=0&showTitle=false&size=700488&status=done&style=none&taskId=u05a145fb-1312-4d55-9217-138f9aa2163&title=&width=1040" alt="image.png"></p><p>然后在解决方案管理界面，右键“依赖项”-&gt;“管理NuGet程序包”，安装必要的插件，安装好之后，配置文件自动会同步更新，这里安装下面三个，选择对应的4版本</p><ul><li>WixToolset.Heat</li><li>WixToolset.UI.wixext</li><li>WixToolset.Util.wixext</li></ul><p><img src="https://cdn.nlark.com/yuque/0/2024/png/115159/1715757665486-60fa585d-bf22-4539-b7f5-5ea105e11365.png#averageHue=%23e3e8e8&clientId=u90aafb03-4b21-4&from=paste&height=1058&id=ub9d08a55&originHeight=2116&originWidth=3392&originalType=binary&ratio=2&rotation=0&showTitle=false&size=2371034&status=done&style=none&taskId=u0c14c363-060a-4590-a8af-fe477ebcf8b&title=&width=1696" alt="image.png"></p><p>然后就是根据项目需求进行对应的配置编辑了。<br />这里我直接放示例，然后再挑重点说明一下。</p><h3 id="userService-wixproj"><a href="#userService-wixproj" class="headerlink" title="userService.wixproj"></a>userService.wixproj</h3><pre class="language-go" data-language="go"><code class="language-go"><span class="token operator">&lt;</span>Project Sdk<span class="token operator">=</span><span class="token string">"WixToolset.Sdk/4.0.5"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>ItemGroup<span class="token operator">></span>        <span class="token operator">&lt;</span>PackageReference Include<span class="token operator">=</span><span class="token string">"WixToolset.Heat"</span> Version<span class="token operator">=</span><span class="token string">"4.0.5"</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span>PackageReference Include<span class="token operator">=</span><span class="token string">"WixToolset.UI.wixext"</span> Version<span class="token operator">=</span><span class="token string">"4.0.5"</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span>PackageReference Include<span class="token operator">=</span><span class="token string">"WixToolset.Util.wixext"</span> Version<span class="token operator">=</span><span class="token string">"4.0.5"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>ItemGroup<span class="token operator">></span>    <span class="token operator">&lt;</span>PropertyGroup<span class="token operator">></span>        <span class="token operator">&lt;</span>DefineConstants<span class="token operator">></span>BasePath<span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\build\win<span class="token operator">&lt;</span><span class="token operator">/</span>DefineConstants<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>PropertyGroup<span class="token operator">></span>    <span class="token operator">&lt;</span>PropertyGroup Condition<span class="token operator">=</span><span class="token string">"'$(Configuration)|$(Platform)'=='Debug|x86'"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>Cultures<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>Cultures<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>PropertyGroup<span class="token operator">></span>    <span class="token operator">&lt;</span>ItemGroup<span class="token operator">></span>        <span class="token operator">&lt;</span>Content Include<span class="token operator">=</span><span class="token string">"filter.xslt"</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span>Content Include<span class="token operator">=</span><span class="token string">"assets/UserService.ico"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>ItemGroup<span class="token operator">></span>    <span class="token operator">&lt;</span>ItemGroup<span class="token operator">></span>        <span class="token operator">&lt;</span>HarvestDirectory Include<span class="token operator">=</span><span class="token string">"..\build\win"</span><span class="token operator">></span>            <span class="token operator">&lt;</span>ComponentGroupName<span class="token operator">></span>PublishedComponents<span class="token operator">&lt;</span><span class="token operator">/</span>ComponentGroupName<span class="token operator">></span>            <span class="token operator">&lt;</span>DirectoryRefId<span class="token operator">></span>INSTALLFOLDER<span class="token operator">&lt;</span><span class="token operator">/</span>DirectoryRefId<span class="token operator">></span>            <span class="token operator">&lt;</span>SuppressRootDirectory<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>SuppressRootDirectory<span class="token operator">></span>            <span class="token operator">&lt;</span>KeepEmptyDirectories<span class="token operator">></span><span class="token boolean">false</span><span class="token operator">&lt;</span><span class="token operator">/</span>KeepEmptyDirectories<span class="token operator">></span>            <span class="token operator">&lt;</span>SuppressRegistry<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>SuppressRegistry<span class="token operator">></span>            <span class="token operator">&lt;</span>PreprocessorVariable<span class="token operator">></span><span class="token keyword">var</span><span class="token punctuation">.</span>BasePath<span class="token operator">&lt;</span><span class="token operator">/</span>PreprocessorVariable<span class="token operator">></span>            <span class="token operator">&lt;</span>SuppressCom<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>SuppressCom<span class="token operator">></span>            <span class="token operator">&lt;</span>Transforms<span class="token operator">></span>filter<span class="token punctuation">.</span>xslt<span class="token operator">&lt;</span><span class="token operator">/</span>Transforms<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>HarvestDirectory<span class="token operator">></span>        <span class="token operator">&lt;</span>BindPath Include<span class="token operator">=</span><span class="token string">"..\build\win"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>ItemGroup<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Project<span class="token operator">></span></code></pre><p>这个是项目主配置文件，其文件名决定了最终生成的安装包的名称，比如 userService.wixproj 最终生成的msi安装包是 <strong>userService.msi</strong></p><p>这里比较重要的是这一串：</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token operator">&lt;</span>ItemGroup<span class="token operator">></span>    <span class="token operator">&lt;</span>HarvestDirectory Include<span class="token operator">=</span><span class="token string">"..\build\win"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>ComponentGroupName<span class="token operator">></span>PublishedComponents<span class="token operator">&lt;</span><span class="token operator">/</span>ComponentGroupName<span class="token operator">></span>        <span class="token operator">&lt;</span>DirectoryRefId<span class="token operator">></span>INSTALLFOLDER<span class="token operator">&lt;</span><span class="token operator">/</span>DirectoryRefId<span class="token operator">></span>        <span class="token operator">&lt;</span>SuppressRootDirectory<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>SuppressRootDirectory<span class="token operator">></span>        <span class="token operator">&lt;</span>KeepEmptyDirectories<span class="token operator">></span><span class="token boolean">false</span><span class="token operator">&lt;</span><span class="token operator">/</span>KeepEmptyDirectories<span class="token operator">></span>        <span class="token operator">&lt;</span>SuppressRegistry<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>SuppressRegistry<span class="token operator">></span>        <span class="token operator">&lt;</span>PreprocessorVariable<span class="token operator">></span><span class="token keyword">var</span><span class="token punctuation">.</span>BasePath<span class="token operator">&lt;</span><span class="token operator">/</span>PreprocessorVariable<span class="token operator">></span>        <span class="token operator">&lt;</span>SuppressCom<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>SuppressCom<span class="token operator">></span>        <span class="token operator">&lt;</span>Transforms<span class="token operator">></span>filter<span class="token punctuation">.</span>xslt<span class="token operator">&lt;</span><span class="token operator">/</span>Transforms<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>HarvestDirectory<span class="token operator">></span>    <span class="token operator">&lt;</span>BindPath Include<span class="token operator">=</span><span class="token string">"..\build\win"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>ItemGroup<span class="token operator">></span></code></pre><p>作用是将项目中“**..\build\win**”下的内容打包进msi包，比如前端静态文件，将其打包进去，安装后才会重新生成，否则没有前端文件，将无法访问前端界面。</p><h3 id="package-wxs"><a href="#package-wxs" class="headerlink" title="package.wxs"></a>package.wxs</h3><p>这个是安装包配置文件，配置安装包安装过程中的UI、逻辑等，由于需要着重说明的比较多，我直接在代码上注释了</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token operator">&lt;</span>Wix xmlns<span class="token operator">=</span><span class="token string">"http://wixtoolset.org/schemas/v4/wxs"</span><span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 定义常量 <span class="token operator">--</span><span class="token operator">></span>  <span class="token operator">&lt;</span>?define UpgradeCode <span class="token operator">=</span> <span class="token string">"bc1adac3-47ed-4374-9c21-1298243b6ed7"</span> ?<span class="token operator">></span>  <span class="token operator">&lt;</span>?define BuildVersion <span class="token operator">=</span> <span class="token string">"1.0.0.0"</span> ?<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 可以定义安装界面显示的名称、语言、版本号等属性 <span class="token operator">--</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Package Name<span class="token operator">=</span><span class="token string">"!(loc.ProductName)"</span> Language<span class="token operator">=</span><span class="token string">"!(loc.Language)"</span> Manufacturer<span class="token operator">=</span><span class="token string">"!(loc.CompanyName)"</span> Version<span class="token operator">=</span><span class="token string">"$(var.BuildVersion)"</span> UpgradeCode<span class="token operator">=</span><span class="token string">"$(var.UpgradeCode)"</span> Codepage<span class="token operator">=</span><span class="token string">"65001"</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 定义安装包摘要信息（Summary Information）的一部分 <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span>SummaryInformation Manufacturer<span class="token operator">=</span><span class="token string">"!(loc.CompanyName)"</span> Description<span class="token operator">=</span><span class="token string">"!(loc.Description)"</span> Keywords<span class="token operator">=</span><span class="token string">"!(loc.Keywords)"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 这行代码表示在执行主要升级时，如果发生了降级（即安装了旧版本），则显示从本地化字符串文件中读取的降级错误消息 <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span>MajorUpgrade DowngradeErrorMessage<span class="token operator">=</span><span class="token string">"!(loc.DowngradeError)"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 定义升级策略的一部分。它指定了在安装新版本时如何处理旧版本的升级 <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Id 属性用于指定升级代码 <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span>Upgrade Id<span class="token operator">=</span><span class="token string">"$(var.UpgradeCode)"</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指定特定版本的升级策略。在这里，它指定了升级的最低版本和最高版本 <span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> OnlyDetect 属性指示是否仅检测旧版本而不执行实际升级。在这里，它设置为 no，表示执行实际升级 <span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Property 属性指定了一个用于存储正在升级的旧版本号的属性名称 <span class="token operator">--</span><span class="token operator">></span>        <span class="token operator">&lt;</span>UpgradeVersion Minimum<span class="token operator">=</span><span class="token string">"0.0.0.1"</span> IncludeMinimum<span class="token operator">=</span><span class="token string">"yes"</span> OnlyDetect<span class="token operator">=</span><span class="token string">"no"</span> Maximum<span class="token operator">=</span><span class="token string">"$(var.BuildVersion)"</span> IncludeMaximum<span class="token operator">=</span><span class="token string">"no"</span> Property<span class="token operator">=</span><span class="token string">"OLDERVERSIONBEINGUPGRADED"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>Upgrade<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 定义媒体模板的一部分。媒体模板用于指定安装包在创建安装媒体（如安装 CD、DVD 或安装程序下载文件）时的行为 <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> EmbedCab 属性用于指定是否在安装媒体中嵌入 CAB 文件。CAB 文件是一种用于存储 Windows 安装程序文件的压缩文件格式。在这里，设置为 <span class="token string">"yes"</span> 表示应该将 CAB 文件嵌入到安装媒体中 <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span>MediaTemplate EmbedCab<span class="token operator">=</span><span class="token string">"yes"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>Icon Id<span class="token operator">=</span><span class="token string">"icon.ico"</span> SourceFile<span class="token operator">=</span><span class="token string">"assets/userService.ico"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>Property Id<span class="token operator">=</span><span class="token string">"ARPPRODUCTICON"</span> Value<span class="token operator">=</span><span class="token string">"icon.ico"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 定义用户界面（UI） <span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span>UI Id<span class="token operator">=</span><span class="token string">"UserInterface"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>Property Id<span class="token operator">=</span><span class="token string">"WIXUI_INSTALLDIR"</span> Value<span class="token operator">=</span><span class="token string">"TARGETDIR"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>TextStyle Id<span class="token operator">=</span><span class="token string">"WixUI_Font_Normal"</span> FaceName<span class="token operator">=</span><span class="token string">"Tahoma"</span> Size<span class="token operator">=</span><span class="token string">"8"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>TextStyle Id<span class="token operator">=</span><span class="token string">"WixUI_Font_Bigger"</span> FaceName<span class="token operator">=</span><span class="token string">"Tahoma"</span> Size<span class="token operator">=</span><span class="token string">"12"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>TextStyle Id<span class="token operator">=</span><span class="token string">"WixUI_Font_Title"</span> FaceName<span class="token operator">=</span><span class="token string">"Tahoma"</span> Size<span class="token operator">=</span><span class="token string">"9"</span> Bold<span class="token operator">=</span><span class="token string">"yes"</span> Red<span class="token operator">=</span><span class="token string">"255"</span> Green<span class="token operator">=</span><span class="token string">"255"</span> Blue<span class="token operator">=</span><span class="token string">"255"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>Property Id<span class="token operator">=</span><span class="token string">"DefaultUIFont"</span> Value<span class="token operator">=</span><span class="token string">"WixUI_Font_Normal"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>Property Id<span class="token operator">=</span><span class="token string">"WixUI_Mode"</span> Value<span class="token operator">=</span><span class="token string">"Custom"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>DialogRef Id<span class="token operator">=</span><span class="token string">"ProgressDlg"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>DialogRef Id<span class="token operator">=</span><span class="token string">"ErrorDlg"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>DialogRef Id<span class="token operator">=</span><span class="token string">"FilesInUse"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>DialogRef Id<span class="token operator">=</span><span class="token string">"FatalError"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>DialogRef Id<span class="token operator">=</span><span class="token string">"UserExit"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>Publish Dialog<span class="token operator">=</span><span class="token string">"ExitDialog"</span> Control<span class="token operator">=</span><span class="token string">"Finish"</span> Event<span class="token operator">=</span><span class="token string">"EndDialog"</span> Value<span class="token operator">=</span><span class="token string">"Return"</span> Order<span class="token operator">=</span><span class="token string">"999"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span>Publish Dialog<span class="token operator">=</span><span class="token string">"WelcomeDlg"</span> Control<span class="token operator">=</span><span class="token string">"Next"</span> Event<span class="token operator">=</span><span class="token string">"EndDialog"</span> Value<span class="token operator">=</span><span class="token string">"Return"</span> Order<span class="token operator">=</span><span class="token string">"2"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Publish<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>UI<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 引用了一个名为 <span class="token string">"WixUI_Common"</span> 的预定义用户界面 <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 在使用 <span class="token operator">&lt;</span>UIRef<span class="token operator">></span> 元素引用预定义用户界面时，WiX 工具集会自动将相应的对话框和行为添加到您的安装程序项目中 <span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span>UIRef Id<span class="token operator">=</span><span class="token string">"WixUI_Common"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置安装界面的两张制定位置的图片 <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span>WixVariable Id<span class="token operator">=</span><span class="token string">"WixUIDialogBmp"</span> Value<span class="token operator">=</span><span class="token string">"assets/Background.bmp"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>WixVariable Id<span class="token operator">=</span><span class="token string">"WixUIBannerBmp"</span> Value<span class="token operator">=</span><span class="token string">"assets/Banner.bmp"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 这里引入两个组件，在下一个文件中 <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span>Feature Id<span class="token operator">=</span><span class="token string">"Main"</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ComponentGroupRef Id<span class="token operator">=</span><span class="token string">"DataFolderFiles"</span> <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ComponentGroupRef Id<span class="token operator">=</span><span class="token string">"PublishedComponents"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>Feature<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>Package<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Wix<span class="token operator">></span></code></pre><h3 id="folders-wxs"><a href="#folders-wxs" class="headerlink" title="folders.wxs"></a>folders.wxs</h3><p>这个文件则配置要运行的程序，也就是我们编译好的go运行程序</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token operator">&lt;</span>Wix xmlns<span class="token operator">=</span><span class="token string">"http://wixtoolset.org/schemas/v4/wxs"</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Fragment<span class="token operator">></span>  <span class="token operator">&lt;</span>DirectoryRef Id<span class="token operator">=</span><span class="token string">"INSTALLFOLDER"</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Component Id<span class="token operator">=</span><span class="token string">"UserServiceEXE"</span> Guid<span class="token operator">=</span><span class="token string">"&#123;8B834EB9-4597-4629-BA5C-2C964F3E261C&#125;"</span><span class="token operator">></span>  <span class="token operator">&lt;</span>File Id<span class="token operator">=</span><span class="token string">"UserService"</span> Source<span class="token operator">=</span><span class="token string">"..\build\win\userService.exe"</span> KeyPath<span class="token operator">=</span><span class="token string">"yes"</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>ServiceInstall Id<span class="token operator">=</span><span class="token string">"UserService"</span> Type<span class="token operator">=</span><span class="token string">"ownProcess"</span> Vital<span class="token operator">=</span><span class="token string">"yes"</span> Name<span class="token operator">=</span><span class="token string">"UserService"</span> DisplayName<span class="token operator">=</span><span class="token string">"UserService"</span> Description<span class="token operator">=</span><span class="token string">"UserService"</span> Start<span class="token operator">=</span><span class="token string">"auto"</span> Account<span class="token operator">=</span><span class="token string">".\LocalSystem"</span> Interactive<span class="token operator">=</span><span class="token string">"no"</span> ErrorControl<span class="token operator">=</span><span class="token string">"ignore"</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>ServiceControl Id<span class="token operator">=</span><span class="token string">"StartUserService"</span> Name<span class="token operator">=</span><span class="token string">"UserService"</span> Start<span class="token operator">=</span><span class="token string">"install"</span> Wait<span class="token operator">=</span><span class="token string">"no"</span> Stop<span class="token operator">=</span><span class="token string">"both"</span> Remove<span class="token operator">=</span><span class="token string">"uninstall"</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>RemoveFile Id<span class="token operator">=</span><span class="token string">"RemoveUserServiceFiles"</span> Name<span class="token operator">=</span><span class="token string">"userService.exe"</span> On<span class="token operator">=</span><span class="token string">"uninstall"</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Environment Id<span class="token operator">=</span><span class="token string">"GIN_MODE"</span> Name<span class="token operator">=</span><span class="token string">"GIN_MODE"</span> Value<span class="token operator">=</span><span class="token string">"release"</span> Permanent<span class="token operator">=</span><span class="token string">"no"</span> Part<span class="token operator">=</span><span class="token string">"all"</span> Action<span class="token operator">=</span><span class="token string">"set"</span> System<span class="token operator">=</span><span class="token string">"yes"</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>Component<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>DirectoryRef<span class="token operator">></span>  <span class="token operator">&lt;</span>ComponentGroup Id<span class="token operator">=</span><span class="token string">"DataFolderFiles"</span><span class="token operator">></span>  <span class="token operator">&lt;</span>ComponentRef Id<span class="token operator">=</span><span class="token string">"UserServiceEXE"</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>ComponentGroup<span class="token operator">></span>      <span class="token operator">&lt;</span>StandardDirectory Id<span class="token operator">=</span><span class="token string">"ProgramFiles6432Folder"</span><span class="token operator">></span>      <span class="token operator">&lt;</span>Directory Id<span class="token operator">=</span><span class="token string">"INSTALLFOLDER"</span> Name<span class="token operator">=</span><span class="token string">"!(bind.Property.ProductName)"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>StandardDirectory<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>Fragment<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Wix<span class="token operator">></span></code></pre><h3 id="语言文件"><a href="#语言文件" class="headerlink" title="语言文件"></a>语言文件</h3><p>另外还可以配置多语言，项目中有几个语言文件，wix对应的会打包这些语言的安装包，比如下面的是英文语言包 en-us.wxl：</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token operator">&lt;</span>WixLocalization xmlns<span class="token operator">=</span><span class="token string">"http://wixtoolset.org/schemas/v4/wxl"</span> Culture<span class="token operator">=</span><span class="token string">"en-US"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>String Id<span class="token operator">=</span><span class="token string">"DowngradeError"</span> Value<span class="token operator">=</span><span class="token string">"A newer version of [ProductName] is already installed."</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>String Id<span class="token operator">=</span><span class="token string">"ProductName"</span> Value<span class="token operator">=</span><span class="token string">"UserService"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>String Id<span class="token operator">=</span><span class="token string">"ProductNameFolder"</span> Value<span class="token operator">=</span><span class="token string">"UserService"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>String Id<span class="token operator">=</span><span class="token string">"Language"</span> Value<span class="token operator">=</span><span class="token string">"1033"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>String Id<span class="token operator">=</span><span class="token string">"CompanyName"</span> Value<span class="token operator">=</span><span class="token string">"Ali Technology Pte. Ltd."</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>String Id<span class="token operator">=</span><span class="token string">"Description"</span> Value<span class="token operator">=</span><span class="token string">"User Service for Windows"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span>String Id<span class="token operator">=</span><span class="token string">"Keywords"</span> Value<span class="token operator">=</span><span class="token string">"dotnet, core, application, installer, User Service"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>WixLocalization<span class="token operator">></span></code></pre><p>对应的日文的文件则叫：ja-jp.wxl，以此类推</p><h2 id="自动化安装脚本"><a href="#自动化安装脚本" class="headerlink" title="自动化安装脚本"></a>自动化安装脚本</h2><p>以上，我们制作好了wix打包配置文件，将它们放入项目目录中，这是目录结构：</p><blockquote><p>userService<br>-……<br>-angular<br>-golang<br>-build_win.bat<br>-win.install<br>–assets<br>–userService.wixproj<br>–package.wxs<br>–folders.wxs<br>–en-us.wxl</p></blockquote><p>这是自动化打包脚本，包括前后端项目的编译等：</p><pre class="language-bash" data-language="bash"><code class="language-bash">@echo off<span class="token builtin class-name">echo</span> %1<span class="token builtin class-name">set</span> <span class="token assign-left variable">BUILDNUMBER</span><span class="token operator">=</span>%1<span class="token builtin class-name">echo</span> %BUILDNUMBER%@REM <span class="token builtin class-name">set</span> <span class="token assign-left variable">INCLUDE_PATH</span><span class="token operator">=</span>%PROJECT_ROOT%<span class="token punctuation">\</span>GoLangDockerImage<span class="token punctuation">\</span>include@REM <span class="token builtin class-name">set</span> <span class="token assign-left variable">LIBRARY_PATH</span><span class="token operator">=</span>%PROJECT_ROOT%<span class="token punctuation">\</span>Libs<span class="token punctuation">\</span>windows<span class="token builtin class-name">set</span> <span class="token assign-left variable">CGO_ENABLED</span><span class="token operator">=</span><span class="token number">1</span>@REM <span class="token builtin class-name">set</span> <span class="token assign-left variable">CGO_CFLAGS</span><span class="token operator">=</span>-I%INCLUDE_PATH%@REM <span class="token builtin class-name">set</span> <span class="token assign-left variable">CGO_CXXFLAGS</span><span class="token operator">=</span>-I%INCLUDE_PATH%@REM <span class="token builtin class-name">set</span> <span class="token assign-left variable">CGO_LDFLAGS</span><span class="token operator">=</span>-L%LIBRARY_PATH%<span class="token builtin class-name">cd</span> .<span class="token punctuation">\</span>angular<span class="token builtin class-name">echo</span> -- <span class="token function">install</span> packages --call <span class="token function">npm</span> <span class="token function">install</span> --legacy-peer-deps<span class="token builtin class-name">echo</span> -- display ng version --call ng version<span class="token builtin class-name">echo</span> -- start build angular --call ng build --build-optimizer<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span><span class="token function">mkdir</span> build<span class="token function">mkdir</span> .<span class="token punctuation">\</span>build<span class="token punctuation">\</span>win<span class="token builtin class-name">cd</span> .<span class="token punctuation">\</span>golang<span class="token builtin class-name">echo</span> -- create win printer code --<span class="token builtin class-name">cd</span> .<span class="token punctuation">\</span>controller<span class="token builtin class-name">echo</span> -- build Coordinator generator --<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>go mod tidy<span class="token builtin class-name">set</span> <span class="token assign-left variable">GOOS</span><span class="token operator">=</span>windows<span class="token builtin class-name">set</span> <span class="token assign-left variable">GOARCH</span><span class="token operator">=</span>amd64go build <span class="token parameter variable">-ldflags</span> <span class="token string">"-X main.UserServiceVersion=%BUILDNUMBER%"</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-o</span> <span class="token punctuation">..</span><span class="token punctuation">\</span>build<span class="token punctuation">\</span>win<span class="token punctuation">\</span>userService.exe main.go<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span><span class="token punctuation">\</span><span class="token function">mkdir</span> .<span class="token punctuation">\</span>build<span class="token punctuation">\</span>win<span class="token punctuation">\</span>Publicxcopy /s /y .<span class="token punctuation">\</span>angular<span class="token punctuation">\</span>dist<span class="token punctuation">\</span>* .<span class="token punctuation">\</span>build<span class="token punctuation">\</span>win<span class="token punctuation">\</span>Public<span class="token builtin class-name">echo</span> -- generate and run .msi --<span class="token builtin class-name">cd</span> .<span class="token punctuation">\</span>Kepler.Installdotnet build <span class="token parameter variable">--force</span> <span class="token parameter variable">-c</span> Release@REM <span class="token builtin class-name">cd</span> .<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>Release<span class="token punctuation">\</span>en-US@REM sc delete UserService@REM <span class="token function">timeout</span> /t <span class="token number">15</span>@REM msiexec /i UserService.msi</code></pre><p>完成，执行bat脚本就能自动打包成msi安装包了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;以系统服务运行程序&quot;&gt;&lt;a href=&quot;#以系统服务运行程序&quot; class=&quot;headerlink&quot; title=&quot;以系统服务运行程序&quot;&gt;&lt;/a&gt;以系统服务运行程序&lt;/h2&gt;&lt;p&gt;在windows上运行golang程序的时候总会有一个令人讨厌的运行窗口，我们可以使</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Go" scheme="https://shuangdeyu.github.io/tags/Go/"/>
    
    <category term="WixToolset" scheme="https://shuangdeyu.github.io/tags/WixToolset/"/>
    
  </entry>
  
  <entry>
    <title>喂老头，我成魔教教主了</title>
    <link href="https://shuangdeyu.github.io/2024/04/07/wei-lao-tou-wo-cheng-mo-jiao-jiao-zhu-liao/"/>
    <id>https://shuangdeyu.github.io/2024/04/07/wei-lao-tou-wo-cheng-mo-jiao-jiao-zhu-liao/</id>
    <published>2024-04-06T16:00:00.000Z</published>
    <updated>2024-04-07T09:15:40.373Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><strong>相见</strong></p></blockquote><p>「喂，老头，一大把年纪了，说话可不能反悔啊！」</p><p>「那是自然，今天贫道就是求也要将这痴儿求走，他可是天生的剑仙胚子。」</p><p>「好好好，这小拖油瓶今天总算能送走了，你快带他走吧，我事情可多着呢，莫要耽误了时间。」</p><p>「不去，哪也不去，我就要跟哥哥在一起，呜呜呜……」</p><p>风雪正喧嚣，路有冻死骨。</p><p>一个衣衫褴褛的孩童紫红紫红的双手紧紧扯着一个同样衣不蔽体的少年的衣角，哭红了眼，哭红了脸。</p><p>他们不远处，一个素袍老人负着手静静地站着，他立于风雪之中，却片雪不沾身，宛如一个不沾人间因果的谪仙，但是紧紧抓在一块的双手，戳破了他古井无波的表象。</p><p>「别闹，老头说你是痴儿，你还真是痴儿，这可是多少达官显贵，甚至是皇帝都求不来的神仙机缘，是你说不去就不去的吗。」少年陈青说着忽地用掌心推了一下孩童陈松的额头，将他推得一个踉跄，双手却离不开衣角一厘一毫。</p><p>「你，你就是个拖油瓶，离了你这个累赘，天下之大我大可去闯得，日后成就不一定就比你低呢，看在兄弟一场，你可莫要误了我前程。」陈青咬着牙关，面露不忍，但这话还是脱了口而出。</p><p>只是，陈松说什么也不肯松开双手，只是哭，只是哭，小小的身躯不知道哪来这么多气力。</p><p>哭是最耗气力的。</p><p>「听话，小松最乖了。」佯怒之后，陈青便蹲下来握着陈松僵了七分的双手，赶紧凑在嘴边，长长哈了两口热气：「以你的天赋，修成仙人也要不了多少年，日后，等你修成归来，要是为兄还没闯出名堂，指不定得要你接济呢，到时候你可不准嫌弃为兄。」</p><p>「当然，你修可不能随便修，定要修成那一方巨擘，到时候为兄想入宗门还不是以你一句话的事情吗？可不要像这个老头一样，左一句宗门规定，右一句宗门规定，窝囊得连我这毛头小子都看不下去了，修仙修仙，修不成逍遥自在，修个屁的神仙，你说是吧，老头。」</p><p>「呵呵，咳。」老人尴尬笑笑也没有气色。</p><p>要是同道中人知道他这个上三宗之一的剑宗最资深长老被一个小屁孩指着鼻子骂，定会惊掉一地下巴。</p><p>剑宗与其他修仙门派不同，宁缺毋滥，没有剑修天赋，不收就是不收。</p><p>「小友说得对，世人都道神仙好，都言神仙如何如何超脱，殊不知，修仙之人的条条框框，明争暗斗可多了去了，不比凡人来得潇洒快活，小友小小年纪便是个通透人，将来成就不可限量。」老人讨好般夸着陈青，脸上的皱纹挤在一块，本来就看不出多少来的仙风道骨，一笑就全部烟消云散了。</p><p>「可别夸了，老头，快带他走吧，这冰天雪地的，你们不冷我还冷呢，总站在这是个什么事？」陈青挥挥手，突然憋着的一身热气控制不住一散，浑身打了个长长的寒颤，感觉连心脏都被一只冰做的手握住，差点不跳了。</p><p>「我不走，我不要修仙！」陈松用衣袖抹了一把冰冷的泪和鼻涕，转头对着老人凶道：「我就要跟哥哥在一起！」</p><p>只不过奶奶的语气听不出丝毫威慑力。</p><p>老人叹了口气，刚要再次做惆怅状摇头念叨着「痴儿，痴儿」，陈青便噌地一下站起，用力打掉了陈松的手，这次他是真的生气了，道：「你这人怎么这么油盐不进呢，再胡闹，我就要生气了，听哥的话，修仙又不是坐牢，你要是想哥了，就到每年春天会开满满田野油菜花的竹溪村去找我，我每年春天都会去那里等你，记好了，我不再说第二遍！」</p><p>「呜呜呜……」陈松哭得更大声了，双手往前伸着，像是要重新抓住陈青的衣角，又像是期待着陈青的拥抱安慰，显得那么孤苦无助，他哽咽着点点头：「记得，那是，那是哥哥捡到我的地方，呜呜呜……」</p><p>相见之处，怎能不记得。</p><p>见状，陈青也不废话，强拖着陈松就往老人手里送去，走了短短几步，陈青竟觉得比偷了肉包子后跑上一条街还累。</p><p>好在很快，抗拒如一条咬钩的鱼的陈松头一歪竟晕了过去，毕竟年纪小再加上平日里总吃不饱饭，导致身子虚得很，哭闹了这么久终究是扛不住了。</p><p>「走了，老头，好好待他。」待老头接过陈松，陈青当即转身走向那噬人的茫茫巨口，头也不回。</p><p>「小友。」老头看着这个单薄的少年，眼中尽是惋惜，叹了口气道：「相遇即是缘，我叫李长庚，你不适合练剑，但练刀未必不能大放异彩，这本刀法你且拿着。」</p><p>陈青伸手接过柔柔飘来的刀谱，顺道挥了挥手：「谢了老头，回头我练练看，练成了再见你，我便叫你一声师父。」</p><p>「哈哈哈，好！」老人爽朗一笑，向来迂腐闷静的他心中难得感到了一丝畅快，他看着陈青一步一步走远，雪地上留下他的一串脚印，歪歪扭扭，深浅不一，很快又被新落下的雪盖住，轻轻念了一声：「一路平安，陈青小子。」</p><p>旧雪未及消， 新雪又拥户。</p><p>老人带着陈松御剑飞走了，惊的那处的雪花四处飘荡，陈青有所感，回头一望，天地间只剩下一片苍茫，除了白色还是白色。</p><p>「哈，哈。」陈青终是绷不住了，刚才保持的云淡风轻几乎用完了他所有气力，他随处找了一户人家的门沿墙角蹲着，使劲对着冻僵的手哈着热气，手里还紧紧攥着一本不新不旧的刀谱。</p><p>「这鬼天气，究竟何时是个头，冷死我了。」憋着的气散了之后，陈青冷到了骨子里，身体控制不住地发抖，抖若筛糠，待双手热乎了一点后，他使劲搓着双脚，然后搓着身子，又搓着手臂肩膀，等到搓到脸上的时候，两行清泪早已冻成了霜。</p><p>「臭小子真走运，哥哥不在，你可要好好照顾自己啊，呜呜呜……」终究只是一个十一二岁的小孩，这一刻，委屈、遗憾、不舍，他的种种情绪爆发在这无人的深夜，很快又被厚厚的风雪盖住，跟滔滔洪流中一颗石头一样毫不不起眼。</p><p>他这样的遭遇，在这兵荒马乱，食不果腹的年代中，也只是千千万万悲剧中的一个，又有谁会多看一眼呢。</p><p>相比其他人，陈青已经算是幸运了，遇到传说中的修仙之人，还得赠一本刀谱，至少，他从此有了在乱世中崛起的资本。</p><blockquote><p><strong>度厄</strong></p></blockquote><p>桃月中旬，三月桃花粉面羞，正是那满山桃花怒放，绮丽芬芳的时候，除此之外，另有百花争艳，点缀着山间地头，路边河岸，处处是春光，好不热闹。</p><p>特别是山下那一片金黄，灿灿生辉，其艳丽甚至盖过了山上那粉红佳人，一时风头无两。</p><p>「兄长，今年这满山油菜花开得还是跟往年一样旺。」少年陈松手捻一片金黄花瓣，嘴里喃喃着：「可是为何还不见你人影，你到底在哪里？」</p><p>陈松长大了，明眸剑眉，高鼻皓齿，长发盘髻，挺拔的身姿宛如一柄插在地上的利剑，隐隐散发着逼人的剑意，仿佛下一刻就要斩尽这满地金黄。</p><p>他眉间那抹化不开的忧愁又为他增添了一股忧郁气质，令人越看越着迷，良久，他收回思绪，手一垂，任由手中花瓣滑落，静静道：「要是你出了意外，我定要荡平所有伤害与你之人。」</p><p>话落，顿时一股气机由他为中心散开，惊得满地油菜花瑟瑟发抖，从满地金黄抖出了一个漫天生辉，围绕着陈松胡乱飞着。</p><p>山间，田野，飞花，少年，好一幅画里走出来的景象。</p><p>「该走啦，师弟。」背后突然响起的少女银铃般的呼唤打破了这本不平静的一幕，陈松转身，只见少女目含愠怒，似乎是因为在陈松这里，她跟油菜花的斗艳败下了阵，嘟着嘴不满道：「这油菜花有什么好看的，山门那常年的姹紫嫣红还不够师弟你看啊？」</p><p>「这些花花绿绿，哪有我好看，哼。」这句话是她在心里嘀咕的。</p><p>「抱歉，师姐久等了。」陈松对着少女欠身一拜，尽显谦虚恭敬，他挠挠头道：「走吧，师兄们怕是等久了。」</p><p>「哼，你还知道久啊。」</p><p>说着，二人纵身一跃，踏着飞剑驶向天际，一阵风吹过，满田野的油菜花重归平静，只剩一团花瓣随风飘荡。</p><p>云端之上，三个比起陈松略显成熟的少年见陈松二人飞来，当即架起飞剑再次赶起了路。</p><p>「师兄们久等了。」陈松再次抱拳道歉。</p><p>「不急，论剑大会明日才开始，今日就当散步了，这人间美色也算是别有一番风味。」领头之人说道。</p><p>「话说今年这三宗四派可都出了些了不得的人物，这次论剑大会怕是要精彩数倍不止了。」其中一人道。</p><p>「管他什么妖魔鬼怪，第一必是我剑宗的，因为我们有师弟。」少女道，看向陈松眼中连放异彩。</p><p>「师姐可别夸了，我还差得远呢，境界低了一大轮。」陈松摇头笑道。</p><p>「咱剑修看重的可不是境界，而是剑意，松师弟之剑意已有剑仙之姿，不可妄自菲薄，想必剑宗最年轻剑仙的称号非师弟莫属了。」</p><p>「的确，这次，松师弟就是我剑宗隐藏的利剑，一旦出鞘，定叫其他宗派惊为天人，哈哈哈。」</p><p>「哈哈，我可等不及看他们表情了。」</p><p>「哈哈哈……」</p><p>少年少女谈笑间，意气风发，一两黄金一两风，最风光是少年时。</p><p>另一边，陈松心中念叨着的陈青正在经历九死一生之劫。</p><p>「哈啊，哈啊……」陈青全身湿漉漉的，靠在一处洞壁之上，染血的衣物紧紧贴在肌肤之上，说不出的黏腻和难受，他大口大口喘着粗气，眼神却越发明亮，有一种大难不死的喜悦：「金刀门的杂碎，觊觎我的刀谱不说，还想抢我机缘，几次逼我到绝路，等着，我早晚弄死你们！」</p><p>陈青暗自发着狠誓，强撑着身体向洞口外的明亮走去，左手骨节泛白，紧紧抓着手中一个略显古朴的长匣，上面有血浸过的痕迹，随着手臂晃动，匣子里侧贴着的三根断指露了出来，触目惊心。</p><p>就在不经意间，断指上的血渗进了匣子，里面缓缓传来一阵轻微的机括声，而陈青还在咒骂着：「想不到吧，这五毒谷我不是第一次来了，更想不到吧，这水潭下面虽有毒蛇，深处却别有洞天，隐藏着这么一个洞天福地。」</p><p>「待我将这机缘消化，就是你们的死期，我陈青有恩必还，有仇必报。」</p><p>说着说着，陈青语气渐低，变得有些失落起来：「唉，今年又失约了，不知道陈松那傻小子去没去油菜花田。」</p><p>「呵，我在瞎想什么，仙人哪有我这么闲，传说中修仙之人一闭关短则上月，长则几年，恐怕松小子这会还在闭关修炼也说不定，不想了，他有他的机缘，我有我的机遇，总会有相见的那一天。」</p><p>「啊！」突然，陈青断指处一阵吃痛，竟是手中匣子不知什么时候已经打开了，盖子正好弹中他的伤口，从中「咣铛」一声掉落两物，没有霞光万道，也没有机关重重，就如匣子一般古朴无华。</p><p>「这是？」陈青捡起一看，登时眉头深深地拧在一块：「这，这竟然是千年前那令人闻风丧胆的魔尊的毕生武学度厄诀，还有他的度厄刀？」</p><p>「我竟然得了魔尊的传承，学还是不学？」</p><p>陈青没有被这泼天的机缘冲昏了头脑，一代魔尊的绝学就算当今的三宗也找不出几本能够与之匹敌的，但他很清楚一旦学了这门功法将会引来什么样的因果，更何况，传说中这魔尊魔气滔天，杀人千百万，他的绝学只怕很难不是邪功。</p><p>犹豫再三，陈青有了决断：「我陈青有恩报恩，有仇报仇，自认良心坚固，魔尊功法又如何，难不成还没练就能摄人心魄？要真是一门邪功，我还不屑学呢？」</p><p>说着，陈青便盘膝而坐就地看了起来，这一看，看得他眼睛再也移不开了。</p><p>良久，他才放下功法本子，拿起那柄度厄刀哈哈大笑：「度厄，度厄，世人皆苦，欲渡厄，先尝厄，肉体历经九九八十一厄难，方能超脱，厄难不缠身，或者说厄难缠身也不怕，正如天将降大任于斯人也，必先苦其心志劳其筋骨。」</p><p>「这本质上是一本极致的锤炼肉体的法门，壮大的是血气，甚至练至小成就可以肉白骨，而传统名门正派修的是外界灵气，传说那教主周身血气如虹，是杀了千千万万人所至，看来也是谬传了，可笑可笑，这哪里是邪功了，只身修炼方向不一样，又不伤天害理，这些正派当真霸道无边，竟硬生生将这功法宣传成了邪功。」</p><p>「既然如此，这度厄诀我练定了，不就是度厄吗，我陈青别的没有，就是吃的苦多，还怕扛不过去？作为回报，日后我定将你等正名。」</p><p>说着陈青抖了一下刀身，不知是不是错觉，度厄刀上一道寒芒闪过，刀身隐约间发出了一声欢快的轻吟，似是认可了这个新主人。</p><p>时光匆匆而过，谁能想到世间绝地之一的五毒谷深处竟有一处世外桃源般的山谷，谷中一个少年正练着天下一等一绝顶的法门，同时，也在经受着地狱般的锤炼。</p><p>究竟是为邪功正名，行侠卫道，还是人人喊打，除之而后快，一切还未可知。</p><blockquote><p><strong>魔头</strong></p></blockquote><p>「杀人啦，杀人啦，魔教打上金刀门啦，血红魔气覆盖整个门派，无一人生还。」</p><p>很快，金刀门被灭门的消息如星火燎原般传遍天下，上至庙堂，下至江湖，天下震动，不为别的，只因为他是三宗四派中，霸刀派设在人间的直属门派。</p><p>霸刀，霸刀，向来霸道无边，跟其他修仙宗派不同，霸刀派乐忠于渗透人间，而金刀门借着这一层关系，不说无恶不作也差不多了，嚣张跋扈到武林盟都不敢明着打压他们，当真是江湖一大毒瘤。</p><p>现在金刀门一灭，更多的人则是拍手称快，另有一部分人则深深担忧着，无论是灭了金刀门的狠人，还是金刀门背后的霸刀派，目前来看都不是好相与的角色，恐怕，这世间又要起惊天波澜了。</p><p>「当真是血红魔气和刀气？还覆盖了整个门庭？」荒漠深处，有一片连绵房屋，其中正中那间殿堂内传出一声的怒吼，其声雄浑如滚滚惊雷，乍响而起。</p><p>任谁都想不到，万里戈壁深处竟有这么一片气势恢宏的群落居所，这，正是整个霸刀派的门庭所在处。</p><p>「刀，刀主在上，小，小的所说，千真万确，那景象……」大堂之中，主位之前，一中年趴伏在地，浑身瑟瑟发抖，双眼埋在臂弯之间，盯着古朴的地板，仍旧难掩恐惧之色，也不知是在怕谁，他回忆了下，接着颤颤巍巍道：「那景象宛如炼狱直临，将天都映红了，只一眼，只一眼小的就吓晕了过去，所以才侥幸逃过一劫。」</p><p>末了，他抬起头，一改怯弱声嘶力竭道：「死了，全死了啊，金刀门上下三百多号人呐，还有我的儿啊，全死了，望刀主主持公道，将那魔头碎尸万段！」</p><p>说着便「咚」的一声重重磕了一个响头，长跪不起。</p><p>主位上，那名为刀主的魁梧男人沉吟片刻，唤退这金刀门幸存者之后，对着左右在位长老道：「各位长老怎么看，难道真是当年那魔尊传承有了后人？」</p><p>「八九不离十了，这几日我旧伤隐隐作痛，我道是什么原因，原来是这度厄魔功出世引起的，此子，断不能留，咳咳咳。」其中一老人顿了下手中木杖，咬牙切齿道。</p><p>「大长老所言极是，我想应该没人会质疑大长老的判断，毕竟他可是从那个时代活下来的。」另一人道。</p><p>「一个金刀门是小事，灭了再立一个就是，但此人断不能留，不然魔尊再临，天下生灵涂炭，我提议即刻通知其余三宗四派，全力捉拿此獠。」</p><p>「复议。」</p><p>「复议。」</p><p>……</p><p>商讨很快便有了结论，等到众人陆续退出大堂，刀主仍旧坐在主位之上，他一手撑头，一手摩挲着主椅上雕刻着的白虎，眯着眼，眼中闪烁着贪婪渴望。</p><p>与此同时，这位风暴中心的始作俑者此刻正走在一处城镇的街头，身边跟着一个轻纱遮面，身段婀娜的妖女，正是当代魔教圣女。</p><p>「喂，你烦不烦，都说了我不是什么魔尊，也不会加入你们魔教，不要再跟着我了。」陈青皱着眉头，语气颇为不耐烦。</p><p>「嘻嘻，不愧是魔尊传人，灭了一个名门正派还大摇大摆地走在街头，生怕别人认不出你。」圣女在陈青耳边吐气如兰，纤纤玉指勾着他的下巴，笑嘻嘻道。</p><p>「哼，何惧之有。」陈青一巴掌拍掉圣女不老实的手，不为所动：「我行的是正道，那金刀门几次三番欲置我于死地，况且该门派霸道无边，暗地里做的坏事还少吗，我这是替天行道，我就不信这世间没了正义可言。」</p><p>「况且，我得了魔尊传承，他本人行事如何我不足以论评，但我既已立誓为他绝学正名，自然要光明正大施展出来，一辈子躲躲藏藏还谈何正名，这于我道心有碍。」</p><p>妖女轻笑一声，不置可否：「金刀门只是一个引子，重要的是你身怀魔尊功法，恐惧你的，觊觎你的，仇视你的……到时候，什么妖魔鬼怪都会出现，那些人，可比我们魔教可怕多了。」</p><p>「这些我自然知道。」陈青笑笑，伸了个懒腰：「就像刚才所说，我需要为度厄诀正名，所以我必须入世，度厄，度厄，我还未超脱，自然一生都要在度厄，你说的这些何尝不是一种厄难呢？」</p><p>「要不，我把度厄诀教你啊，这样世人就不会一直盯着我了。」</p><p>圣女一怔，红颜祸水般的姣好面容上还挂着那抹胸有成竹的媚笑，这时候尤其显得尴尬，不过魔教圣女心性自然也是一等一的，很快，她便恢复往常，只是看着陈青目中多了一丝刚才所没有的认可和好感。</p><p>她娇笑一声：「呵呵，魔尊的功法不是谁都能学的，既然你学会了，我魔教就会尊你为主，心甘情愿的哦。」</p><p>「我说了，我不会加入魔教的。」</p><p>「嘻嘻，那我们走着瞧好了。」</p><p>「你烦不烦。」</p><p>……</p><p>「灭了金刀门的魔头在这里，杀了他，我门就能进三宗四派挑功法了，杀！」</p><p>「哈哈，羽翼未丰的小魔头，这等机缘被我哥俩遇到，天该我哥俩崛起！」</p><p>陈青一眼就认出这两人乃是凶名赫赫的散修欧阳二老，当即脸色一变，前所未有的凝重：「你们疯了吧，我们无冤无仇，何苦追我三天三夜。」</p><p>「桀桀桀，大哥，这小子当真天真无邪，看起来不像是魔头啊。」</p><p>「重要吗，只要他得了魔尊传承，不是魔头也得是魔头，桀桀桀，受死吧。」</p><p>陈青脸色阴沉，握着度厄刀的右手上粗壮的青筋如虬蛇攀爬，手中度厄刀越颤越快，血光弥漫。</p><p>只有陈青自己知道，不是他在控制自己的手，而是他在控制度厄刀不要轻举妄动，但是现在，他快控制不住了，不管是度厄刀，还是他的杀心。</p><p>「别逼我杀了你们……」</p><p>随后，一阵血光弥漫，很快又恢复平静，最后从林子里走出的只有陈青一人，他受了点伤，但不重，唯独双眸似是盖上了一层迷雾，藏着深深的迷茫。</p><p>这样的情景，陈青不知道遭遇过几回了，有些人教训一下他放了，也有些人他杀了，渐渐的，度厄之名真正的涵义也传了开来，但一波波红了眼的「猎人」还是络绎不绝。</p><p>陈青迷茫了，满心满脑只剩下「为什么」三个字，为什么他做的这一切好像并没有用，只要他练的功法叫做度厄。</p><p>难道真的是自己过于天真了？还是这世界太过荒谬？</p><p>……</p><p>最后一次了，这是最后一次了，从此世上少了一个魔尊传人，多了一个真正的魔尊。</p><p>「魔头人头当属我青云宗，尔等速速退下。」</p><p>「凭什么，青云宗这么霸道吗？」</p><p>「魔头屠了我霸刀派属金刀门，自然是由我霸刀派擒拿处置。」</p><p>「呵呵，我宗也有人死在魔头手上。」</p><p>「我派也有。」</p><p>「呵呵，哈哈哈，哈哈哈哈，哈哈哈哈哈，啊哈哈哈哈哈！」陈青冷冷看着面前这一群乌泱泱的人，笑了，笑得癫狂。</p><p>「好一些名门正派，冠冕堂皇，你们要杀我？」</p><p>「无所谓了，那就杀吧，杀吧。」</p><p>「我累了，曾经我问过自己很多个为什么，现在不问了，答案早就摆在了眼前，而我却迟迟视而不见，何其愚蠢，哈哈哈。」</p><p>陈青还在癫狂地自言自语，而对面这些正派联军一时间竟被吓住了，再加上他们联军不联心，一时间也无人不识趣地打断陈青，只当是他死前的发泄。</p><p>「以前我穷苦潦倒也没失了本心，偷了哪家的包子日后我都几倍报答了回去；度厄诀非人能练成，我也扛了过来，守住本心，没有因此变得嗜杀残暴，可是……」</p><p>「唯独抵不住你们源源不断，一口一个魔头啊。」</p><p>「我本不欲成魔，奈何你们苦苦相逼，好，从此我便是魔，正义、公道，原来如此廉价，是我太天真了，这世界只讲利益，仙人也好，凡人也罢，都是利益这个漩涡中的牺牲品罢了，我实在是蠢透了，吃了这么多年苦，却连这点道理都看不透，呵呵，哈哈哈哈！」</p><p>说罢，陈青手握度厄刀在左手掌心一划，冒出的掌心血顿时氤氲成雾，围绕着陈青转悠，再加上他怒而血红的双眼，此刻真宛如魔尊再临。</p><p>这一刀，是告别，是他在跟以前的自己告别。</p><p>「既然如此，那我就要战在这世界之巅，让这天再也压不住我，让这地再也埋不了我，海到无边天作岸，山登绝顶我为峰！」</p><p>「恭迎教主，恭迎魔尊！」</p><p>陈青这句话一落地，江边两侧便爆发出一阵阵滔天的激昂口号，一群人目露激动地看着陈青走出，一眼都没看这浩浩荡荡的正派联军，仿佛在他们眼里，这些人跟死物没什么区别。</p><p>「什么，魔教怎么会在这里！」</p><p>「你们难道想跟天下宗门开战吗？」</p><p>面对威胁，魔教之人丝毫不惧，为首的圣女轻笑一声，开口道：「教主说了算，教主说降那就降，教主说杀，那就杀！」</p><p>陈青淡淡瞥了一眼，毫不犹豫地吐出一个字：「杀。」</p><p>那一天，胸有成竹，浩浩荡荡的除魔队伍无一人生还，清澈的永安江中那刺目的艳红和血腥三天三夜未消。</p><blockquote><p><strong>荡魔</strong></p></blockquote><p>永安江一战，天下震动，从此世人皆知有一个魔头，不，应该是魔尊唤作陈青，度厄刀再次让整个天下人心惶惶。</p><p>震怒之下，三宗四派联合天下高手，发出荡魔令，于宁门横断山，前往山顶魔教大本营展开荡魔计划，史称宁门荡魔。</p><p>天下风云动荡，人间和修行界均起战乱，可谓是末日之兆。</p><p>中州武林盟。</p><p>「盟主，三宗通知我们出兵，我们出是不出啊？」</p><p>「滚蛋，他们修仙界打架，关我们江湖武林什么事。」</p><p>「他们说金刀门是武林门派，我们得去主持公道。」</p><p>「放他娘的屁，这些老不死的个个阴着呢，我们去了还不是当炮灰的料，吩咐下去，谁敢私自去凑热闹，打断双脚送入丐帮。」</p><p>一手握陌刀的精壮中年人叹了口气，轻声道：「陈青小子，我只能帮你到这里了。」</p><p>隐世宗门诸葛家。</p><p>「使者请回吧，我诸葛家早已不入俗世。」</p><p>请走三宗使者后，这个儒雅书生放下手中的茶盏，捻起桌上一枚铜钱，自言自语道：「陈青，唯有身怀大气运者是我诸葛丘算不到的，有趣，有趣，有机会真想见你一面，与整个修仙界为敌，诸葛做不到，但只要你进了诸葛家地界，诸葛家还是有办法保你的。」</p><p>大山深处，妖族。</p><p>「三宗四派不可抗，众妖听令，暗中行事，必要时刻，救走人族陈青，来深山处。」</p><p>随着大妖一声令下，暗处隐着的妖怪们纷纷散去，去那对他们来说如履平地的山林各处，接应陈青。</p><p>大妖身旁，一只灵气四溢的小狐狸，眼中含着浓浓的担忧，祈求着看了一眼大妖。</p><p>大妖叹了口气，仍旧是无奈地摇了摇头。</p><p>就在全世界好像都与陈青为敌的时候，仍旧有一些人，有一些势力，在为他担忧，在尽其所能地帮助着陈青。</p><p>这一刻，命运的齿轮开始转动，以往做过的一件件好事，行过的一桩桩正事皆是引起了连锁反应，正所谓是善因结善果，这个世界还没有抛弃陈青，只是他现在还看不到。</p><p>「教主，那些正派欺人太甚，与他们拼了吧！」</p><p>「拼了！」</p><p>「拼了！」</p><p>「够了！」陈青一摆手，制止了下方教众的喧哗，他面容古井无波，平静道：「不需要，他们只是冲我来的，你们不出去就不会有事，我知道你们有血性，但不要做无谓的牺牲，留得青山在不愁没柴烧。」</p><p>「教主。」一位看起来地位比圣女还大的长眉长须老者道：「教主仁慈，多谢教主为我们考虑，但我等知道，魔教至今未灭只是因为那些正派需要留着我们给门中弟子历练用，这样的日子我们受够了，今天就让那些伪君子看看我们的骨气和底蕴，既然来了，就别想留着全身回去。」</p><p>「对，我们不要再当老鼠。」</p><p>「给他们点颜色瞧瞧。」</p><p>「杀，杀光他们，我要为我爹报仇。」</p><p>陈青看着下方群情激奋的众人，皱了皱眉，但终究还是没再说什么。</p><p>这些人，有跟陈青一样，是无父无母的孤儿，为圣教所救，报身圣教；有因那些正派的跋扈而弄得家破人亡的逃亡之人；也有真正的恶徒，走投无路混入圣教，但他们也不敢胡作非为，不然不光正派所不容，所谓的魔教也待不下去了。</p><p>大部分都是苦名门正派久矣之人。</p><p>最终，陈青唯有轻叹一声：「随你们吧。」</p><p>……</p><p>横断山顶，传说是上古剑仙一剑削成，造成了现在山顶如履平地的地貌，本来是世界不可多得的剑修悟道之地，但好不巧，那位剑仙乃是邪剑仙，他削去的不仅仅是山头，还有此地方圆百里的所有灵气。</p><p>此刻，这里受到了从未有过的欢迎，人潮涌动，两拨人剑拔弩张。</p><p>「孽障，还不束手就擒，你算我长庚师叔半个弟子，回我剑宗接受惩罚，免得误了长庚师叔的名声。」自陈青名动天下后，他的生平自然是事无巨细地被扒了个干净，连十多年前剑宗大长老赠刀谱的事情都挖了出来。</p><p>「剑宗，莫要太目中无人了。」还不等陈青发话，那剑修身旁一尊魁梧的大汉不满道：「魔尊陈青屠我金刀门，杀我派弟子数十，今天，我霸刀派必要擒了他，将他抽筋剥皮，曝尸三天三夜！」</p><p>「刀主莫怪，实在是我替我宗长庚剑仙抱不平，竟看走了眼当初给了这个魔头机缘。」剑修抱拳道歉，但嘴角一直挂着淡淡的微笑，充满戏谑。</p><p>「哼。」霸刀派刀主冷哼一声也不再纠缠，他左一个长庚剑仙，右一个长庚剑仙，傻子都听得出来是在拿长庚剑仙立威，好为后续利益分配之时谋得更多。</p><p>不过这都是后话了，眼下最重要的还是这场大战，尽管长庚剑仙声名在外，但陈青，他霸刀刀主说什么也要拿到手。</p><p>陈青看着那正派联军还未开打就在勾心斗角，只觉得好笑：「哈哈哈，土鸡瓦狗。」</p><p>「你说得对，我陈青一生光明磊落，有仇报仇，有恩报恩，从未亏欠任何人，唯独你说的那个老头，我至今还没报了恩情。」</p><p>「我靠着他的刀诀走到今天，既然如此，如今我自断一臂，以报他的恩情足够了。」</p><p>说着，在任何人都没反应之下，一道刀光闪过，陈青左臂便连根飞起，摔在地上。</p><p>陈青第一时间运转度厄诀，收缩血气，这才没造成大喷血。</p><p>「从此，我们两不相欠，我陈青再不欠任何人！」</p><p>「教主！」</p><p>「教主！」</p><p>魔教见此则丝毫不淡定，纷纷惊讶于陈青的果决，有担忧的，也有责怪他不顾大局自损实力的。</p><p>「无妨，一臂而已。」陈青则毫不在意，只有练过度厄诀的他自己知道，血气亦可如臂使指，断臂又如何，血气不干，哪怕三头六臂都能给你整出来。</p><p>相反的，正派联军那边，有人见魔尊断臂，「实力大降」，当即就忍不住想要出手。</p><p>「杀，魔尊重伤，正是杀他的好时机！」</p><p>领军的几人也不阻止，他们需要这种愣头青来打头阵试探虚实。</p><p>不过联军中有一人早已忍不住要跳出了。</p><p>「住手，我看谁敢杀我哥！」</p><p>陈松目眦欲裂，刚才陈青断手，将他最后一丝顾忌打破，现在哪怕叛出宗门，与全世界为敌，他陈松都不会有二话，偏要站在兄长这边。</p><p>他虽未成剑仙，但已具剑仙之姿，周身剑气勃发，手中长剑狰鸣。</p><p>「陈松，快回来，莫要自误。」剑宗领头那剑仙气得胡子直抖。</p><p>陈松一脸坚定，丝毫未退，这时，一道威严的声音响起：「吾乃魔尊，凭你也敢妄称我弟？」</p><p>与此同时，一道血气震来，震得陈松飞回剑宗队伍，震得他一脸不可置信，再到明悟，又回到担忧。</p><p>陈青这是铁了心要跟他断绝关系，但凡现在跟他扯上关系的人，无一不是众矢之的。</p><p>没了陈松的阻挠，那几个迫不及待的炮灰当即冲出，打响了这场大战的第一炮，他们出手就是全力和杀招。</p><p>「一群臭虫也配拿我项上人头？」血红刀光闪过，几截断尸簌簌而落。</p><p>「魔头猖狂。」眼看时机和气氛烘托得差不多了，刀主一声令下：「今日，荡魔！」</p><p>霎时间，群情激奋，法宝和法术漫天飞舞，飞剑和枪戟碰撞出刺目的火花，挑出鲜艳的血红，战争，血与火，往往存在着一种震撼的美感，但在这种美感下是无尽的残酷，是廉价的生命，更是诱人的利益。</p><p>死亡不分对象，魔教和正道联军此刻每一分钟都有人在死去，成为这场荒谬的战争的添头。</p><p>「叮，铛」。</p><p>陈松举剑回挡，荡开陈青斜砍的一刀，急着说道：「哥！回头吧，我们去找师父求情，就说你是被魔教所蛊惑，相信我，相信师父。」</p><p>「愚蠢，修了这么多年还是如此愚蠢，回不了头了，我也不需，不想回头，既然这世道虚伪，那就让我来将他搅个地覆天翻，捅穿他！」陈青怒道，遂大开大合，度厄刀一时间压得陈松举剑唯艰，周身剑气纷纷破碎。</p><p>「魔头受死！」陈松的同门师姐见机从侧面攻来，找的角度及其刁钻，正是陈青挥刀力度正深的刹那，他必然难以及时收力回防。</p><p>看来，这位师姐是一直在看着陈松被打得节节败退，却不伸援手，只等这获利的一刻。</p><p>陈青眼角余光瞄见，随即露出一抹轻蔑的笑，只见他身上血气涌动，竟涌出一只全由血气组成的手臂，手中还握着一把血气形的度厄刀。</p><p>一刀，剑断，香消玉殒，甚至陈松师姐全身的血气都被吸食了个干净。</p><p>这就是度厄诀的恐怖之处，不仅能驱使自身的血气，还能够吸食别人的血气为己用，壮大自身，这令陈青在这场战争中如鱼得水，至今都未损耗一点血气。</p><p>同时，这也令得度厄诀显露出它邪异的一面，本来陈青是不想用出来的，无奈世人苦苦相逼，可以说是这些正道之人生生逼出来的。</p><p>现在，他们该尝尝这个恶果了。</p><p>「不！」陈松目眦欲裂，师姐明着暗着向他暗表情愫，正所谓日久生情，说他对师姐没点好感，那只能是假的。</p><p>陈青则面无表情，随意看了眼这个被吸成人干的美少女，心中暗道：「弟弟啊，你还是这么单纯，这女人的血气中充斥的都是欲望，你只是一条她向上爬的梯子而已，为兄就帮你这一次，斩了你的情缘，了了你的牵挂，让你更上一层楼，你不能只站在山腰，我在山顶等你。」</p><p>牵挂，说的是师姐，更是陈青自己，而他却亲手断了这段羁绊，逼的就是兄弟反目，就是要陈松跟他断绝关系，落得个清清白白。</p><p>「不，这是为什么，不！」陈松崩溃了，他浑身剑意大发，竟短暂的隐隐触摸到了剑仙的层次，不愧是天生剑仙之姿。</p><p>「飒」，剑光瞬息闪至，顶着陈青的额头。</p><p>「为什么？」陈松咬牙问道，回答他的却还是沉默，他瞪红了双眼，握剑的手止不住地颤抖，终究还是下不去这个手。</p><p>「啊！」陈松疯了，他冲向战场后方，发了疯似的去杀魔教成员，他需要一个发泄途径，不然肯定得落得个走火入魔的下场。</p><p>最终，陈青看着陈松被魔教双护法联手打得重伤昏迷，最后被剑宗长老救走，重重叹了口气。</p><p>厮杀还在继续，陈青也迎来了本次最大的劫难，那就是这支荡魔联军之首，霸刀派刀主。</p><p>陈青笑道：「想学我的度厄刀吗，跪下来磕个响头叫声爷爷，我就教你。」</p><p>回应他的是一声：「找死。」</p><p>大战爆发。</p><p>传闻这场荡魔之战陆陆续续打了足足有五天五夜之久，杀得那是血流成河，浓郁的血气直笼罩整座横断山而久久不散。</p><p>此战，世人皆知魔教之底蕴深厚得令人惊叹，虽然这仅仅是昙花一现，但却足够让正道联军十不存二，连后续支援都赶之不及，可以说整个正道宗派元气大伤，恐怕百年都不一定能恢复过来，实在是两败俱伤的局面。</p><p>而此战结局，以刀主身亡，魔教灭亡为终点，以鲜血为墨，最终画上了句号。</p><blockquote><p><strong>师父</strong></p></blockquote><p>「圣教因我而毁，虽然这是他们自己的选择，但我还是难辞其咎，他们尊我为教主，而我却不能保他们平安，恨，好恨，只恨我不够强，强到那能改写天下规则的地步。」</p><p>「妖女，北王，青衫长老，虎王，左护法，逃出来的就剩这么几个人了，我相信他们，只要他们还活着，圣教总有一天还会重现世间。」</p><p>「而我，我还不能死，我要变得更强，成为那绝巅，天下规则尽由我写，我要改变这虚伪的世道。」</p><p>陈青踉跄着朝一片沼泽林走去，脸色苍白，身上青色衣衫早已染成了暗红，破破烂烂，自身血气更是降到了极点，导致胸口那条深可见骨的伤痕迟迟未能痊愈，上面一股霸道的刀意弥留，时时刻刻剐蚀着他的血肉骨髓。</p><p>尽管如此，他眼中求生的欲望还是强盛到可怕，正是这无人能及的求生欲，让他一步步化险为夷，走到了今天。</p><p>那么这次，陈青是否还能再次战胜劫难，迎来新生呢？</p><p>或许这个答案得由拦在他前面的这个老人来给。</p><p>「呵呵，没想到，最后是你。」</p><p>「师父。」</p><p>「从未言传身教，怎受得起师父二字？」老人负手而立，背对着陈青轻笑道，没有责问，没有说教，语气轻松如常，就像是两个久未素面的故人，平淡的话语下饱含热情。</p><p>这倒让陈青一时迷糊了，他沉默了会，晃晃脑袋尽量使自己保持清明，道：「我说过，你赠我刀谱，再见面，我喊你声师父。」</p><p>「却没想到是以这种方式见面。」说这句话的时候，陈青是真的感到心情有点低落。</p><p>对于老头，他是感恩的，却未能报答他的恩情。</p><p>「唉，陈青小子。」老头长叹口气，这一刻他的身影仿佛佝偻了几分，一股沧桑的气质忽然窜出，瞬间便取代了之前的仙风道骨，就好像现在才是他最真实的状态，而刚才是他的伪装，变化速度之快，令人心生疑惑。</p><p>「你受苦了。」</p><p>陈青一怔，满脸的疑惑：「喂，老头，抓我就抓我，别打感情牌啊，你之于我的恩情我自知一臂难以偿还，但放心，日后我必会百倍千倍还你。」</p><p>「但我可不会束手就擒啊，更不会被你三言两语拿下。」</p><p>「沧州大雪，你躲在死去的马肚里取暖，却仍旧命悬一线。」老头对于陈青的话语充耳未闻，仍旧自顾自说着：「荒州深林，你跟妖族厮杀，骨断筋折；中州天子脚下，你愤而锄奸去恶，被庙堂权势追杀七天七夜，无处藏身……」</p><p>老头滔滔不绝地吐着字，每吐一字，陈青内心便震撼一分，不可置信地看着这个既熟悉但更陌生的老头。</p><p>良久，老头吐出最后几句话：「陈青小子，我从你身上学到了很多，勇往直前，不默守陈规，敢于打破规则，质疑权贵，以及不管逆境如何多，如何困苦，也从不屈服的坚定意志，和一直保持初心的那颗赤子之心。」</p><p>「就算我年轻的时候也比不得你啊，我终究是老了，是糊涂了，能力越来越大，人却越活越差劲了。」</p><p>「现今所谓正道满嘴仁义道德，行的却是你争我夺，强抢霸道，打压异己之事，我早已看清，却不敢对此举剑反抗，此乃无能，此乃帮凶，助纣为虐。」</p><p>「但你敢，你也这么做了，天下只此你一人，说实话，我佩服你啊，陈青小子。」</p><p>最后这几句话陈青听得迷迷糊糊，他心烦意乱，一直沉浸在老头刚才关于他的遭遇的描述中。</p><p>「这些事，老头怎么会知道的，难道？不，不可能，怎么会！」</p><p>陈青再怎么不愿承认，但往昔记忆依然如流水般涌来，曾经没注意到的细节，不同寻常的画面现在一幕幕闪过眼前。</p><p>「原来，五毒谷底那些毒蛇是你惊走的，而且还是两次。」</p><p>「原来，那年在我快冻死之际赏我一身棉袄，一顿饱饭的行商是你。」</p><p>「原来，挟着生生果救我一命的小狐狸也是你引着来到我身边的。」</p><p>「原来，走即将走火入魔之时，突然涌进脑中的清明和顿悟也是你出手造成的。」</p><p>……</p><p>「原来……原来都是你，是你一直在背后为我遮风挡雨。」</p><p>这一刻，陈青内心被从未有过的迷茫和慌乱充斥。</p><p>一路走来，他以为自己孤苦无依，没想到背后却有一个老人在为他遮风挡雨。</p><p>他以为自己受尽磨难，内心坚如磐石，就算是陈松，他都能忍痛与他划清界限，却没想到老头所做一切，让他内心深处的柔软再次破土而出。</p><p>陈青跌跌撞撞，他不知道自己是什么时候走到的老头身后，他不知道自己是相信老头不会伤害他，还是他自己已升不起抵抗之心。</p><p>他张了张嘴，却发现自己无论如何也说不出什么话来。</p><p>「扑通」一声，陈青跪在老头身后，脸上已没有了求生之欲：「老头，我累了，不想争了，你来送我走吧，这条命给你，我瞑目的。」</p><p>回应他的，是一只长满老茧的手，粗糙且温暖。</p><p>老头摸了摸陈青脑袋，像是老人对于子孙的宠溺：「傻孩子，生命多宝贵啊，怎么能轻言生死呢，往后的路，还长着呢。」</p><p>陈青身躯猛地一颤，他触电般抬头，只看见一只苍老的手，和一面同样苍老布满皱纹的侧脸。</p><p>然后，陈青哭了，两行清泪无声落下。</p><p>快饿死的时候，他没哭；摔下悬崖的时候，他没哭；被人追杀的时候，他没哭；被当做魔头受尽委屈的时候，他也没哭。</p><p>自那一场风雪夜之后，不管再怎么困难意难平陈青都没哭，现在他却哭了，知道老头所做的一切后他哭了。</p><p>老头现在真的就是个老头，陈青从他身上感受不到一点修为波动。</p><p>原来老头在陈青来此之前早已散了毕生修为。</p><p>身为剑宗长老，老头职责在身，该阻陈青，但他散去修为，不是不阻，而是阻不了。</p><p>毕生修为，说散就散了，陈青瞬间明了一切，他泣不成声，磕着头长跪不起。</p><p>「为什么？我只是一个没有修行天赋的流浪儿，这天下有千千万万个我这样的。」</p><p>「为什么？我可是杀人不眨眼，双手沾满鲜血，人人喊打的魔头啊。」</p><p>「为什么要为我做这一切，为什么？」</p><p>「师父！」</p><p>陈青转而嚎啕大哭，他从没这样哭过，本来苍白的脸，现在却哭得满脸通红。</p><p>老头没有回答陈青的疑问，只是安静地站着，最终，他长叹一声：「走吧，快走吧，没有为什么，你是那个能改变世界的人，你就当是我对自己的救赎好了。」</p><p>风声渐熄，眼泪总有流尽的那一刻，陈青抬起头，看着老头的身影，越发佝偻。</p><p>他眼神变幻，最终脸色恢复平静，眼中露出前所未有的坚定，起身用袖子胡乱抹了一把脸，他的脸更脏了。</p><p>陈青停顿片刻之后，一言不发地大踏步向前走去，从始至终都没有转过头看一眼老头。</p><p>他不敢看他的脸，那张布满岁月痕迹的脸，它本不该如此的。</p><p>从老头身旁踏过，陈青说了一句：「我走了，老头，你可不能死得那么早啊。等我，等我做完想做的，我将这身血气渡让给你。」</p><p>「记住了，别死得这么早啊，不然我发起疯来，这天下可能就没了。」</p><p>陈青走了，消失在这个最后阻拦者的面前，也就是从今天开始，世上再也没人见过这位年轻的魔尊，但关于他的传说却越传越广，当然，都是负面传闻。</p><p>不过那又怎样呢，当他再次出世的时候，或许他真的能做到一人言，万万人臣服，那这点流言蜚语又算得了什么。</p><p>或许一年，或许五年，也或许十年，相信他不会让天下人久等的。</p><p>「哒，哒，哒」。</p><p>陈松满脸疲惫，他手持一柄断剑，拖着沉重的脚步，一步一步走向老头，也就是他的师父。</p><p>跟老头并肩站在一起，他目光望向前方黑暗幽深的五毒谷，开口问道：「他走了吗？」</p><p>「走了。」老头回答。</p><p>「那就好。」</p><hr><p><strong>故事完</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;相见&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;「喂，老头，一大把年纪了，说话可不能反悔啊！」&lt;/p&gt;
&lt;p&gt;「那是自然，今天贫道就是求也要将这痴儿求走，他可是天生的剑仙胚子。」&lt;/p&gt;
&lt;p&gt;「好好好，这小拖油瓶</summary>
      
    
    
    
    <category term="小说" scheme="https://shuangdeyu.github.io/categories/%E5%B0%8F%E8%AF%B4/"/>
    
    
    <category term="武侠" scheme="https://shuangdeyu.github.io/tags/%E6%AD%A6%E4%BE%A0/"/>
    
  </entry>
  
  <entry>
    <title>《许三观卖血记》读书笔记</title>
    <link href="https://shuangdeyu.github.io/2024/02/04/xu-san-guan-mai-xie-ji-du-shu-bi-ji/"/>
    <id>https://shuangdeyu.github.io/2024/02/04/xu-san-guan-mai-xie-ji-du-shu-bi-ji/</id>
    <published>2024-02-03T16:00:00.000Z</published>
    <updated>2024-04-07T09:12:58.598Z</updated>
    
    <content type="html"><![CDATA[<ul><li>如果他在她们中间选一个做自己的女人，一个在冬天下雪的时候和他同心协力将被子裹得紧紧的女人，他会看上林芬芳，那个辫子垂到了腰上的姑娘，笑起来牙齿又白又整齐，还有酒窝，她一双大眼睛要是能让他看上一辈子、许三观心想自己就会舒服一辈子；林芬芳也经常粑她的手拍到他的头上，推到他的胸前、有一次还偷偷在他的手背上捏了一下，<strong>那一次他把最好的蚕茧送到了她这里、从此以后他就没法把不好的蚕茧送给她了</strong>。</li></ul><blockquote><p>用平凡朴素的笔触写出了许三观对许玉兰的喜欢，没有华丽的辞藻，没有矫情的话语和心理活动，仅从简简单单的动作上进行描写，但是却更加令人印象深刻</p></blockquote><ul><li>她在大街上的行走，<strong>使她的漂亮像穿过这座城镇的河流一样被人们所熟悉</strong>，在这里人们都叫她油条西施……“你们看，油条西施走过来了。……“油条西施走到布店里去了，她天天都要去布店买漂亮的花布。”……“不是，油条西施去布店是光看不买。”……“油条西施的脸上香喷喷的。”……“油条西施的手不漂亮，她的手太短，手指太粗。”……“她就是油条西施？”……</li></ul><blockquote><p>极妙的比喻，怎么描写她的漂亮被人熟知呢，在比喻之后用对话进行了详细解释，从第三者的角度描写许玉兰自认为的漂亮，这段话其实是在说她爱漂亮，爱显摆</p></blockquote><ul><li>当时何小勇穿着干净的白衬衣，袖管卷到手腕上面，他微笑着说话时，双手握往自己的手腕，他的这个动作使许玉兰十分着迷，<strong>这个漂亮的姑娘仰脸望着他时，眼睛里闪闪发亮</strong></li></ul><blockquote><p>描写一个人对另一个人的崇拜和喜欢</p></blockquote><ul><li>那个年月城里的街上还没有路灯，只有一些灯笼挂在店铺的屋檐下面，<strong>将石板铺出来的街道一截一截地照亮，许三观一会儿黑一会儿亮地往家中走去</strong></li></ul><blockquote><p>这段描写很有画面感，很细腻，很真实</p></blockquote><ul><li>“啊呀，”许玉兰叫道，“所以你让三个儿子叫一乐，二乐，三乐，我在产房里疼了一次，二次，三次；你在外面乐了一次，二次，三次，是不是？”</li></ul><blockquote><p>重复描写法，比说“我疼了三次，你在外面乐了三次”更好，后者太显白话了，这段话一看就比较能让人抓住重点，许玉兰生三次儿子，许三观乐了三次，许玉兰嘴里喊着疼，但又何尝不乐呢</p></blockquote><ul><li>许三观将这面三角形的残镜拿在了手中，<strong>他照着自己的眼睛看了一会儿，再去看一乐的眼睛，都是眼睛；他又照着自己的鼻子看了一会儿，又去看一乐的鼻子，都是鼻子</strong>……许三观心里想：都说一乐长得不像我，我看着还是有点像</li></ul><blockquote><p>这段话也有重复的技巧在里面，眼睛都是眼睛，鼻子都是鼻子，谁的儿子不是儿子，其实是许三观有点自欺欺人的表现</p></blockquote><ul><li>许玉兰决定拆手套的时候，总是在前一天晚上睡觉前把窗户打开，把头探出去看看夜空里是不是星光灿烂，当她看到月亮闪闪发亮，又看到星星闪闪发亮，她就会断定第二天阳光肯定好，到了第二天，她就要拆手套了</li></ul><blockquote><p>这句话核心只有一个，就是在说许玉兰得到精仿手套的时候很开心，星星、月亮、阳光都是为了映衬她发自心底的开心，特别是阳光，第二天的阳光谁知道呢，因为她心情好，所以第二天的阳光肯定也好</p></blockquote><ul><li>许玉兰和二乐在那里一坐，两个人就会没完没了地说话，<strong>一个三十岁的女人和一个八岁的男孩，两个人吃完饭，两个人睡觉前，两个人一起走在街上，两个人经常越说越投机</strong></li></ul><blockquote><p>一个三十岁，一个八岁，年龄是一个反差，但紧接着后面的描写更加点睛了没完没了地说话，怎么个没完没了呢，哦，是这样子的没完没了，写出了母子关系的和谐，有爱<br>再者，这段话之后就是母子俩关于日常八卦的对话，更像是两闺蜜之间的对话，再次说明母子俩关系的好</p></blockquote><ul><li>这段不是书里一段具体的句子，而是一段剧情：书里说许三观喜欢一乐，许玉兰喜欢二乐，唯独三乐，所有人都对他说“你走开，三乐”，看起来大家都觉得三乐是拖油瓶，帮倒忙，不喜欢他，但当三乐跟别人打架的时候，二乐一乐二话不说就来帮忙，其实这家里人对三乐不是讨厌，而是爱，正是因为爱他，所以才把他保护得太好，怕他受伤</li></ul><blockquote><p>这是一种反差的写法，前面看起来有多嫌弃三乐，但当三乐有难，兄弟二话不说来维护的时候，前面有多嫌弃，现在就有多爱</p></blockquote><ul><li>和你们妈也没有别的办法，只好先把你们的小命保住，别的就顾不上了，俗话说得好，留得青山在不怕没柴烧，只要把命保住了，熬过了这昔日子，<strong>往下就是很长很长的好日子了</strong></li></ul><blockquote><p>即是那个时代的无奈，又是那个时代人们淳朴的愿望，短短几句话就写出了那个时代的苦难</p></blockquote><ul><li>说着，许玉兰掉出了眼泪，她把钱叠好放到里面的衣服口袋里，然后举起手去擦眼泪，<strong>她先是用手心擦去脸颊上的泪水，再用手指去擦眼角的泪水</strong>。</li></ul><blockquote><p>这描写就很细节，很真实，很有画面感，一般人只会写“她用手擦去脸上的泪水”，这就是高手和新手的区别</p></blockquote><ul><li><p>他一个人在桌前坐下来，将那个还热着的红薯放在桌上，开始小心翼翼地剥下红薯的皮，他看到剥开皮以后，里面是橙黄一片，就像阳光一样。他闻到了来自红薯热烈的香味，而且在香味里就已经洋溢出了甜的滋味。他咬了一口，香和甜立刻沾满了他的嘴。</p><p>那个红薯一乐才咬了四口，就没有了。之后他继续坐在那里，让舌头在嘴里卷来卷去，使残留在嘴中的红薯继续着最后的香甜，直到满嘴都是口水以后。他知道红薯已经吃完了，可是他还想吃，他就去看刚才剥下来的红薯皮，他拿起一块放到嘴里，在焦糊里他仍然吃到了香甜，于是他把红薯的皮也全吃了下去。</p></li></ul><blockquote><p>优秀的描写，写出了一个长时间没有吃过玉米糊粥之外的食物的人，对待一个简简单单的“美食”，吃出了十二分的美味</p></blockquote><ul><li>他让自己的哭声越来越响，他听到这个夜晚里什么声音都没有了，风吹来吹去的声音没有了，树叶抖动的声音没有了，身后饭店里凳子搬动的声音也没有了，只有他自己的哭声在响着，在这个夜晚里飘着。</li></ul><blockquote><p>伤心的写法，不仅聚焦于人本身，也从四周景物上面反衬他哭得是真的伤心</p></blockquote><ul><li>轮船到位城里时，天还没有亮，城里也在下雪，地上已经积了很厚的一层雪，二乐背着一乐那条棉被又盖着一乐，所以二乐走去时像是一辆三轮车那么庞大，<strong>雪地上留下他的一串脚印，脚印弯弯扭扭，深浅不一</strong>，在路灯的光线里闪闪发亮。</li></ul><blockquote><p>从侧面写出了二乐身上的重量之重，步行的困难，可以多从四周可取材的事物上描写，再反应到人身上</p></blockquote><ul><li>他要去的地方是上海，路上要经过林浦、北荡、西塘、百里、通元、松林、大桥、安昌门、靖安、黄店、虎头桥、三环洞、七里堡、黄湾、柳村、长宁、新镇。其中林浦、百里、松林、黄店、七里堡、长宁是县城，他要在这六个地方上岸卖血，他要一路卖着血去上海。</li></ul><blockquote><p>这句是写一乐到上海看病路途的遥远和困难，不是一句话概括说远，而是细致写出了要经过的地名之多，让人切切实实感受到路途的远，从而联想到一路的艰辛，也为许三观这一路要卖这么多次血而揪心，不免为他的命运担忧起来</p></blockquote><ul><li>许三观说着腾出一只手指了指自己的衣领，继续说：“这里就像是你们家的窗户，你们家的窗户到了冬天都关上了吧，冬天要是开着客户，在家里的人会冻坏的。”</li></ul><blockquote><p>许三观又何尝不是全家的窗户呢，为家人遮风挡雨</p></blockquote><ul><li>许三观走在街上时，脸上挂满了笑容，笑容使他脸上的皱纹像河水一样波动起来，阳光照在他脸上，把皱纹里面都照亮了。</li></ul><blockquote><p>记录一下，描写皱纹的好句子</p></blockquote><ul><li><p>许三观开始哭了，他敞开胸口的衣服走过去，让风呼呼地吹在他的脸上，吹在他的胸口；让混浊的眼泪涌出眼眶，沿着两侧的脸颊刷刷地流，流到了脖子里，流到了胸口上，他抬起手去擦了擦，眼泪又流到了他的手上，在他的手掌上流，也在他的手背上流。</p><p>他的脚在往前走，他的眼泪在往下流。他的头抬着。他的胸也挺着，他的腿迈出去时坚强有力，他的胳膊甩动时也是毫不迟疑，可是他脸上充满了悲伤。他的泪水在他脸上纵横交错地流，就像雨水打在窗玻璃上，就像裂缝爬上炔要破碎的碗，就像蓬勃生长出去的树枝，就像渠水流进了田地，就像街道布满了城镇，泪水在他脸上织成了一张网。</p></li></ul><blockquote><p>很细致的极度伤心的描写</p></blockquote><ul><li><strong>屌毛出得比眉毛晚，长得倒比眉毛长</strong></li></ul><hr><p>一刷完毕，期待二刷有更多的收获，是一部优秀的作品</p>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;如果他在她们中间选一个做自己的女人，一个在冬天下雪的时候和他同心协力将被子裹得紧紧的女人，他会看上林芬芳，那个辫子垂到了腰上的姑娘，笑起来牙齿又白又整齐，还有酒窝，她一双大眼睛要是能让他看上一辈子、许三观心想自己就会舒服一辈子；林芬芳也经常粑她的手拍到他的头上，</summary>
      
    
    
    
    <category term="读书" scheme="https://shuangdeyu.github.io/categories/%E8%AF%BB%E4%B9%A6/"/>
    
    
    <category term="经典" scheme="https://shuangdeyu.github.io/tags/%E7%BB%8F%E5%85%B8/"/>
    
    <category term="余华" scheme="https://shuangdeyu.github.io/tags/%E4%BD%99%E5%8D%8E/"/>
    
  </entry>
  
  <entry>
    <title>《如何阅读一本书》笔记-转载</title>
    <link href="https://shuangdeyu.github.io/2024/01/31/ru-he-yue-du-yi-ben-shu-bi-ji/"/>
    <id>https://shuangdeyu.github.io/2024/01/31/ru-he-yue-du-yi-ben-shu-bi-ji/</id>
    <published>2024-01-30T16:00:00.000Z</published>
    <updated>2024-02-02T06:04:04.648Z</updated>
    
    <content type="html"><![CDATA[<p>《如何阅读一本书》，这是一本探讨和教授阅读方法的经典书籍，我读了前面八章（中文版），的确有很多实用性的方法，但整体来说偏啰嗦，一个论点引申开来的篇幅太长了，其实它核心论点不多，就这么几个，其实它就是一本工具书。</p><p>本来想自己整理的，但看了网上有很多整理好的优秀笔记，我就转载一个喜欢的到这里，方便自己日常回顾（协议允许转载我才转载的）</p><blockquote><p>原文地址：<a href="https://leovan.me/cn/2019/02/how-to-read-a-book/">https://leovan.me/cn/2019/02/how-to-read-a-book/</a> （Copyright © 2017-2024 范叶亮 | Leo Van）</p></blockquote><hr><h2 id="阅读的层次"><a href="#阅读的层次" class="headerlink" title="阅读的层次"></a>阅读的层次</h2><blockquote><p>第一提醒读者，阅读可以是一件多少主动的事。第二要指出的是，阅读越主动，效果越好。</p></blockquote><p>读书，不是非做不可的事，而是想要去做的事。——《<a href="https://movie.douban.com/subject/1465654/">女王的教室</a>》</p><blockquote><p>阅读的目标：为获得资讯而读，以及为求的理解而读。</p></blockquote><p>也就是说，阅读类似学习，知其然，知其所以然。</p><blockquote><p>阅读就是学习：指导型的学习，以及自我发现型的学习之间的差异。</p></blockquote><p>独立的思考与思辨。</p><p>阅读的层次分为：</p><ol><li>基础阅读 (Elementary Reading)</li><li>检视阅读 (Inspectional Reading)</li><li>分析阅读 (Analytical Reading)</li><li>主题阅读 (Syntopical Reading)</li></ol><h2 id="基础阅读"><a href="#基础阅读" class="headerlink" title="基础阅读"></a>基础阅读</h2><p>基础阅读的四个阶段：</p><ol><li>阅读准备阶段，相当于学前教育或幼稚园的学习经验。</li><li>认字，相当于一年级学生典型的学习经验。</li><li>字汇的增长及对课文的运用，通常是四年级结束时学会的方法。</li><li>“成熟”的阅读者，小学或初中毕业时的读写能力。</li></ol><blockquote><p>无限制的受教育机会是一个社会能提供给人民最有价值的服务。</p></blockquote><h2 id="检视阅读"><a href="#检视阅读" class="headerlink" title="检视阅读"></a>检视阅读</h2><h3 id="有系统的略读或粗读"><a href="#有系统的略读或粗读" class="headerlink" title="有系统的略读或粗读"></a>有系统的略读或粗读</h3><p>略读 (Skimming) 和粗读 (Pre-reading) 是检视阅读的第一个层次，用不着花太多时间，如何去做，建议如下：</p><ol><li>先看书名页，然后如果有序就先看序。</li><li>研究目录页，对书的基本架构做概括性的理解。</li><li>如果书中附有索引，也要检阅一下。</li><li>读一下出版者的介绍。</li><li>挑几个看来跟主题息息相关的篇章来看。</li><li>东翻翻西翻翻，念一两段，连续读几页，不要太多。</li></ol><p>在最多不超过一个小时的时间内对书有个大概的了解其是否包含你还想继续挖掘下去的内容，是否值的你再继续投入时间与注意。</p><h3 id="粗浅的阅读"><a href="#粗浅的阅读" class="headerlink" title="粗浅的阅读"></a>粗浅的阅读</h3><blockquote><p>头一次面对一本难读的书的时候，从头到尾读完一遍，碰到不懂的地方<strong>不要</strong>停下来查询或思索。</p></blockquote><blockquote><p>在阅读一本书的时候，慢不该慢的不值得，快不该快到有损于满足与理解。</p></blockquote><blockquote><p>略读或粗读一本书总是个好主意，尤其当你并不清楚手边的一本书是否值的细心阅读时。</p></blockquote><blockquote><p>在第一次阅读一本难读的书时，不要企图了解每一个子句。</p></blockquote><h3 id="做一个自我要求的读者"><a href="#做一个自我要求的读者" class="headerlink" title="做一个自我要求的读者"></a>做一个自我要求的读者</h3><p>在阅读时要提出问题来，同时自己必须尝试去回答这些问题：</p><ol><li>整体来说，这本书到底在谈些什么？(主题)</li><li>作者细部说了什么，怎么说的？(细节)</li><li>这本书说得有道理吗？是全部有道理，还是部分有道理？(个人的评价)</li><li>这本书跟你有什么关系？(意义)</li></ol><p>这四个问题概括了一个阅读者的责任，<strong>读书要对书负责，更要对自己负责</strong>。</p><blockquote><p>你必须读出言外之意，才会有更大的收获，我们也鼓励你“写出言外之意”。</p></blockquote><p>对于阅读来说，在书上做笔记是不可或缺的事。</p><ol><li>可以让你保持清醒，不只是不昏睡，还是非常清醒。</li><li>主动的阅读是一种思考，而写出来是阅读者表达思考的好方法。</li><li>将自己的感想写下来，有助于记住作者的思想。</li></ol><blockquote><p>培养阅读的习惯，除了不断地运作练习之法，别无他法。</p></blockquote><blockquote><p>我们谈到一个有技术的人时，并不是在说他知道该如何去做那件事，而是他已经养成去做那件是的习惯了。</p></blockquote><h2 id="分析阅读"><a href="#分析阅读" class="headerlink" title="分析阅读"></a>分析阅读</h2><h3 id="第一阶段"><a href="#第一阶段" class="headerlink" title="第一阶段"></a>第一阶段</h3><blockquote><p><strong>规则 1</strong><br>你一定要知道自己在读的是哪一类书，而且越早知道越好。最好早在你开始阅读之前就先知道。</p></blockquote><blockquote><p>我们一定要超越“<strong>知道这是怎么回事</strong>”，进而明白“<strong>如果我们想做些什么，应该怎么利用它</strong>”。</p></blockquote><p>也就是我们需要做到<strong>知行合一</strong>。</p><blockquote><p>理论性作品是在教你<strong>这是什么</strong>，实用性的作品是在教你<strong>如何去做</strong>你想要做的事，或你认为应该做的事。</p></blockquote><blockquote><p>实用的书常会出现“<strong>应该</strong>”和“<strong>应当</strong>”，“<strong>好</strong>”和“<strong>坏</strong>”，“<strong>结果</strong>”和“<strong>意义</strong>”之类的字眼，相反的理论型作品却常常说“<strong>是</strong>”。</p></blockquote><p>理论性作品可以分为：</p><ol><li>历史，历史就是纪事，常以说故事的形态出现。</li><li>科学，以实验为基础，或依赖精确的观察研究，并不容易被证明。</li><li>哲学，是坐在摇椅上的思考，相对容易被观察和理解。</li></ol><blockquote><p><strong>规则 2</strong><br>使用一个单一的句子，或最多几句话（一小段文字）来叙述整本书的内容。</p></blockquote><p>也就是用你的话告诉别人这本书在讲什么。</p><blockquote><p><strong>规则 3</strong><br>将书中重要的篇章列举出来，说明它们如何按照顺序组成一个整体的架构。</p></blockquote><blockquote><p>规则 2 是在指导你注意一本书的整体性，规则 3 是在强调一本书的复杂度。</p></blockquote><blockquote><p>写作与阅读是一体两面的事，就像教书与被教一样。</p></blockquote><blockquote><p>一个作品应该<strong>有整体感，清楚明白，前后连贯</strong>。</p></blockquote><blockquote><p><strong>规则 4</strong><br>找出作者要问的问题。</p></blockquote><blockquote><p>第一阶段的目的就是掌握结构大纲。</p></blockquote><h3 id="第二阶段"><a href="#第二阶段" class="headerlink" title="第二阶段"></a>第二阶段</h3><blockquote><p><strong>规则 5</strong><br>找出重要的单字，透过他们与作者达成共识。</p></blockquote><p>字词只是作者表达的工具，我们需要通过这些字词探索作者想表达的本意。</p><blockquote><p>一本书之所以能给你带来新的洞察力或启发，就是因为其中有一些你不能一读即懂的字句。</p></blockquote><blockquote><p><strong>规则 6</strong><br>将一本书中最重要的句子圈出来，找出其中的主旨。</p></blockquote><blockquote><p>主旨则是这些问题的答案。</p></blockquote><blockquote><p>阅读的一部分本质就是<strong>被困惑，而且知道自己被困惑</strong>。</p></blockquote><p>惑，知惑！</p><blockquote><p><strong>规则 7</strong><br>从相关文句的关联中，设法架构出一本书的基本论述。</p></blockquote><ol><li>要记住所有的论述都包含了一些声明。</li><li>要区别两种论述的不同之处。归纳法：以一个或多个特殊的事实证明某种共通的概念，演绎法：以连串的通则来证明更进一步的共通概念。</li><li>找出作者认为哪些事情是<strong>假设</strong>，哪些是能<strong>证实</strong>的或有根据的，以及哪些是不需要证实的<strong>自明之理</strong>。</li></ol><blockquote><p><strong>规则 8</strong><br>找出作者的解答。</p></blockquote><h3 id="第三阶段"><a href="#第三阶段" class="headerlink" title="第三阶段"></a>第三阶段</h3><blockquote><p>遵守思维的礼节。</p></blockquote><blockquote><p>最能学习的读者，也就是最能批评的读者。</p></blockquote><p>受教是一种美德，但受教并非是被动的顺从，而是主动的思考。</p><blockquote><p><strong>规则 9</strong><br>在你说出“我同意”，“我不同意”，或“我暂缓评论”之前，你一定要能肯定的说：“我了解了”。</p></blockquote><blockquote><p>毫无理解便同意只是愚蠢，还不清楚便不同意也是无礼。</p></blockquote><blockquote><p><strong>规则 10</strong><br>当你不同意作者的观点时，要理性地表达自己的意见，不要无礼地辩驳或争论。</p></blockquote><blockquote><p>争议是教导与受教的一个过程。</p></blockquote><blockquote><p><strong>规则 11</strong><br>尊重知识与个人观点的不同，在作任何评断之前，都要找出理论基础。</p></blockquote><p>事无对错，需有理有据，避免口舌之争。</p><blockquote><p>当读者不只是盲目地跟从作者的论点，还能和作者的论点针锋相对时，他最后才能提出同意或反对的有意义的评论。</p></blockquote><blockquote><p><strong>规则 12</strong><br>说一位作者知识不足，就是说他缺少某些与他想要解决的问题相关的知识。</p></blockquote><blockquote><p>除非这些知识确实相关，否则就没有理由作这样的评论。</p></blockquote><blockquote><p><strong>规则 13</strong><br>说一位作者的知识错误，就是说他的理念不正确。</p></blockquote><blockquote><p>论点与事实相反。</p></blockquote><blockquote><p><strong>规则 14</strong><br>说一位作者是不和逻辑的，就是说他的推论荒谬。</p></blockquote><blockquote><p>荒谬有两种形态：一种是<strong>缺乏连贯</strong>，也就是结论冒出来了，却跟前面所说的理论连不起来。另一种是<strong>事件变化的前后不一致</strong>，也就是作者所说的两件事是前后矛盾的。</p></blockquote><blockquote><p><strong>规则 15</strong><br>说一位作者的分析是不完整的，就是说他并没有解决他一开始提出来的所有问题。</p></blockquote><blockquote><p>严格来说，规则 15 并不能作为不同意一个作者的根据。我们只能就作者的成就是有限的这一点而站在对立面上。</p></blockquote><h3 id="CHEAT-SHEET"><a href="#CHEAT-SHEET" class="headerlink" title="CHEAT SHEET"></a>CHEAT SHEET</h3><ul><li>分析阅读的第一阶段：找出一本书在谈些什么的规则<ul><li>(1). 依照书本的种类与主题作分类。</li><li>(2). 用最简短的句子说出整本书在谈些什么。</li><li>(3). 按照顺序与关系，列出全书的重要部分。将全书的纲要拟出来之后，再将各个部分的纲要也一一列出。</li><li>(4). 找出作者在问的问题，或作者想要解决的问题。</li></ul></li><li>分析阅读的第二阶段：诠释一本书的内容规则<ul><li>(5). 诠释作者使用的关键字，与作者达成共识。</li><li>(6). 从最重要的句子中抓出作者的重要主旨。</li><li>(7). 找出作者的论述，重新架构这些论述的前因后果，以明白作者的主张。</li><li>(8). 确定作者已经解决了哪些问题，还有哪些是未解决的。在未解决的问题中，确定哪些是作者认为自己无法解决的问题。</li></ul></li><li>分析阅读的第三阶段：像是沟通知识一样地评论一本书的规则<ul><li>A. 智慧礼节的一般规则</li><li>(9). 除非你已经完成大纲架构，也能诠释整本书了，否则不要轻易批评。（在你说出：“我读懂了”之前，不要说你同意、不同意或暂缓评论。）</li><li>(10). 不要争强好胜，非辩到底不可。</li><li>(11). 在说出评论之前，你要能证明自己区别得出真正的知识与个人观点的不同。</li><li>B. 批评观点的特别标准</li><li>(12). 证明作者的知识不足。</li><li>(13). 证明作者的知识错误。</li><li>(14). 证明作者不合逻辑。</li><li>(15). 证明作者的分析与理由是不完整的。</li></ul></li></ul><h3 id="辅助阅读"><a href="#辅助阅读" class="headerlink" title="辅助阅读"></a>辅助阅读</h3><blockquote><p><strong>内在阅读</strong>，是指阅读书籍本身，于所有其他的书都是不相关的。<strong>外在阅读</strong>，是指借助其他的一些书籍来阅读一本书。</p></blockquote><blockquote><p>外在的辅助来源可以分为四个部分：相关经验，其他的书，导论与摘要，工具书。</p></blockquote><blockquote><p>导读和摘要要尽量少用，因为：一本书的导读并不一定都是对的，就算他们写对了，可能也不完整。</p></blockquote><blockquote><p>如果你在阅读全书之前，先看了他的导读手册，你就隶属于他了。</p></blockquote><p>这也是为什么我不喜欢将自己<strong>看过</strong>的书借给其他人的原因，我不希望其他读者在第一次读这本书的时候就被我记录在书上的笔记所影响。</p><h2 id="阅读不同读物的方法"><a href="#阅读不同读物的方法" class="headerlink" title="阅读不同读物的方法"></a>阅读不同读物的方法</h2><h3 id="阅读实用型的书"><a href="#阅读实用型的书" class="headerlink" title="阅读实用型的书"></a>阅读实用型的书</h3><blockquote><p>分析阅读的规则，一般来说适用于<strong>论说性</strong>的作品，也就是说任何一种传达知识的书。</p></blockquote><blockquote><p>任何实用性的书<strong>都不能</strong>解决该书所关心的问题。</p></blockquote><blockquote><p>实用性的书分为两类：其中一种，就像本书一样，或是烹饪书、驾驶指南，基本上都是在<strong>说明规则</strong>的。另一类的主要是在阐述<strong>形成规则的原理</strong>，许多伟大的经济、政治、道德巨著就属于这一类。</p></blockquote><p>在读实用性的书要提出的四个问题：</p><ol><li>这本书在谈些什么？</li><li>找出作者的共识、主旨和论述。</li><li>内容真实吗？（比前两点重要）</li><li>这本书于我何干？</li></ol><blockquote><p>赞同一本实用性的书，需要你采取行动。</p></blockquote><h3 id="阅读想象文学"><a href="#阅读想象文学" class="headerlink" title="阅读想象文学"></a>阅读想象文学</h3><blockquote><p>想象文学的主要目的是<strong>娱乐</strong>，而非<strong>教育</strong>。</p></blockquote><p>关于阅读想象文学，建议的否定指令：</p><ol><li>不要抗拒想象文学带给你的影响力。（生活不只有眼前的苟且，还有诗和远方）</li><li>在想象文学中，不要去找共识、主旨和论述。</li><li>不要用适用于传递知识的，与真理一致的标准来批评小说。（一千个人眼中有一千个哈姆雷特）</li></ol><p>阅读小说的规则：</p><ol><li>架构性：</li></ol><ul><li>你必须将想象文学作品分类。</li><li>你要抓住整本书的大意，一篇故事的大意总是在情节之中。</li><li>你不仅能够将整本书简化为大意，还要能发现整本书各个部分是如何架构起来的。</li></ul><ol><li>诠释性：</li></ol><ul><li>小说的要素是插曲、事件、角色与他们的思想、言语、感觉及行动。</li><li>共识与主旨有关。（尝试身临其境）</li><li>任何活动就是论述的发展。</li></ul><ol><li>评论性</li></ol><ul><li>在你衷心感谢作者试着为你创造的经验之前，不要批评一本想象的作品。</li><li>不该反对或赞成，而是喜欢或不喜欢。</li></ul><h3 id="阅读故事、戏剧与诗"><a href="#阅读故事、戏剧与诗" class="headerlink" title="阅读故事、戏剧与诗"></a>阅读故事、戏剧与诗</h3><blockquote><p>暴君并不怕唠叨的作家宣扬自由的思想，他害怕一个醉酒的诗人说了一个笑话，吸引了全民的注意力。<br>所谓“纯”艺术，并不是因为“精致”或“完美”，而是因为作品本身就是一个结束，不再与其他的影响有关。就如同爱默生所说的，<strong>美的本身就是存在的唯一标准</strong>。</p></blockquote><p>阅读故事书的规则：</p><ol><li>快读，并且全心全意地读。</li><li>整本书在谈些什么？一个故事的词义，存在于角色与事件之中。</li><li>批评小说时，要区分是满足<strong>个人特殊</strong>潜意识需求的小说还是<strong>大多数人</strong>潜意识的小说。</li></ol><p>阅读抒情诗的规则：</p><ol><li>不论你自己觉得懂不懂，都要一口气读完，不要停。</li><li>重读一遍，大声读出来。</li></ol><blockquote><p>对论说性作品所提出的问题是文法与逻辑上的问题。对抒情诗的问题却通常是修辞的问题，或是句法的问题。</p></blockquote><blockquote><p>要了解一首诗，一定要去<strong>读</strong>它，一遍又一遍地读。</p></blockquote><h3 id="阅读历史书"><a href="#阅读历史书" class="headerlink" title="阅读历史书"></a>阅读历史书</h3><blockquote><p>就事实而言的历史 (history of fact) 与就书写记录而言的历史 (history as a written record of the facts) 是不同的。</p></blockquote><blockquote><p>历史的基本是叙事的。</p></blockquote><p>所以叙事应尽可能的公平，公正地描述所发生的事情。</p><blockquote><p>历史<strong>比较</strong>接近小说，而非科学。这并不是说历史学家在<strong>捏造</strong>事实，就像诗人或小说家那样。</p></blockquote><blockquote><p>历史根本就没有模式可循。</p></blockquote><p>在了解一个已经发生过的事情时，最好多听取几个不同的版本，哪怕每个人的陈述都已经尽可能的公平公正了，但也可能会存在信息的丢失。</p><blockquote><p>修昔底德说过，他写历史的原因是：希望经由他所观察到的错误，以及他个人受到的灾难与国家所受的苦楚，将来的人们不会重蹈覆辙。</p></blockquote><p>以铜为鉴，可以正衣冠，以人为鉴，可以知得失，以史为鉴，可以知兴替。</p><p>阅读历史书要提出的问题：</p><ol><li>每一本历史书都有一个特殊而且有限定范围的主题。</li><li>历史书在说一个故事，而这个故事当然是发生在一个特定的时间里。</li><li>这与我何干？历史会建议一些可行性，因为那是以前的人已经做过的事。</li></ol><p>传记包含很多类型：</p><ol><li>定案本 (definitive) 的传记是对一个人的一生作详尽完整的学术性报告，这个人重要到够得上写这种完结篇的传记。定案本的传记<strong>决不能</strong>用来写活着的人。</li><li>授权本 (authorized) 的传记通常是由继承人，或是某个重要人物的朋友来负责的。读这种书不能像读一般的历史书一样，读者必须了解作者可能会有<strong>偏见</strong>。</li><li>自传所写的都是还未完结的生活。对于任何自传都要有一点疑心，同时别忘了，在你还不了解一本书之前，不要妄下论断。</li></ol><h3 id="阅读科学与数学"><a href="#阅读科学与数学" class="headerlink" title="阅读科学与数学"></a>阅读科学与数学</h3><blockquote><p>科学的客观不在于没有<strong>最初的偏见</strong>，而在于<strong>坦白承认</strong>。</p></blockquote><blockquote><p>科学基本上是<strong>归纳法</strong>，基本的论述也就是经由研究查证，建立出来的一个通则。</p></blockquote><blockquote><p>只要你记住，你的责任不是成为这个主题的专家，而是要去了解相关的问题，在阅读时就会轻松许多。</p></blockquote><h3 id="阅读哲学书"><a href="#阅读哲学书" class="headerlink" title="阅读哲学书"></a>阅读哲学书</h3><p>我想在进一步阅读或学习如何阅读哲学书之前，最好针对这个相对特殊的类别有一个简要的科普。待我对其窥见一斑后再回来补充这一章节。</p><h3 id="阅读社会科学"><a href="#阅读社会科学" class="headerlink" title="阅读社会科学"></a>阅读社会科学</h3><blockquote><p>社会科学不是一个完全独立的学科。诸如人类学、经济学、政治学、社会学的学科，都是组成社会科学的核心。大部分有关法律、教育、公共行政的作品，及一部分商业、社会服务的作品，再加上大量的心理学作品，也适合社会科学的定义。</p></blockquote><blockquote><p>阅读社会科学时，关于一个主题通常要读好几本书，而不会只读一本书。主要的着眼点在一个<strong>特殊的事件或问题</strong>上，而非一个<strong>特殊的作者或一本书</strong>。</p></blockquote><h2 id="主题阅读"><a href="#主题阅读" class="headerlink" title="主题阅读"></a>主题阅读</h2><blockquote><p>在作主题阅读时，第一个要求就是知道：对一个特定的问题来说，所牵涉的绝对不是一本书而已。第二个要求则是：要知道就总的来说，应该读的是哪些书？第二个要求比第一个要求还难做到。</p></blockquote><blockquote><p>分析阅读的技巧只适用于单一的作品，主要的目标是要了解这本书。</p></blockquote><p>在主题阅读的准备阶段包含如下步骤：</p><ol><li>针对你要研究的主题，设计一份实验性的书目。你可以参考图书馆目录，专家的建议与书中的书目索引。</li><li>浏览这份书目上所有的书，确定哪些与你的主题相关，并就你的主题建立起清楚的概念。</li></ol><p>主题阅读一共有五个步骤，这些步骤不能称之为规则，因为只要漏掉其中一个步骤，主题阅读就会变得很困难。</p><ol><li>浏览所有在准备阶段被认定与你主题相关的书，找出最相关的章节。</li><li>根据主题创造出一套中立的词汇，带引作者与你达成共识，无论作者是否实际用到这些词汇，所有的作者，或至少绝大部分的作者都可以用这套词汇来诠释。</li><li>建立一个中立的主旨，列出一连串的问题，无论作者是否明白谈过这些问题，所有的作者，或者至少大多数的作者都要能解读为针对这些问题提供了他们的回答。</li><li>界定主要及次要的议题。然后将作者针对各个问题的不同意见整理陈列在各个议题之旁。你要记住，各个作者之间或之中，不见得一定存在着某个议题。有时候，你需要针对一些不是作者主要关心的范围的事情，把他的观点解读，才能建构出这种议题。</li><li>分析这些讨论。这得把问题和议题按照顺序排列，以求突显主题。比较有共通性的议题，要放在比较没有共通性的议题之前。各个议题之间的关系也要清楚得界定出来。</li></ol><h2 id="心智成长"><a href="#心智成长" class="headerlink" title="心智成长"></a>心智成长</h2><blockquote><p>对你来说最重要的是，你不只要能读得好，还有有能力分辨出哪些书能够帮助你增进阅读能力。</p></blockquote><p>读一本好书，会让你的努力有所回报：</p><ol><li>当你成功地阅读了一本难读的好书之后，你的阅读技巧必然增进了。</li><li>一本好书能教你了解这个世界以及你自己。</li></ol><blockquote><p>一本书如果是可以让你学习的书，重读的时候，你会发现书中的内容好像比你记忆中的少了许多。如果这本书属于更高层次的书，你在重读的时候会发现这本书好像与你一起成长了。</p></blockquote><blockquote><p>好的阅读，也就是主动的阅读，不只是对阅读本身有用，也不只是对我们的工作或事业有帮助，更能帮助我们的心智保持活力与成长。</p></blockquote><hr><blockquote><p>再次申明，本文来源：<a href="https://leovan.me/cn/2019/02/how-to-read-a-book/">https://leovan.me/cn/2019/02/how-to-read-a-book/</a> （Copyright © 2017-2024 范叶亮 | Leo Van）</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;《如何阅读一本书》，这是一本探讨和教授阅读方法的经典书籍，我读了前面八章（中文版），的确有很多实用性的方法，但整体来说偏啰嗦，一个论点引申开来的篇幅太长了，其实它核心论点不多，就这么几个，其实它就是一本工具书。&lt;/p&gt;
&lt;p&gt;本来想自己整理的，但看了网上有很多整理好的优秀笔</summary>
      
    
    
    
    <category term="读书" scheme="https://shuangdeyu.github.io/categories/%E8%AF%BB%E4%B9%A6/"/>
    
    
    <category term="工具书" scheme="https://shuangdeyu.github.io/tags/%E5%B7%A5%E5%85%B7%E4%B9%A6/"/>
    
    <category term="经典" scheme="https://shuangdeyu.github.io/tags/%E7%BB%8F%E5%85%B8/"/>
    
  </entry>
  
  <entry>
    <title>gofpdf示例文档</title>
    <link href="https://shuangdeyu.github.io/2024/01/30/gofpdf-shi-li-wen-dang/"/>
    <id>https://shuangdeyu.github.io/2024/01/30/gofpdf-shi-li-wen-dang/</id>
    <published>2024-01-29T16:00:00.000Z</published>
    <updated>2024-01-31T02:05:50.429Z</updated>
    
    <content type="html"><![CDATA[<p>最近在做Golang创建PDF方面的项目，一通找寻后主要定位到了两个现成的PDF库，也是网上比较流行的直接引用库，一个是<a href="https://github.com/signintech/gopdf">gopdf</a>，另一个是<a href="https://github.com/jung-kurt/gofpdf/tree/master">gofpdf</a></p><p>这两个库基本功能大致相同，都包含了常用的一些PDF功能，但还是有一些区别，正是这些区别导致我选择了<strong>gofpdf</strong></p><p><strong>gofpdf</strong> 已经归档了，不再更新，而 <strong>gopdf</strong> 还在更新中，但更新速度也是比较缓慢的，最近一次更新还是两个月前</p><p>而 <strong>gofpdf</strong> 对字体样式的支持更加丰富，能够设置加粗，斜体等功能，所以我的项目中选择了它，不过它的文档不够丰富，所以我翻译了下它test文件里面的代码，当做一个示例查询目录，使用的时候方便点</p><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">Example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>gofpdf<span class="token punctuation">.</span>OrientationPortrait<span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Hello World!"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"basic"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/basic.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示页眉、页脚和分页符的生成"><a href="#演示页眉、页脚和分页符的生成" class="headerlink" title="演示页眉、页脚和分页符的生成"></a>演示页眉、页脚和分页符的生成</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_AddPage demonsrates the generation of headers, footers and page breaks.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTopMargin</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetHeaderFuncMode</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetY</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Title"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFooterFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetY</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Page %d/&#123;nb&#125;"</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">PageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AliasNbPages</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">40</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Printing line number %d"</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_AddPage"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_AddPage.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示换行、行对齐和分页"><a href="#演示换行、行对齐和分页" class="headerlink" title="演示换行、行对齐和分页"></a>演示换行、行对齐和分页</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_MultiCell demonstrates word-wrapping, line justification and</span><span class="token comment">// page-breaking.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_MultiCell</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>titleStr <span class="token operator">:=</span> <span class="token string">"20000 Leagues Under the Seas"</span>pdf<span class="token punctuation">.</span><span class="token function">SetTitle</span><span class="token punctuation">(</span>titleStr<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAuthor</span><span class="token punctuation">(</span><span class="token string">"Jules Verne"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetHeaderFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Arial bold 15</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token comment">// Calculate width of title and position</span>wd <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetStringWidth</span><span class="token punctuation">(</span>titleStr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">210</span> <span class="token operator">-</span> wd<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">// Colors of frame, background and text</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token comment">// Thickness of frame (1 mm)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">// Title</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>wd<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> titleStr<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token comment">// Line break</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFooterFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Position at 1.5 cm from bottom</span>pdf<span class="token punctuation">.</span><span class="token function">SetY</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token comment">// Arial italic 8</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token comment">// Text color in gray</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token comment">// Page number</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Page %d"</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">PageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>chapterTitle <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>chapNum <span class="token builtin">int</span><span class="token punctuation">,</span> titleStr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// // Arial 12</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token comment">// Background color</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token comment">// Title</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Chapter %d : %s"</span><span class="token punctuation">,</span> chapNum<span class="token punctuation">,</span> titleStr<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token comment">// Line break</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>chapterBody <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>fileStr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Read text file</span>txtStr<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">// Times 12</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token comment">// Output justified text</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>txtStr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment">// Line break</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">// Mention in italics</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"(end of excerpt)"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>printChapter <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>chapNum <span class="token builtin">int</span><span class="token punctuation">,</span> titleStr<span class="token punctuation">,</span> fileStr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">chapterTitle</span><span class="token punctuation">(</span>chapNum<span class="token punctuation">,</span> titleStr<span class="token punctuation">)</span><span class="token function">chapterBody</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token function">printChapter</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"A RUNAWAY REEF"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">TextFile</span><span class="token punctuation">(</span><span class="token string">"20k_c1.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">printChapter</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"THE PROS AND CONS"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">TextFile</span><span class="token punctuation">(</span><span class="token string">"20k_c2.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_MultiCell"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_MultiCell.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何生成具有多列的PDF文档"><a href="#演示如何生成具有多列的PDF文档" class="headerlink" title="演示如何生成具有多列的PDF文档"></a>演示如何生成具有多列的PDF文档</h2><p>这是通过SetLeftMargin()和Cell()方法完成的</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetLeftMargin demonstrates the generation of a PDF document that has multiple</span><span class="token comment">// columns. This is accomplished with the SetLeftMargin() and Cell() methods.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetLeftMargin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> y0 <span class="token builtin">float64</span><span class="token keyword">var</span> crrntCol <span class="token builtin">int</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDisplayMode</span><span class="token punctuation">(</span><span class="token string">"fullpage"</span><span class="token punctuation">,</span> <span class="token string">"TwoColumnLeft"</span><span class="token punctuation">)</span>titleStr <span class="token operator">:=</span> <span class="token string">"20000 Leagues Under the Seas"</span>pdf<span class="token punctuation">.</span><span class="token function">SetTitle</span><span class="token punctuation">(</span>titleStr<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAuthor</span><span class="token punctuation">(</span><span class="token string">"Jules Verne"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>setCol <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>col <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Set position at a given column</span>crrntCol <span class="token operator">=</span> colx <span class="token operator">:=</span> <span class="token number">10.0</span> <span class="token operator">+</span> <span class="token function">float64</span><span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">65.0</span>pdf<span class="token punctuation">.</span><span class="token function">SetLeftMargin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>chapterTitle <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>chapNum <span class="token builtin">int</span><span class="token punctuation">,</span> titleStr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Arial 12</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token comment">// Background color</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token comment">// Title</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Chapter %d : %s"</span><span class="token punctuation">,</span> chapNum<span class="token punctuation">,</span> titleStr<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token comment">// Line break</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>y0 <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">GetY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>chapterBody <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>fileStr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Read text file</span>txtStr<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">// Font</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token comment">// Output text in a 6 cm width column</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>txtStr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">// Mention</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"(end of excerpt)"</span><span class="token punctuation">)</span><span class="token comment">// Go back to first column</span><span class="token function">setCol</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>printChapter <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>num <span class="token builtin">int</span><span class="token punctuation">,</span> titleStr<span class="token punctuation">,</span> fileStr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Add chapter</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">chapterTitle</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> titleStr<span class="token punctuation">)</span><span class="token function">chapterBody</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">SetAcceptPageBreakFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">&#123;</span><span class="token comment">// Method accepting or not automatic page break</span><span class="token keyword">if</span> crrntCol <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token punctuation">&#123;</span><span class="token comment">// Go to next column</span><span class="token function">setCol</span><span class="token punctuation">(</span>crrntCol <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">// Set ordinate to top</span>pdf<span class="token punctuation">.</span><span class="token function">SetY</span><span class="token punctuation">(</span>y0<span class="token punctuation">)</span><span class="token comment">// Keep on page</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">&#125;</span><span class="token comment">// Go back to first column</span><span class="token function">setCol</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">// Page break</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetHeaderFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Arial bold 15</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token comment">// Calculate width of title and position</span>wd <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetStringWidth</span><span class="token punctuation">(</span>titleStr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">210</span> <span class="token operator">-</span> wd<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">// Colors of frame, background and text</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token comment">// Thickness of frame (1 mm)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">// Title</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>wd<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> titleStr<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token comment">// Line break</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token comment">// Save ordinate</span>y0 <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">GetY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFooterFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Position at 1.5 cm from bottom</span>pdf<span class="token punctuation">.</span><span class="token function">SetY</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token comment">// Arial italic 8</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token comment">// Text color in gray</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token comment">// Page number</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Page %d"</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">PageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token function">printChapter</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"A RUNAWAY REEF"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">TextFile</span><span class="token punctuation">(</span><span class="token string">"20k_c1.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">printChapter</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"THE PROS AND CONS"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">TextFile</span><span class="token punctuation">(</span><span class="token string">"20k_c2.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetLeftMargin_multicolumn"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SetLeftMargin_multicolumn.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示文字换行的表格单元格"><a href="#演示文字换行的表格单元格" class="headerlink" title="演示文字换行的表格单元格"></a>演示文字换行的表格单元格</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SplitLines_tables demonstrates word-wrapped table cells</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SplitLines_tables</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>colCount <span class="token operator">=</span> <span class="token number">3</span>colWd    <span class="token operator">=</span> <span class="token number">60.0</span>marginH  <span class="token operator">=</span> <span class="token number">15.0</span>lineHt   <span class="token operator">=</span> <span class="token number">5.5</span>cellGap  <span class="token operator">=</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token comment">// var colStrList [colCount]string</span><span class="token keyword">type</span> cellType <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>str  <span class="token builtin">string</span>list <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>ht   <span class="token builtin">float64</span><span class="token punctuation">&#125;</span><span class="token keyword">var</span> <span class="token punctuation">(</span>cellList <span class="token punctuation">[</span>colCount<span class="token punctuation">]</span>cellTypecell     cellType<span class="token punctuation">)</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// 210 x 297</span>header <span class="token operator">:=</span> <span class="token punctuation">[</span>colCount<span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token string">"Column A"</span><span class="token punctuation">,</span> <span class="token string">"Column B"</span><span class="token punctuation">,</span> <span class="token string">"Column C"</span><span class="token punctuation">&#125;</span>alignList <span class="token operator">:=</span> <span class="token punctuation">[</span>colCount<span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">&#125;</span>strList <span class="token operator">:=</span> <span class="token function">loremList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetMargins</span><span class="token punctuation">(</span>marginH<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> marginH<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Headers</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token keyword">for</span> colJ <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> colJ <span class="token operator">&lt;</span> colCount<span class="token punctuation">;</span> colJ<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>colWd<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> header<span class="token punctuation">[</span>colJ<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"CM"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token comment">// Rows</span>y <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetY</span><span class="token punctuation">(</span><span class="token punctuation">)</span>count <span class="token operator">:=</span> <span class="token number">0</span><span class="token keyword">for</span> rowJ <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> rowJ <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span> rowJ<span class="token operator">++</span> <span class="token punctuation">&#123;</span>maxHt <span class="token operator">:=</span> lineHt<span class="token comment">// Cell height calculation loop</span><span class="token keyword">for</span> colJ <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> colJ <span class="token operator">&lt;</span> colCount<span class="token punctuation">;</span> colJ<span class="token operator">++</span> <span class="token punctuation">&#123;</span>count<span class="token operator">++</span><span class="token keyword">if</span> count <span class="token operator">></span> <span class="token function">len</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">&#125;</span>cell<span class="token punctuation">.</span>str <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span>strList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>count<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span>cell<span class="token punctuation">.</span>list <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">SplitLines</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">,</span> colWd<span class="token operator">-</span>cellGap<span class="token operator">-</span>cellGap<span class="token punctuation">)</span>cell<span class="token punctuation">.</span>ht <span class="token operator">=</span> <span class="token function">float64</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> lineHt<span class="token keyword">if</span> cell<span class="token punctuation">.</span>ht <span class="token operator">></span> maxHt <span class="token punctuation">&#123;</span>maxHt <span class="token operator">=</span> cell<span class="token punctuation">.</span>ht<span class="token punctuation">&#125;</span>cellList<span class="token punctuation">[</span>colJ<span class="token punctuation">]</span> <span class="token operator">=</span> cell<span class="token punctuation">&#125;</span><span class="token comment">// Cell render loop</span>x <span class="token operator">:=</span> marginH<span class="token keyword">for</span> colJ <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> colJ <span class="token operator">&lt;</span> colCount<span class="token punctuation">;</span> colJ<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> colWd<span class="token punctuation">,</span> maxHt<span class="token operator">+</span>cellGap<span class="token operator">+</span>cellGap<span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>cell <span class="token operator">=</span> cellList<span class="token punctuation">[</span>colJ<span class="token punctuation">]</span>cellY <span class="token operator">:=</span> y <span class="token operator">+</span> cellGap <span class="token operator">+</span> <span class="token punctuation">(</span>maxHt<span class="token operator">-</span>cell<span class="token punctuation">.</span>ht<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token keyword">for</span> splitJ <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> splitJ <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span> splitJ<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span>x<span class="token operator">+</span>cellGap<span class="token punctuation">,</span> cellY<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>colWd<span class="token operator">-</span>cellGap<span class="token operator">-</span>cellGap<span class="token punctuation">,</span> lineHt<span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>list<span class="token punctuation">[</span>splitJ<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>alignList<span class="token punctuation">[</span>colJ<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>cellY <span class="token operator">+=</span> lineHt<span class="token punctuation">&#125;</span>x <span class="token operator">+=</span> colWd<span class="token punctuation">&#125;</span>y <span class="token operator">+=</span> maxHt <span class="token operator">+</span> cellGap <span class="token operator">+</span> cellGap<span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SplitLines_tables"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SplitLines_tables.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示各种表格样式"><a href="#演示各种表格样式" class="headerlink" title="演示各种表格样式"></a>演示各种表格样式</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_CellFormat_tables demonstrates various table styles.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_CellFormat_tables</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">type</span> countryType <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>nameStr<span class="token punctuation">,</span> capitalStr<span class="token punctuation">,</span> areaStr<span class="token punctuation">,</span> popStr <span class="token builtin">string</span><span class="token punctuation">&#125;</span>countryList <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>countryType<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>header <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token string">"Country"</span><span class="token punctuation">,</span> <span class="token string">"Capital"</span><span class="token punctuation">,</span> <span class="token string">"Area (sq km)"</span><span class="token punctuation">,</span> <span class="token string">"Pop. (thousands)"</span><span class="token punctuation">&#125;</span>loadData <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>fileStr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>fl<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>scanner <span class="token operator">:=</span> bufio<span class="token punctuation">.</span><span class="token function">NewScanner</span><span class="token punctuation">(</span>fl<span class="token punctuation">)</span><span class="token keyword">var</span> c countryType<span class="token keyword">for</span> scanner<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Austria;Vienna;83859;8075</span>lineStr <span class="token operator">:=</span> scanner<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span>list <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>lineStr<span class="token punctuation">,</span> <span class="token string">";"</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span> <span class="token punctuation">&#123;</span>c<span class="token punctuation">.</span>nameStr <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>c<span class="token punctuation">.</span>capitalStr <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>c<span class="token punctuation">.</span>areaStr <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>c<span class="token punctuation">.</span>popStr <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>countryList <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>countryList<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>err <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"error tokenizing %s"</span><span class="token punctuation">,</span> lineStr<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>fl<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>countryList<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span>err <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"error loading data from %s"</span><span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// Simple table</span>basicTable <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>left <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token number">210.0</span> <span class="token operator">-</span> <span class="token number">4</span><span class="token operator">*</span><span class="token number">40</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> str <span class="token operator">:=</span> <span class="token keyword">range</span> header <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> c <span class="token operator">:=</span> <span class="token keyword">range</span> countryList <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>nameStr<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>capitalStr<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>areaStr<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>popStr<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// Better table</span>improvedTable <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Column widths</span>w <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">&#123;</span><span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token number">35.0</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token number">45.0</span><span class="token punctuation">&#125;</span>wSum <span class="token operator">:=</span> <span class="token number">0.0</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> w <span class="token punctuation">&#123;</span>wSum <span class="token operator">+=</span> v<span class="token punctuation">&#125;</span>left <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token number">210</span> <span class="token operator">-</span> wSum<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token comment">// Header</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token keyword">for</span> j<span class="token punctuation">,</span> str <span class="token operator">:=</span> <span class="token keyword">range</span> header <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">// Data</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> c <span class="token operator">:=</span> <span class="token keyword">range</span> countryList <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>nameStr<span class="token punctuation">,</span> <span class="token string">"LR"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>capitalStr<span class="token punctuation">,</span> <span class="token string">"LR"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token function">strDelimit</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>areaStr<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"LR"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token function">strDelimit</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>popStr<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"LR"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>wSum<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"T"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">// Colored table</span>fancyTable <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Colors, line width and bold font</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">.3</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">// Header</span>w <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">&#123;</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">&#125;</span>wSum <span class="token operator">:=</span> <span class="token number">0.0</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> w <span class="token punctuation">&#123;</span>wSum <span class="token operator">+=</span> v<span class="token punctuation">&#125;</span>left <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token number">210</span> <span class="token operator">-</span> wSum<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token keyword">for</span> j<span class="token punctuation">,</span> str <span class="token operator">:=</span> <span class="token keyword">range</span> header <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">// Color and font restoration</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">235</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">// Data</span>fill <span class="token operator">:=</span> <span class="token boolean">false</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> c <span class="token operator">:=</span> <span class="token keyword">range</span> countryList <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>nameStr<span class="token punctuation">,</span> <span class="token string">"LR"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fill<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>capitalStr<span class="token punctuation">,</span> <span class="token string">"LR"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fill<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token function">strDelimit</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>areaStr<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"LR"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">,</span> fill<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token function">strDelimit</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>popStr<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"LR"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">,</span> fill<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>fill <span class="token operator">=</span> <span class="token operator">!</span>fill<span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>wSum<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"T"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token function">loadData</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">TextFile</span><span class="token punctuation">(</span><span class="token string">"countries.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">basicTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">improvedTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">fancyTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_CellFormat_tables"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_CellFormat_tables.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示带有和不带基本-HTML-的内部和外部链接"><a href="#演示带有和不带基本-HTML-的内部和外部链接" class="headerlink" title="演示带有和不带基本 HTML 的内部和外部链接"></a>演示带有和不带基本 HTML 的内部和外部链接</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_HTMLBasicNew demonstrates internal and external links with and without basic</span><span class="token comment">// HTML.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_HTMLBasicNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token comment">// First page: manual local link</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token boolean">_</span><span class="token punctuation">,</span> lineHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"To find out what's new in this tutorial, click "</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>link <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">AddLink</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">WriteLinkID</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"here"</span><span class="token punctuation">,</span> link<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">// Second page: image link and basic HTML with link</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLink</span><span class="token punctuation">(</span>link<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"http://www.fpdf.org"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLeftMargin</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFontSize</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token boolean">_</span><span class="token punctuation">,</span> lineHt <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">GetFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>htmlStr <span class="token operator">:=</span> <span class="token string">`You can now easily print text mixing different styles: &lt;b>bold&lt;/b>, `</span> <span class="token operator">+</span><span class="token string">`&lt;i>italic&lt;/i>, &lt;u>underlined&lt;/u>, or &lt;b>&lt;i>&lt;u>all at once&lt;/u>&lt;/i>&lt;/b>!&lt;br>&lt;br>`</span> <span class="token operator">+</span><span class="token string">`&lt;center>You can also center text.&lt;/center>`</span> <span class="token operator">+</span><span class="token string">`&lt;right>Or align it to the right.&lt;/right>`</span> <span class="token operator">+</span><span class="token string">`You can also insert links on text, such as `</span> <span class="token operator">+</span><span class="token string">`&lt;a href="http://www.fpdf.org">www.fpdf.org&lt;/a>, or on an image: click on the logo.`</span>html <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">HTMLBasicNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>html<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> htmlStr<span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_HTMLBasicNew"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_HTMLBasicNew.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示非标准字体的使用"><a href="#演示非标准字体的使用" class="headerlink" title="演示非标准字体的使用"></a>演示非标准字体的使用</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_AddFont demonstrates the use of a non-standard font.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_AddFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">FontDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddFont</span><span class="token punctuation">(</span><span class="token string">"Calligrapher"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"calligra.json"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Calligrapher"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Enjoy new fonts with FPDF!"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_AddFont"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_AddFont.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何使用Write函数对齐文本"><a href="#演示如何使用Write函数对齐文本" class="headerlink" title="演示如何使用Write函数对齐文本"></a>演示如何使用Write函数对齐文本</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_WriteAligned demonstrates how to align text with the Write function.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_WriteAligned</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">FontDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLeftMargin</span><span class="token punctuation">(</span><span class="token number">50.0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetRightMargin</span><span class="token punctuation">(</span><span class="token number">50.0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">WriteAligned</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token string">"This text is the default alignment, Left"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">WriteAligned</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token string">"This text is aligned Left"</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">WriteAligned</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token string">"This text is aligned Center"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">WriteAligned</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token string">"This text is aligned Right"</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span>line <span class="token operator">:=</span> <span class="token string">"This can by used to write justified text"</span>leftMargin<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> rightMargin<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetMargins</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pageWidth<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pageWidth <span class="token operator">-=</span> leftMargin <span class="token operator">+</span> rightMarginpdf<span class="token punctuation">.</span><span class="token function">SetWordSpacing</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pageWidth <span class="token operator">-</span> pdf<span class="token punctuation">.</span><span class="token function">GetStringWidth</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">float64</span><span class="token punctuation">(</span>strings<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span>line<span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">WriteAligned</span><span class="token punctuation">(</span>pageWidth<span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> line<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_WriteAligned"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_WriteAligned.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何将图像包含在文档中"><a href="#演示如何将图像包含在文档中" class="headerlink" title="演示如何将图像包含在文档中"></a>演示如何将图像包含在文档中</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_Image demonstrates how images are included in documents.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"logo.png"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.gif"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">"logo.gif"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo-gray.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token string">"logo-gray.png"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo-rgb.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token string">"logo-rgb.png"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token string">"logo.jpg"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_Image"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_Image.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示了如何使用ImageOption结构体的AllowNegativePosition字段来影响图像的水平位置"><a href="#演示了如何使用ImageOption结构体的AllowNegativePosition字段来影响图像的水平位置" class="headerlink" title="演示了如何使用ImageOption结构体的AllowNegativePosition字段来影响图像的水平位置"></a>演示了如何使用ImageOption结构体的AllowNegativePosition字段来影响图像的水平位置</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_ImageOptions demonstrates how the AllowNegativePosition field of the</span><span class="token comment">// ImageOption struct can be used to affect horizontal image placement.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_ImageOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> opt gofpdf<span class="token punctuation">.</span>ImageOptionspdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>opt<span class="token punctuation">.</span>ImageType <span class="token operator">=</span> <span class="token string">"png"</span>pdf<span class="token punctuation">.</span><span class="token function">ImageOptions</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> opt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>opt<span class="token punctuation">.</span>AllowNegativePosition <span class="token operator">=</span> <span class="token boolean">true</span>pdf<span class="token punctuation">.</span><span class="token function">ImageOptions</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> opt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_ImageOptions"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_ImageOptions.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何从io加载图像"><a href="#演示如何从io加载图像" class="headerlink" title="演示如何从io加载图像"></a>演示如何从io加载图像</h2><p>Reader(在本例中是一个文件)并将其注册为options</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_RegisterImageOptionsReader demonstrates how to load an image</span><span class="token comment">// from a io.Reader (in this case, a file) and register it with options.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_RegisterImageOptionsReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> <span class="token punctuation">(</span>opt    gofpdf<span class="token punctuation">.</span>ImageOptionspdfStr <span class="token builtin">string</span>fl     <span class="token operator">*</span>os<span class="token punctuation">.</span>Fileerr    <span class="token builtin">error</span><span class="token punctuation">)</span>pdfStr <span class="token operator">=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_RegisterImageOptionsReader"</span><span class="token punctuation">)</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span>fl<span class="token punctuation">,</span> err <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>opt<span class="token punctuation">.</span>ImageType <span class="token operator">=</span> <span class="token string">"png"</span>opt<span class="token punctuation">.</span>AllowNegativePosition <span class="token operator">=</span> <span class="token boolean">true</span><span class="token boolean">_</span> <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">RegisterImageOptionsReader</span><span class="token punctuation">(</span><span class="token string">"logo"</span><span class="token punctuation">,</span> opt<span class="token punctuation">,</span> fl<span class="token punctuation">)</span>fl<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> x <span class="token operator">:=</span> <span class="token operator">-</span><span class="token number">20.0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;=</span> <span class="token number">40.0</span><span class="token punctuation">;</span> x <span class="token operator">+=</span> <span class="token number">5</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">ImageOptions</span><span class="token punctuation">(</span><span class="token string">"logo"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> x<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> opt<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>err <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>pdfStr<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> pdfStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_RegisterImageOptionsReader.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示了带有图像的横向模式"><a href="#演示了带有图像的横向模式" class="headerlink" title="演示了带有图像的横向模式"></a>演示了带有图像的横向模式</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// This example demonstrates Landscape mode with images.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetAcceptPageBreakFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> y0 <span class="token builtin">float64</span><span class="token keyword">var</span> crrntCol <span class="token builtin">int</span>loremStr <span class="token operator">:=</span> <span class="token function">lorem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">(</span>pageWd <span class="token operator">=</span> <span class="token number">297.0</span> <span class="token comment">// A4 210.0 x 297.0</span>margin <span class="token operator">=</span> <span class="token number">10.0</span>gutter <span class="token operator">=</span> <span class="token number">4</span>colNum <span class="token operator">=</span> <span class="token number">3</span>colWd  <span class="token operator">=</span> <span class="token punctuation">(</span>pageWd <span class="token operator">-</span> <span class="token number">2</span><span class="token operator">*</span>margin <span class="token operator">-</span> <span class="token punctuation">(</span>colNum<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>gutter<span class="token punctuation">)</span> <span class="token operator">/</span> colNum<span class="token punctuation">)</span>setCol <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>col <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>crrntCol <span class="token operator">=</span> colx <span class="token operator">:=</span> margin <span class="token operator">+</span> <span class="token function">float64</span><span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>colWd<span class="token operator">+</span>gutter<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLeftMargin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">SetHeaderFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>titleStr <span class="token operator">:=</span> <span class="token string">"gofpdf"</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">)</span>wd <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetStringWidth</span><span class="token punctuation">(</span>titleStr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pageWd <span class="token operator">-</span> wd<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> titleStr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> titleStr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>y0 <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">GetY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAcceptPageBreakFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> crrntCol <span class="token operator">&lt;</span> colNum<span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">&#123;</span><span class="token function">setCol</span><span class="token punctuation">(</span>crrntCol <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetY</span><span class="token punctuation">(</span>y0<span class="token punctuation">)</span><span class="token comment">// Start new column, not new page</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">&#125;</span><span class="token function">setCol</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"fpdf.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> colWd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"golang-gopher.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> colWd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span>colWd<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> loremStr<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetAcceptPageBreakFunc_landscape"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SetAcceptPageBreakFunc_landscape.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示各种几何图形的构造"><a href="#演示各种几何图形的构造" class="headerlink" title="演示各种几何图形的构造"></a>演示各种几何图形的构造</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_Circle demonstrates the construction of various geometric figures,</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>thin  <span class="token operator">=</span> <span class="token number">0.2</span>thick <span class="token operator">=</span> <span class="token number">3.0</span><span class="token punctuation">)</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>y <span class="token operator">:=</span> <span class="token number">15.0</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">"Circles"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thin<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Circle</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Circle</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Circle</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thick<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Circle</span><span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thin<span class="token punctuation">)</span>y <span class="token operator">+=</span> <span class="token number">40.0</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">"Ellipses"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ellipse</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ellipse</span><span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ellipse</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thick<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ellipse</span><span class="token punctuation">(</span><span class="token number">165</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thin<span class="token punctuation">)</span>y <span class="token operator">+=</span> <span class="token number">40.0</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">"Curves (quadratic)"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Curve</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Curve</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Curve</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thick<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Curve</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineCapStyle</span><span class="token punctuation">(</span><span class="token string">"round"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Curve</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">155</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thin<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineCapStyle</span><span class="token punctuation">(</span><span class="token string">"butt"</span><span class="token punctuation">)</span>y <span class="token operator">+=</span> <span class="token number">40.0</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">"Curves (cubic)"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CurveBezierCubic</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CurveBezierCubic</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CurveBezierCubic</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thick<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CurveBezierCubic</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">115</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineCapStyle</span><span class="token punctuation">(</span><span class="token string">"round"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CurveBezierCubic</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">155</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thin<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineCapStyle</span><span class="token punctuation">(</span><span class="token string">"butt"</span><span class="token punctuation">)</span>y <span class="token operator">+=</span> <span class="token number">40.0</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token string">"Arcs"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thick<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Arc</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thin<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Arc</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thick<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Arc</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineCapStyle</span><span class="token punctuation">(</span><span class="token string">"round"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Arc</span><span class="token punctuation">(</span><span class="token number">135</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thin<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Arc</span><span class="token punctuation">(</span><span class="token number">135</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thick<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Arc</span><span class="token punctuation">(</span><span class="token number">135</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>thin<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineCapStyle</span><span class="token punctuation">(</span><span class="token string">"butt"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_Circle_figures"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_Circle_figures.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示alpha透明度"><a href="#演示alpha透明度" class="headerlink" title="演示alpha透明度"></a>演示alpha透明度</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetAlpha</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>gapX  <span class="token operator">=</span> <span class="token number">10.0</span>gapY  <span class="token operator">=</span> <span class="token number">9.0</span>rectW <span class="token operator">=</span> <span class="token number">40.0</span>rectH <span class="token operator">=</span> <span class="token number">58.0</span>pageW <span class="token operator">=</span> <span class="token number">210</span>pageH <span class="token operator">=</span> <span class="token number">297</span><span class="token punctuation">)</span>modeList <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token string">"Normal"</span><span class="token punctuation">,</span> <span class="token string">"Multiply"</span><span class="token punctuation">,</span> <span class="token string">"Screen"</span><span class="token punctuation">,</span> <span class="token string">"Overlay"</span><span class="token punctuation">,</span><span class="token string">"Darken"</span><span class="token punctuation">,</span> <span class="token string">"Lighten"</span><span class="token punctuation">,</span> <span class="token string">"ColorDodge"</span><span class="token punctuation">,</span> <span class="token string">"ColorBurn"</span><span class="token punctuation">,</span> <span class="token string">"HardLight"</span><span class="token punctuation">,</span> <span class="token string">"SoftLight"</span><span class="token punctuation">,</span><span class="token string">"Difference"</span><span class="token punctuation">,</span> <span class="token string">"Exclusion"</span><span class="token punctuation">,</span> <span class="token string">"Hue"</span><span class="token punctuation">,</span> <span class="token string">"Saturation"</span><span class="token punctuation">,</span> <span class="token string">"Color"</span><span class="token punctuation">,</span> <span class="token string">"Luminosity"</span><span class="token punctuation">&#125;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAutoPageBreak</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> gapY<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>pageW<span class="token punctuation">,</span> gapY<span class="token punctuation">,</span> <span class="token string">"Alpha Blending Modes"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>j <span class="token operator">:=</span> <span class="token number">0</span>y <span class="token operator">:=</span> <span class="token number">3</span> <span class="token operator">*</span> gapY<span class="token keyword">for</span> col <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> col<span class="token operator">++</span> <span class="token punctuation">&#123;</span>x <span class="token operator">:=</span> gapX<span class="token keyword">for</span> row <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> row<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> rectW<span class="token punctuation">,</span> rectH<span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">+</span>rectH<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>rectW<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> modeList<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span>rectW<span class="token punctuation">,</span> rectH<span class="token punctuation">,</span> <span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAlpha</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> modeList<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"golang-gopher.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>x<span class="token operator">-</span>gapX<span class="token punctuation">,</span> y<span class="token punctuation">,</span> rectW<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>gapX<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAlpha</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token string">"Normal"</span><span class="token punctuation">)</span>x <span class="token operator">+=</span> rectW <span class="token operator">+</span> gapXj<span class="token operator">++</span><span class="token punctuation">&#125;</span>y <span class="token operator">+=</span> rectH <span class="token operator">+</span> gapY<span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetAlpha_transparency"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SetAlpha_transparency.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示各种梯度"><a href="#演示各种梯度" class="headerlink" title="演示各种梯度"></a>演示各种梯度</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_LinearGradient deomstrates various gradients.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_LinearGradient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">225</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LinearGradient</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">.2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">.8</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LinearGradient</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RadialGradient</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RadialGradient</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_LinearGradient_gradient"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_LinearGradient_gradient.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示了剪裁"><a href="#演示了剪裁" class="headerlink" title="演示了剪裁"></a>演示了剪裁</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_ClipText demonstrates clipping.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_ClipText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>y <span class="token operator">:=</span> <span class="token number">10.0</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipText</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">"Clipping examples"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RadialGradient</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>y <span class="token operator">+=</span> <span class="token number">12</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipText</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">40</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RadialGradient</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>y <span class="token operator">+=</span> <span class="token number">55</span>pdf<span class="token punctuation">.</span><span class="token function">ClipRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipCircle</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RadialGradient</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span><span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEllipse</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RadialGradient</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span><span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>y <span class="token operator">+=</span> <span class="token number">28</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEllipse</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"JPG"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipCircle</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RadialGradient</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipPolygon</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> y <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">90</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> y<span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> y <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LinearGradient</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>y <span class="token operator">+=</span> <span class="token number">30</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipRoundedRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RadialGradient</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">lorem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>y <span class="token operator">+=</span> <span class="token number">30</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipRoundedRectExt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RadialGradient</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">lorem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_ClipText"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_ClipText.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="生成具有不同页面大小的PDF文档"><a href="#生成具有不同页面大小的PDF文档" class="headerlink" title="生成具有不同页面大小的PDF文档"></a>生成具有不同页面大小的PDF文档</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_PageSize generates a PDF document with various page sizes.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_PageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">NewCustom</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>gofpdf<span class="token punctuation">.</span>InitType<span class="token punctuation">&#123;</span>UnitStr<span class="token punctuation">:</span>    <span class="token string">"in"</span><span class="token punctuation">,</span>Size<span class="token punctuation">:</span>       gofpdf<span class="token punctuation">.</span>SizeType<span class="token punctuation">&#123;</span>Wd<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span> Ht<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>FontDirStr<span class="token punctuation">:</span> example<span class="token punctuation">.</span><span class="token function">FontDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetMargins</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPageFormat</span><span class="token punctuation">(</span><span class="token string">"L"</span><span class="token punctuation">,</span> gofpdf<span class="token punctuation">.</span>SizeType<span class="token punctuation">&#123;</span>Wd<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> Ht<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token string">"12 in x 3 in"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Default size established in NewCustom()</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token string">"6 in x 6 in"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPageFormat</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> gofpdf<span class="token punctuation">.</span>SizeType<span class="token punctuation">&#123;</span>Wd<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> Ht<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token string">"3 in x 12 in"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">&#123;</span>wd<span class="token punctuation">,</span> ht<span class="token punctuation">,</span> u <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">PageSize</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%d: %6.2f %s, %6.2f %s\n"</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> wd<span class="token punctuation">,</span> u<span class="token punctuation">,</span> ht<span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_PageSize"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// 0:   6.00 in,   6.00 in</span><span class="token comment">// 1:  12.00 in,   3.00 in</span><span class="token comment">// 2:   6.00 in,   6.00 in</span><span class="token comment">// 3:   3.00 in,  12.00 in</span><span class="token comment">// Successfully generated pdf/Fpdf_PageSize.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示Bookmark方法"><a href="#演示Bookmark方法" class="headerlink" title="演示Bookmark方法"></a>演示Bookmark方法</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_Bookmark demonstrates the Bookmark method.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_Bookmark</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Bookmark</span><span class="token punctuation">(</span><span class="token string">"Page 1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Bookmark</span><span class="token punctuation">(</span><span class="token string">"Paragraph 1"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"Paragraph 1"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Bookmark</span><span class="token punctuation">(</span><span class="token string">"Paragraph 2"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"Paragraph 2"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Bookmark</span><span class="token punctuation">(</span><span class="token string">"Page 2"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Bookmark</span><span class="token punctuation">(</span><span class="token string">"Paragraph 3"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"Paragraph 3"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_Bookmark"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_Bookmark.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示各种转换"><a href="#演示各种转换" class="headerlink" title="演示各种转换"></a>演示各种转换</h2><p>它改编自Moritz Wagner和Andreas Würmser的示例脚本</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_TransformBegin demonstrates various transformations. It is adapted from an</span><span class="token comment">// example script by Moritz Wagner and Andreas Würmser.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>light <span class="token operator">=</span> <span class="token number">200</span>dark  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">var</span> refX<span class="token punctuation">,</span> refY <span class="token builtin">float64</span><span class="token keyword">var</span> refStr <span class="token builtin">string</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>color <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>val <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> val<span class="token punctuation">,</span> val<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> val<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>reference <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>str <span class="token builtin">string</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token builtin">float64</span><span class="token punctuation">,</span> val <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">color</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>refDraw <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>str <span class="token builtin">string</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>refStr <span class="token operator">=</span> strrefX <span class="token operator">=</span> xrefY <span class="token operator">=</span> y<span class="token function">reference</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> light<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>refDupe <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">reference</span><span class="token punctuation">(</span>refStr<span class="token punctuation">,</span> refX<span class="token punctuation">,</span> refY<span class="token punctuation">,</span> dark<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>titleStr <span class="token operator">:=</span> <span class="token string">"Transformations"</span>titlePt <span class="token operator">:=</span> <span class="token number">36.0</span>titleHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">PointConvert</span><span class="token punctuation">(</span>titlePt<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> titlePt<span class="token punctuation">)</span>titleWd <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetStringWidth</span><span class="token punctuation">(</span>titleStr<span class="token punctuation">)</span>titleX <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token number">210</span> <span class="token operator">-</span> titleWd<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span>titleX<span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">+</span>titleHt<span class="token punctuation">,</span> titleStr<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformMirrorVertical</span><span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">+</span> titleHt <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipText</span><span class="token punctuation">(</span>titleX<span class="token punctuation">,</span> <span class="token number">10</span><span class="token operator">+</span>titleHt<span class="token punctuation">,</span> titleStr<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment">// Remember that the transform will mirror the gradient box too</span>pdf<span class="token punctuation">.</span><span class="token function">LinearGradient</span><span class="token punctuation">(</span>titleX<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> titleWd<span class="token punctuation">,</span> titleHt<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token comment">// Scale by 150% centered by lower left corner of the rectangle</span><span class="token function">refDraw</span><span class="token punctuation">(</span><span class="token string">"Scale"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformScaleXY</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token function">refDupe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Translate 7 to the right, 5 to the bottom</span><span class="token function">refDraw</span><span class="token punctuation">(</span><span class="token string">"Translate"</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformTranslate</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token function">refDupe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Rotate 20 degrees counter-clockwise centered by the lower left corner of</span><span class="token comment">// the rectangle</span><span class="token function">refDraw</span><span class="token punctuation">(</span><span class="token string">"Rotate"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformRotate</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token function">refDupe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Skew 30 degrees along the x-axis centered by the lower left corner of the</span><span class="token comment">// rectangle</span><span class="token function">refDraw</span><span class="token punctuation">(</span><span class="token string">"Skew"</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformSkewX</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span><span class="token function">refDupe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Mirror horizontally with axis of reflection at left side of the rectangle</span><span class="token function">refDraw</span><span class="token punctuation">(</span><span class="token string">"Mirror horizontal"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformMirrorHorizontal</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token function">refDupe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Mirror vertically with axis of reflection at bottom side of the rectangle</span><span class="token function">refDraw</span><span class="token punctuation">(</span><span class="token string">"Mirror vertical"</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformMirrorVertical</span><span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">)</span><span class="token function">refDupe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Reflect against a point at the lower left point of rectangle</span><span class="token function">refDraw</span><span class="token punctuation">(</span><span class="token string">"Mirror point"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformMirrorPoint</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">)</span><span class="token function">refDupe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Mirror against a straight line described by a point and an angle</span>angle <span class="token operator">:=</span> <span class="token operator">-</span><span class="token number">20.0</span>px <span class="token operator">:=</span> <span class="token number">120.0</span>py <span class="token operator">:=</span> <span class="token number">220.0</span><span class="token function">refDraw</span><span class="token punctuation">(</span><span class="token string">"Mirror line"</span><span class="token punctuation">,</span> <span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformRotate</span><span class="token punctuation">(</span>angle<span class="token punctuation">,</span> px<span class="token punctuation">,</span> py<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Line</span><span class="token punctuation">(</span>px<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> py<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> px<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> py<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Line</span><span class="token punctuation">(</span>px<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> py<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> px<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> py<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Line</span><span class="token punctuation">(</span>px<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> py<span class="token punctuation">,</span> px<span class="token operator">+</span><span class="token number">60</span><span class="token punctuation">,</span> py<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformMirrorLine</span><span class="token punctuation">(</span>angle<span class="token punctuation">,</span> px<span class="token punctuation">,</span> py<span class="token punctuation">)</span><span class="token function">refDupe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_TransformBegin"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_TransformBegin.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示Lawrence-Kesteloot的图像注册代码"><a href="#演示Lawrence-Kesteloot的图像注册代码" class="headerlink" title="演示Lawrence Kesteloot的图像注册代码"></a>演示Lawrence Kesteloot的图像注册代码</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_RegisterImage demonstrates Lawrence Kesteloot's image registration code.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_RegisterImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>margin <span class="token operator">=</span> <span class="token number">10</span>wd     <span class="token operator">=</span> <span class="token number">210</span>ht     <span class="token operator">=</span> <span class="token number">297</span><span class="token punctuation">)</span>fileList <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token string">"logo-gray.png"</span><span class="token punctuation">,</span><span class="token string">"logo.jpg"</span><span class="token punctuation">,</span><span class="token string">"logo.png"</span><span class="token punctuation">,</span><span class="token string">"logo-rgb.png"</span><span class="token punctuation">,</span><span class="token string">"logo-progressive.jpg"</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token keyword">var</span> infoPtr <span class="token operator">*</span>gofpdf<span class="token punctuation">.</span>ImageInfoType<span class="token keyword">var</span> imageFileStr <span class="token builtin">string</span><span class="token keyword">var</span> imgWd<span class="token punctuation">,</span> imgHt<span class="token punctuation">,</span> lf<span class="token punctuation">,</span> tp <span class="token builtin">float64</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetMargins</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token keyword">for</span> j<span class="token punctuation">,</span> str <span class="token operator">:=</span> <span class="token keyword">range</span> fileList <span class="token punctuation">&#123;</span>imageFileStr <span class="token operator">=</span> example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>infoPtr <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">RegisterImage</span><span class="token punctuation">(</span>imageFileStr<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>imgWd<span class="token punctuation">,</span> imgHt <span class="token operator">=</span> infoPtr<span class="token punctuation">.</span><span class="token function">Extent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">switch</span> j <span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>lf <span class="token operator">=</span> margintp <span class="token operator">=</span> margin<span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>lf <span class="token operator">=</span> wd <span class="token operator">-</span> margin <span class="token operator">-</span> imgWdtp <span class="token operator">=</span> margin<span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>lf <span class="token operator">=</span> <span class="token punctuation">(</span>wd <span class="token operator">-</span> imgWd<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span>tp <span class="token operator">=</span> <span class="token punctuation">(</span>ht <span class="token operator">-</span> imgHt<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span><span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>lf <span class="token operator">=</span> margintp <span class="token operator">=</span> ht <span class="token operator">-</span> imgHt <span class="token operator">-</span> margin<span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span>lf <span class="token operator">=</span> wd <span class="token operator">-</span> imgWd <span class="token operator">-</span> margintp <span class="token operator">=</span> ht <span class="token operator">-</span> imgHt <span class="token operator">-</span> margin<span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>imageFileStr<span class="token punctuation">,</span> lf<span class="token punctuation">,</span> tp<span class="token punctuation">,</span> imgWd<span class="token punctuation">,</span> imgHt<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_RegisterImage"</span><span class="token punctuation">)</span><span class="token comment">// Test the image information retrieval method</span>infoShow <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>imageStr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>imageStr <span class="token operator">=</span> example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span>imageStr<span class="token punctuation">)</span>info <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetImageInfo</span><span class="token punctuation">(</span>imageStr<span class="token punctuation">)</span><span class="token keyword">if</span> info <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> info<span class="token punctuation">.</span><span class="token function">Width</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0.0</span> <span class="token punctuation">&#123;</span>fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Image %s is registered\n"</span><span class="token punctuation">,</span> filepath<span class="token punctuation">.</span><span class="token function">ToSlash</span><span class="token punctuation">(</span>imageStr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Incorrect information for image %s\n"</span><span class="token punctuation">,</span> filepath<span class="token punctuation">.</span><span class="token function">ToSlash</span><span class="token punctuation">(</span>imageStr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Image %s is not registered\n"</span><span class="token punctuation">,</span> filepath<span class="token punctuation">.</span><span class="token function">ToSlash</span><span class="token punctuation">(</span>imageStr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">infoShow</span><span class="token punctuation">(</span>fileList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token function">infoShow</span><span class="token punctuation">(</span><span class="token string">"foo.png"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Image image/logo-gray.png is registered</span><span class="token comment">// Image image/foo.png is not registered</span><span class="token comment">// Successfully generated pdf/Fpdf_RegisterImage.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示布鲁诺米歇尔的分线功能"><a href="#演示布鲁诺米歇尔的分线功能" class="headerlink" title="演示布鲁诺米歇尔的分线功能"></a>演示布鲁诺米歇尔的分线功能</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SplitLines demonstrates Bruno Michel's line splitting function.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SplitLines</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>fontPtSize <span class="token operator">=</span> <span class="token number">18.0</span>wd         <span class="token operator">=</span> <span class="token number">100.0</span><span class="token punctuation">)</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// A4 210.0 x 297.0</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontPtSize<span class="token punctuation">)</span><span class="token boolean">_</span><span class="token punctuation">,</span> lineHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetMargins</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>lines <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">SplitLines</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token function">lorem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> wd<span class="token punctuation">)</span>ht <span class="token operator">:=</span> <span class="token function">float64</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> lineHty <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token number">297.0</span> <span class="token operator">-</span> ht<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">)</span>x <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token number">210.0</span> <span class="token operator">-</span> <span class="token punctuation">(</span>wd <span class="token operator">+</span> <span class="token number">40.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">-</span><span class="token number">20.0</span><span class="token punctuation">,</span> wd<span class="token operator">+</span><span class="token number">40.0</span><span class="token punctuation">,</span> ht<span class="token operator">+</span><span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetY</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> line <span class="token operator">:=</span> <span class="token keyword">range</span> lines <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">190.0</span><span class="token punctuation">,</span> lineHt<span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_Splitlines"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何呈现由jSignature-web控件生成的类型的简单纯路径SVG图像"><a href="#演示如何呈现由jSignature-web控件生成的类型的简单纯路径SVG图像" class="headerlink" title="演示如何呈现由jSignature web控件生成的类型的简单纯路径SVG图像"></a>演示如何呈现由jSignature web控件生成的类型的简单纯路径SVG图像</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SVGBasicWrite demonstrates how to render a simple path-only SVG image of the</span><span class="token comment">// type generated by the jSignature web control.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SVGBasicWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>fontPtSize <span class="token operator">=</span> <span class="token number">16.0</span>wd         <span class="token operator">=</span> <span class="token number">100.0</span>sigFileStr <span class="token operator">=</span> <span class="token string">"signature.svg"</span><span class="token punctuation">)</span><span class="token keyword">var</span> <span class="token punctuation">(</span>sig gofpdf<span class="token punctuation">.</span>SVGBasicTypeerr <span class="token builtin">error</span><span class="token punctuation">)</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// A4 210.0 x 297.0</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontPtSize<span class="token punctuation">)</span>lineHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">PointConvert</span><span class="token punctuation">(</span>fontPtSize<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetMargins</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>htmlStr <span class="token operator">:=</span> <span class="token string">`This example renders a simple `</span> <span class="token operator">+</span><span class="token string">`&lt;a href="http://www.w3.org/TR/SVG/">SVG&lt;/a> (scalable vector graphics) `</span> <span class="token operator">+</span><span class="token string">`image that contains only basic path commands without any styling, `</span> <span class="token operator">+</span><span class="token string">`color fill, reflection or endpoint closures. In particular, the `</span> <span class="token operator">+</span><span class="token string">`type of vector graphic returned from a `</span> <span class="token operator">+</span><span class="token string">`&lt;a href="http://willowsystems.github.io/jSignature/#/demo/">jSignature&lt;/a> `</span> <span class="token operator">+</span><span class="token string">`web control is supported and is used in this example.`</span>html <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">HTMLBasicNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>html<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> htmlStr<span class="token punctuation">)</span>sig<span class="token punctuation">,</span> err <span class="token operator">=</span> gofpdf<span class="token punctuation">.</span><span class="token function">SVGBasicFileParse</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span>sigFileStr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>scale <span class="token operator">:=</span> <span class="token number">100</span> <span class="token operator">/</span> sig<span class="token punctuation">.</span>WdscaleY <span class="token operator">:=</span> <span class="token number">30</span> <span class="token operator">/</span> sig<span class="token punctuation">.</span>Ht<span class="token keyword">if</span> scale <span class="token operator">></span> scaleY <span class="token punctuation">&#123;</span>scale <span class="token operator">=</span> scaleY<span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineCapStyle</span><span class="token punctuation">(</span><span class="token string">"round"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">210.0</span><span class="token operator">-</span>scale<span class="token operator">*</span>sig<span class="token punctuation">.</span>Wd<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2.0</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">GetY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SVGBasicWrite</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sig<span class="token punctuation">,</span> scale<span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SVGBasicWrite"</span><span class="token punctuation">)</span>err <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SVGBasicWrite.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示了Stefan-Schroeder的代码来控制垂直对齐"><a href="#演示了Stefan-Schroeder的代码来控制垂直对齐" class="headerlink" title="演示了Stefan Schroeder的代码来控制垂直对齐"></a>演示了Stefan Schroeder的代码来控制垂直对齐</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_CellFormat_align demonstrates Stefan Schroeder's code to control vertical</span><span class="token comment">// alignment.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_CellFormat_align</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">type</span> recType <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>align<span class="token punctuation">,</span> txt <span class="token builtin">string</span><span class="token punctuation">&#125;</span>recList <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>recType<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">"TL"</span><span class="token punctuation">,</span> <span class="token string">"top left"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"TC"</span><span class="token punctuation">,</span> <span class="token string">"top center"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"TR"</span><span class="token punctuation">,</span> <span class="token string">"top right"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"LM"</span><span class="token punctuation">,</span> <span class="token string">"middle left"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"CM"</span><span class="token punctuation">,</span> <span class="token string">"middle center"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"RM"</span><span class="token punctuation">,</span> <span class="token string">"middle right"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"BL"</span><span class="token punctuation">,</span> <span class="token string">"bottom left"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"BC"</span><span class="token punctuation">,</span> <span class="token string">"bottom center"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"BR"</span><span class="token punctuation">,</span> <span class="token string">"bottom right"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>recListBaseline <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>recType<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">"AL"</span><span class="token punctuation">,</span> <span class="token string">"baseline left"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"AC"</span><span class="token punctuation">,</span> <span class="token string">"baseline center"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"AR"</span><span class="token punctuation">,</span> <span class="token string">"baseline right"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token keyword">var</span> formatRect <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>pdf <span class="token operator">*</span>gofpdf<span class="token punctuation">.</span>Fpdf<span class="token punctuation">,</span> recList <span class="token punctuation">[</span><span class="token punctuation">]</span>recType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>linkStr <span class="token operator">:=</span> <span class="token string">""</span><span class="token keyword">for</span> pageJ <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> pageJ <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span> pageJ<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetMargins</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAutoPageBreak</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>borderStr <span class="token operator">:=</span> <span class="token string">"1"</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> rec <span class="token operator">:=</span> <span class="token keyword">range</span> recList <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">257</span><span class="token punctuation">,</span> rec<span class="token punctuation">.</span>txt<span class="token punctuation">,</span> borderStr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> rec<span class="token punctuation">.</span>align<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> linkStr<span class="token punctuation">)</span>borderStr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">&#125;</span>linkStr <span class="token operator">=</span> <span class="token string">"https://github.com/jung-kurt/gofpdf"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// A4 210.0 x 297.0</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token function">formatRect</span><span class="token punctuation">(</span>pdf<span class="token punctuation">,</span> recList<span class="token punctuation">)</span><span class="token function">formatRect</span><span class="token punctuation">(</span>pdf<span class="token punctuation">,</span> recListBaseline<span class="token punctuation">)</span><span class="token keyword">var</span> fr fontResourceTypepdf<span class="token punctuation">.</span><span class="token function">SetFontLoader</span><span class="token punctuation">(</span>fr<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddFont</span><span class="token punctuation">(</span><span class="token string">"Calligrapher"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"calligra.json"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Calligrapher"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token function">formatRect</span><span class="token punctuation">(</span>pdf<span class="token punctuation">,</span> recListBaseline<span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_CellFormat_align"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Generalized font loader reading calligra.json</span><span class="token comment">// Generalized font loader reading calligra.z</span><span class="token comment">// Successfully generated pdf/Fpdf_CellFormat_align.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示将UTF-8字符串自动转换为8位字体编码"><a href="#演示将UTF-8字符串自动转换为8位字体编码" class="headerlink" title="演示将UTF-8字符串自动转换为8位字体编码"></a>演示将UTF-8字符串自动转换为8位字体编码</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_CellFormat_codepage demonstrates the automatic conversion of UTF-8 strings to an</span><span class="token comment">// 8-bit font encoding.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_CellFormat_codepage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">FontDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// A4 210.0 x 297.0</span><span class="token comment">// See documentation for details on how to generate fonts</span>pdf<span class="token punctuation">.</span><span class="token function">AddFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica-1251"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"helvetica_1251.json"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica-1253"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"helvetica_1253.json"</span><span class="token punctuation">)</span>fontSize <span class="token operator">:=</span> <span class="token number">16.0</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontSize<span class="token punctuation">)</span>ht <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">PointConvert</span><span class="token punctuation">(</span>fontSize<span class="token punctuation">)</span>tr <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">UnicodeTranslatorFromDescriptor</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// "" defaults to "cp1252"</span>write <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>str <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// pdf.CellFormat(190, ht, tr(str), "", 1, "C", false, 0, "")</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">190</span><span class="token punctuation">,</span> ht<span class="token punctuation">,</span> <span class="token function">tr</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span>ht<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>str <span class="token operator">:=</span> <span class="token string">`Gofpdf provides a translator that will convert any UTF-8 code point `</span> <span class="token operator">+</span><span class="token string">`that is present in the specified code page.`</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">190</span><span class="token punctuation">,</span> ht<span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> ht<span class="token punctuation">)</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"Voix ambiguë d'un cœur qui au zéphyr préfère les jattes de kiwi."</span><span class="token punctuation">)</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"Falsches Üben von Xylophonmusik quält jeden größeren Zwerg."</span><span class="token punctuation">)</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"Heizölrückstoßabdämpfung"</span><span class="token punctuation">)</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"Forårsjævndøgn / Efterårsjævndøgn"</span><span class="token punctuation">)</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"À noite, vovô Kowalsky vê o ímã cair no pé do pingüim queixoso e vovó"</span> <span class="token operator">+</span><span class="token string">"põe açúcar no chá de tâmaras do jabuti feliz."</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica-1251"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontSize<span class="token punctuation">)</span> <span class="token comment">// Name matches one specified in AddFont()</span>tr <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">UnicodeTranslatorFromDescriptor</span><span class="token punctuation">(</span><span class="token string">"cp1251"</span><span class="token punctuation">)</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"Съешь же ещё этих мягких французских булок, да выпей чаю."</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica-1253"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontSize<span class="token punctuation">)</span>tr <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">UnicodeTranslatorFromDescriptor</span><span class="token punctuation">(</span><span class="token string">"cp1253"</span><span class="token punctuation">)</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"Θέλει αρετή και τόλμη η ελευθερία. (Ανδρέας Κάλβος)"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_CellFormat_codepage"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_CellFormat_codepage.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示文档的密码保护"><a href="#演示文档的密码保护" class="headerlink" title="演示文档的密码保护"></a>演示文档的密码保护</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetProtection demonstrates password protection for documents.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetProtection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetProtection</span><span class="token punctuation">(</span>gofpdf<span class="token punctuation">.</span>CnProtectPrint<span class="token punctuation">,</span> <span class="token string">"123"</span><span class="token punctuation">,</span> <span class="token string">"abc"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Password-protected."</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetProtection"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SetProtection.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="在多边形函数的演示中显示等边多边形"><a href="#在多边形函数的演示中显示等边多边形" class="headerlink" title="在多边形函数的演示中显示等边多边形"></a>在多边形函数的演示中显示等边多边形</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_Polygon displays equilateral polygons in a demonstration of the Polygon</span><span class="token comment">// function.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_Polygon</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> rowCount <span class="token operator">=</span> <span class="token number">5</span><span class="token keyword">const</span> colCount <span class="token operator">=</span> <span class="token number">4</span><span class="token keyword">const</span> ptSize <span class="token operator">=</span> <span class="token number">36</span><span class="token keyword">var</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> radius<span class="token punctuation">,</span> gap<span class="token punctuation">,</span> advance <span class="token builtin">float64</span><span class="token keyword">var</span> rgVal <span class="token builtin">int</span><span class="token keyword">var</span> pts <span class="token punctuation">[</span><span class="token punctuation">]</span>gofpdf<span class="token punctuation">.</span>PointTypevertices <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>count <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token punctuation">[</span><span class="token punctuation">]</span>gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> pt gofpdf<span class="token punctuation">.</span>PointTyperes <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span>mlt <span class="token operator">:=</span> <span class="token number">2.0</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>Pi <span class="token operator">/</span> <span class="token function">float64</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pt<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> pt<span class="token punctuation">.</span>X <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">Sincos</span><span class="token punctuation">(</span><span class="token function">float64</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">*</span> mlt<span class="token punctuation">)</span>res <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> x <span class="token operator">+</span> radius<span class="token operator">*</span>pt<span class="token punctuation">.</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">:</span> y <span class="token operator">+</span> radius<span class="token operator">*</span>pt<span class="token punctuation">.</span>Y<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span><span class="token punctuation">&#125;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// A4 210.0 x 297.0</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> ptSize<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span>gap <span class="token operator">=</span> <span class="token number">12.0</span>pdf<span class="token punctuation">.</span><span class="token function">SetY</span><span class="token punctuation">(</span>gap<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">190.0</span><span class="token punctuation">,</span> gap<span class="token punctuation">,</span> <span class="token string">"Equilateral polygons"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>radius <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">210.0</span> <span class="token operator">-</span> <span class="token function">float64</span><span class="token punctuation">(</span>colCount<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>gap<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2.0</span> <span class="token operator">*</span> <span class="token function">float64</span><span class="token punctuation">(</span>colCount<span class="token punctuation">)</span><span class="token punctuation">)</span>advance <span class="token operator">=</span> gap <span class="token operator">+</span> <span class="token number">2.0</span><span class="token operator">*</span>radiusy <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>gap <span class="token operator">+</span> pdf<span class="token punctuation">.</span><span class="token function">PointConvert</span><span class="token punctuation">(</span>ptSize<span class="token punctuation">)</span> <span class="token operator">+</span> radiusrgVal <span class="token operator">=</span> <span class="token number">230</span><span class="token keyword">for</span> row <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> rowCount<span class="token punctuation">;</span> row<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span>rgVal<span class="token punctuation">,</span> rgVal<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>rgVal <span class="token operator">-=</span> <span class="token number">12</span>x <span class="token operator">=</span> gap <span class="token operator">+</span> radius<span class="token keyword">for</span> col <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> colCount<span class="token punctuation">;</span> col<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pts <span class="token operator">=</span> <span class="token function">vertices</span><span class="token punctuation">(</span>row<span class="token operator">*</span>colCount <span class="token operator">+</span> col <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Polygon</span><span class="token punctuation">(</span>pts<span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>x <span class="token operator">+=</span> advance<span class="token punctuation">&#125;</span>y <span class="token operator">+=</span> advance<span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_Polygon"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_Polygon.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示文档图层"><a href="#演示文档图层" class="headerlink" title="演示文档图层"></a>演示文档图层</h2><p>图层的初始可见性是用第二个参数AddLayer()指定的。文档阅读器显示的层列表允许交互式地控制层的可见性。</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_AddLayer demonstrates document layers. The initial visibility of a layer</span><span class="token comment">// is specified with the second parameter to AddLayer(). The layer list</span><span class="token comment">// displayed by the document reader allows layer visibility to be controlled</span><span class="token comment">// interactively.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_AddLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"This line doesn't belong to any layer.\n"</span><span class="token punctuation">)</span><span class="token comment">// Define layers</span>l1 <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">AddLayer</span><span class="token punctuation">(</span><span class="token string">"Layer 1"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>l2 <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">AddLayer</span><span class="token punctuation">(</span><span class="token string">"Layer 2"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token comment">// Open layer pane in PDF viewer</span>pdf<span class="token punctuation">.</span><span class="token function">OpenLayerPane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// First layer</span>pdf<span class="token punctuation">.</span><span class="token function">BeginLayer</span><span class="token punctuation">(</span>l1<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"This line belongs to layer 1.\n"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">EndLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Second layer</span>pdf<span class="token punctuation">.</span><span class="token function">BeginLayer</span><span class="token punctuation">(</span>l2<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"This line belongs to layer 2.\n"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">EndLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// First layer again</span>pdf<span class="token punctuation">.</span><span class="token function">BeginLayer</span><span class="token punctuation">(</span>l1<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"This line belongs to layer 1 again.\n"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">EndLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_AddLayer"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_AddLayer.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何使用从web服务器检索到的图像"><a href="#演示如何使用从web服务器检索到的图像" class="headerlink" title="演示如何使用从web服务器检索到的图像"></a>演示如何使用从web服务器检索到的图像</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_RegisterImageReader demonstrates the use of an image that is retrieved from a web</span><span class="token comment">// server.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_RegisterImageReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>margin   <span class="token operator">=</span> <span class="token number">10</span>wd       <span class="token operator">=</span> <span class="token number">210</span>ht       <span class="token operator">=</span> <span class="token number">297</span>fontSize <span class="token operator">=</span> <span class="token number">15</span>urlStr   <span class="token operator">=</span> <span class="token string">"https://github.com/jung-kurt/gofpdf/blob/master/image/gofpdf.png?raw=true"</span>msgStr   <span class="token operator">=</span> <span class="token string">`Images from the web can be easily embedded when a PDF document is generated.`</span><span class="token punctuation">)</span><span class="token keyword">var</span> <span class="token punctuation">(</span>rsp <span class="token operator">*</span>http<span class="token punctuation">.</span>Responseerr <span class="token builtin">error</span>tp  <span class="token builtin">string</span><span class="token punctuation">)</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontSize<span class="token punctuation">)</span>ln <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">PointConvert</span><span class="token punctuation">(</span>fontSize<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span>wd<span class="token operator">-</span>margin<span class="token operator">-</span>margin<span class="token punctuation">,</span> ln<span class="token punctuation">,</span> msgStr<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>rsp<span class="token punctuation">,</span> err <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>urlStr<span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>tp <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">ImageTypeFromMime</span><span class="token punctuation">(</span>rsp<span class="token punctuation">.</span>Header<span class="token punctuation">[</span><span class="token string">"Content-Type"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>infoPtr <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">RegisterImageReader</span><span class="token punctuation">(</span>urlStr<span class="token punctuation">,</span> tp<span class="token punctuation">,</span> rsp<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token keyword">if</span> pdf<span class="token punctuation">.</span><span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>imgWd<span class="token punctuation">,</span> imgHt <span class="token operator">:=</span> infoPtr<span class="token punctuation">.</span><span class="token function">Extent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>urlStr<span class="token punctuation">,</span> <span class="token punctuation">(</span>wd<span class="token operator">-</span>imgWd<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2.0</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">GetY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>ln<span class="token punctuation">,</span>imgWd<span class="token punctuation">,</span> imgHt<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> tp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_RegisterImageReader_url"</span><span class="token punctuation">)</span>err <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_RegisterImageReader_url.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示Beziergon函数"><a href="#演示Beziergon函数" class="headerlink" title="演示Beziergon函数"></a>演示Beziergon函数</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_Beziergon demonstrates the Beziergon function.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_Beziergon</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>margin      <span class="token operator">=</span> <span class="token number">10</span>wd          <span class="token operator">=</span> <span class="token number">210</span>unit        <span class="token operator">=</span> <span class="token punctuation">(</span>wd <span class="token operator">-</span> <span class="token number">2</span><span class="token operator">*</span>margin<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">6</span>ht          <span class="token operator">=</span> <span class="token number">297</span>fontSize    <span class="token operator">=</span> <span class="token number">15</span>msgStr      <span class="token operator">=</span> <span class="token string">`Demonstration of Beziergon function`</span>coefficient <span class="token operator">=</span> <span class="token number">0.6</span>delta       <span class="token operator">=</span> coefficient <span class="token operator">*</span> unitln          <span class="token operator">=</span> fontSize <span class="token operator">*</span> <span class="token number">25.4</span> <span class="token operator">/</span> <span class="token number">72</span>offsetX     <span class="token operator">=</span> <span class="token punctuation">(</span>wd <span class="token operator">-</span> <span class="token number">4</span><span class="token operator">*</span>unit<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span>offsetY     <span class="token operator">=</span> offsetX <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>ln<span class="token punctuation">)</span>srcList <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>ctrlList <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontSize<span class="token punctuation">)</span><span class="token keyword">for</span> j<span class="token punctuation">,</span> src <span class="token operator">:=</span> <span class="token keyword">range</span> srcList <span class="token punctuation">&#123;</span>srcList<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">=</span> offsetX <span class="token operator">+</span> src<span class="token punctuation">.</span>X<span class="token operator">*</span>unitsrcList<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">=</span> offsetY <span class="token operator">+</span> src<span class="token punctuation">.</span>Y<span class="token operator">*</span>unit<span class="token punctuation">&#125;</span><span class="token keyword">for</span> j<span class="token punctuation">,</span> ctrl <span class="token operator">:=</span> <span class="token keyword">range</span> ctrlList <span class="token punctuation">&#123;</span>ctrlList<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">=</span> ctrl<span class="token punctuation">.</span>X <span class="token operator">*</span> deltactrlList<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">=</span> ctrl<span class="token punctuation">.</span>Y <span class="token operator">*</span> delta<span class="token punctuation">&#125;</span>jPrev <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>srcList<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>srcPrev <span class="token operator">:=</span> srcList<span class="token punctuation">[</span>jPrev<span class="token punctuation">]</span>curveList <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">&#123;</span>srcPrev<span class="token punctuation">&#125;</span> <span class="token comment">// point [, control 0, control 1, point]*</span>control <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>curveList <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>curveList<span class="token punctuation">,</span> gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> x<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> y<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> j<span class="token punctuation">,</span> src <span class="token operator">:=</span> <span class="token keyword">range</span> srcList <span class="token punctuation">&#123;</span>ctrl <span class="token operator">:=</span> ctrlList<span class="token punctuation">[</span>jPrev<span class="token punctuation">]</span><span class="token function">control</span><span class="token punctuation">(</span>srcPrev<span class="token punctuation">.</span>X<span class="token operator">+</span>ctrl<span class="token punctuation">.</span>X<span class="token punctuation">,</span> srcPrev<span class="token punctuation">.</span>Y<span class="token operator">+</span>ctrl<span class="token punctuation">.</span>Y<span class="token punctuation">)</span> <span class="token comment">// Control 0</span>ctrl <span class="token operator">=</span> ctrlList<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token function">control</span><span class="token punctuation">(</span>src<span class="token punctuation">.</span>X<span class="token operator">-</span>ctrl<span class="token punctuation">.</span>X<span class="token punctuation">,</span> src<span class="token punctuation">.</span>Y<span class="token operator">-</span>ctrl<span class="token punctuation">.</span>Y<span class="token punctuation">)</span> <span class="token comment">// Control 1</span>curveList <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>curveList<span class="token punctuation">,</span> src<span class="token punctuation">)</span>  <span class="token comment">// Destination</span>jPrev <span class="token operator">=</span> jsrcPrev <span class="token operator">=</span> src<span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span>wd<span class="token operator">-</span>margin<span class="token operator">-</span>margin<span class="token punctuation">,</span> ln<span class="token punctuation">,</span> msgStr<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDashPattern</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">&#123;</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Polygon</span><span class="token punctuation">(</span>srcList<span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDashPattern</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span>pdf<span class="token punctuation">.</span><span class="token function">GetLineWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Beziergon</span><span class="token punctuation">(</span>curveList<span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_Beziergon"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_Beziergon.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示使用通用字体加载器加载非标准字体"><a href="#演示使用通用字体加载器加载非标准字体" class="headerlink" title="演示使用通用字体加载器加载非标准字体"></a>演示使用通用字体加载器加载非标准字体</h2><p>fontResourceType实现了FontLoader接口，并在测试源代码中进行了本地定义。</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetFontLoader demonstrates loading a non-standard font using a generalized</span><span class="token comment">// font loader. fontResourceType implements the FontLoader interface and is</span><span class="token comment">// defined locally in the test source code.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetFontLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> fr fontResourceTypepdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFontLoader</span><span class="token punctuation">(</span>fr<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddFont</span><span class="token punctuation">(</span><span class="token string">"Calligrapher"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"calligra.json"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Calligrapher"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Load fonts from any source"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetFontLoader"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Generalized font loader reading calligra.json</span><span class="token comment">// Generalized font loader reading calligra.z</span><span class="token comment">// Successfully generated pdf/Fpdf_SetFontLoader.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示路径绘制功能"><a href="#演示路径绘制功能" class="headerlink" title="演示路径绘制功能"></a>演示路径绘制功能</h2><p>如:移动，直线，曲线，…、ClosePath和DrawPath。</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_MoveTo demonstrates the Path Drawing functions, such as: MoveTo,</span><span class="token comment">// LineTo, CurveTo, ..., ClosePath and DrawPath.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_MoveTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MoveTo</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LineTo</span><span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ArcTo</span><span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CurveTo</span><span class="token punctuation">(</span><span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CurveBezierCubicTo</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClosePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">DrawPath</span><span class="token punctuation">(</span><span class="token string">"DF"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_MoveTo_path"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_MoveTo_path.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示各种线帽和线连接样式"><a href="#演示各种线帽和线连接样式" class="headerlink" title="演示各种线帽和线连接样式"></a>演示各种线帽和线连接样式</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetLineJoinStyle demonstrates various line cap and line join styles.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetLineJoinStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token number">75.0</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">var</span> draw <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token builtin">cap</span><span class="token punctuation">,</span> join <span class="token builtin">string</span><span class="token punctuation">,</span> x0<span class="token punctuation">,</span> y0<span class="token punctuation">,</span> x1<span class="token punctuation">,</span> y1 <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// transform begin &amp; end needed to isolate caps and joins</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineCapStyle</span><span class="token punctuation">(</span><span class="token builtin">cap</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineJoinStyle</span><span class="token punctuation">(</span>join<span class="token punctuation">)</span><span class="token comment">// Draw thick line</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">30.0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MoveTo</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span> y0<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LineTo</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x0<span class="token operator">+</span>x1<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>offset<span class="token punctuation">,</span> <span class="token punctuation">(</span>y0<span class="token operator">+</span>y1<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LineTo</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">DrawPath</span><span class="token punctuation">(</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token comment">// Draw thin helping line</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">0xFF</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">2.56</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MoveTo</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span> y0<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LineTo</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x0<span class="token operator">+</span>x1<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>offset<span class="token punctuation">,</span> <span class="token punctuation">(</span>y0<span class="token operator">+</span>y1<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LineTo</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">DrawPath</span><span class="token punctuation">(</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>x <span class="token operator">:=</span> <span class="token number">35.0</span>caps <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token string">"butt"</span><span class="token punctuation">,</span> <span class="token string">"square"</span><span class="token punctuation">,</span> <span class="token string">"round"</span><span class="token punctuation">&#125;</span>joins <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token string">"bevel"</span><span class="token punctuation">,</span> <span class="token string">"miter"</span><span class="token punctuation">,</span> <span class="token string">"round"</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> caps <span class="token punctuation">&#123;</span><span class="token function">draw</span><span class="token punctuation">(</span>caps<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> joins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>x <span class="token operator">+=</span> offset<span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetLineJoinStyle_caps"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SetLineJoinStyle_caps.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示各种填充模式"><a href="#演示各种填充模式" class="headerlink" title="演示各种填充模式"></a>演示各种填充模式</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_DrawPath demonstrates various fill modes.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_DrawPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Helvetica"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAlpha</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Multiply"</span><span class="token punctuation">)</span><span class="token keyword">var</span> <span class="token punctuation">(</span>polygon <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>cx<span class="token punctuation">,</span> cy<span class="token punctuation">,</span> r<span class="token punctuation">,</span> n<span class="token punctuation">,</span> dir <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>da <span class="token operator">:=</span> <span class="token number">2</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>Pi <span class="token operator">/</span> npdf<span class="token punctuation">.</span><span class="token function">MoveTo</span><span class="token punctuation">(</span>cx<span class="token operator">+</span>r<span class="token punctuation">,</span> cy<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span>cx<span class="token operator">+</span>r<span class="token punctuation">,</span> cy<span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>i <span class="token operator">:=</span> <span class="token number">1</span><span class="token keyword">for</span> a <span class="token operator">:=</span> da<span class="token punctuation">;</span> a <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token operator">*</span>math<span class="token punctuation">.</span>Pi<span class="token punctuation">;</span> a <span class="token operator">+=</span> da <span class="token punctuation">&#123;</span>x<span class="token punctuation">,</span> y <span class="token operator">:=</span> cx<span class="token operator">+</span>r<span class="token operator">*</span>math<span class="token punctuation">.</span><span class="token function">Cos</span><span class="token punctuation">(</span>dir<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> cy<span class="token operator">+</span>r<span class="token operator">*</span>math<span class="token punctuation">.</span><span class="token function">Sin</span><span class="token punctuation">(</span>dir<span class="token operator">*</span>a<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LineTo</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> strconv<span class="token punctuation">.</span><span class="token function">Itoa</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>i<span class="token operator">++</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">ClosePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>polygons <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>cx<span class="token punctuation">,</span> cy<span class="token punctuation">,</span> r<span class="token punctuation">,</span> n<span class="token punctuation">,</span> dir <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>d <span class="token operator">:=</span> <span class="token number">1.0</span><span class="token keyword">for</span> rf <span class="token operator">:=</span> r<span class="token punctuation">;</span> rf <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> rf <span class="token operator">-=</span> <span class="token number">10</span> <span class="token punctuation">&#123;</span><span class="token function">polygon</span><span class="token punctuation">(</span>cx<span class="token punctuation">,</span> cy<span class="token punctuation">,</span> rf<span class="token punctuation">,</span> n<span class="token punctuation">,</span> d<span class="token punctuation">)</span>d <span class="token operator">*=</span> dir<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>star <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>cx<span class="token punctuation">,</span> cy<span class="token punctuation">,</span> r<span class="token punctuation">,</span> n <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>da <span class="token operator">:=</span> <span class="token number">4</span> <span class="token operator">*</span> math<span class="token punctuation">.</span>Pi <span class="token operator">/</span> npdf<span class="token punctuation">.</span><span class="token function">MoveTo</span><span class="token punctuation">(</span>cx<span class="token operator">+</span>r<span class="token punctuation">,</span> cy<span class="token punctuation">)</span><span class="token keyword">for</span> a <span class="token operator">:=</span> da<span class="token punctuation">;</span> a <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token operator">*</span>math<span class="token punctuation">.</span>Pi<span class="token operator">+</span>da<span class="token punctuation">;</span> a <span class="token operator">+=</span> da <span class="token punctuation">&#123;</span>x<span class="token punctuation">,</span> y <span class="token operator">:=</span> cx<span class="token operator">+</span>r<span class="token operator">*</span>math<span class="token punctuation">.</span><span class="token function">Cos</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> cy<span class="token operator">+</span>r<span class="token operator">*</span>math<span class="token punctuation">.</span><span class="token function">Sin</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">LineTo</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">ClosePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">// triangle</span><span class="token function">polygons</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">DrawPath</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token string">"B (same direction, non zero winding)"</span><span class="token punctuation">)</span><span class="token comment">// square</span><span class="token function">polygons</span><span class="token punctuation">(</span><span class="token number">155</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">DrawPath</span><span class="token punctuation">(</span><span class="token string">"B*"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token string">"B* (same direction, even odd)"</span><span class="token punctuation">)</span><span class="token comment">// pentagon</span><span class="token function">polygons</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">DrawPath</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token string">"B (different direction, non zero winding)"</span><span class="token punctuation">)</span><span class="token comment">// hexagon</span><span class="token function">polygons</span><span class="token punctuation">(</span><span class="token number">155</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">DrawPath</span><span class="token punctuation">(</span><span class="token string">"B*"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token string">"B* (different direction, even odd)"</span><span class="token punctuation">)</span><span class="token comment">// star</span><span class="token function">star</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">245</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">DrawPath</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">290</span><span class="token punctuation">,</span> <span class="token string">"B (non zero winding)"</span><span class="token punctuation">)</span><span class="token comment">// star</span><span class="token function">star</span><span class="token punctuation">(</span><span class="token number">155</span><span class="token punctuation">,</span> <span class="token number">245</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">DrawPath</span><span class="token punctuation">(</span><span class="token string">"B*"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">,</span> <span class="token number">290</span><span class="token punctuation">,</span> <span class="token string">"B* (even odd)"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_DrawPath_fill"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_DrawPath_fill.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示创建和使用模板"><a href="#演示创建和使用模板" class="headerlink" title="演示创建和使用模板"></a>演示创建和使用模板</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_CreateTemplate demonstrates creating and using templates</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_CreateTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetCompression</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment">// pdf.SetFont("Times", "", 12)</span>template <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">CreateTemplate</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>tpl <span class="token operator">*</span>gofpdf<span class="token punctuation">.</span>Tpl<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>tpl<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>tpl<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>tpl<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"Template says hello"</span><span class="token punctuation">)</span>tpl<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>tpl<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">)</span>tpl<span class="token punctuation">.</span><span class="token function">Line</span><span class="token punctuation">(</span><span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token boolean">_</span><span class="token punctuation">,</span> tplSize <span class="token operator">:=</span> template<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// fmt.Println("Size:", tplSize)</span><span class="token comment">// fmt.Println("Scaled:", tplSize.ScaleBy(1.5))</span>template2 <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">CreateTemplate</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>tpl <span class="token operator">*</span>gofpdf<span class="token punctuation">.</span>Tpl<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>tpl<span class="token punctuation">.</span><span class="token function">UseTemplate</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span>subtemplate <span class="token operator">:=</span> tpl<span class="token punctuation">.</span><span class="token function">CreateTemplate</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>tpl2 <span class="token operator">*</span>gofpdf<span class="token punctuation">.</span>Tpl<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>tpl2<span class="token punctuation">.</span><span class="token function">Image</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">ImageFile</span><span class="token punctuation">(</span><span class="token string">"logo.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>tpl2<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>tpl2<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"Subtemplate says hello"</span><span class="token punctuation">)</span>tpl2<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>tpl2<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">)</span>tpl2<span class="token punctuation">.</span><span class="token function">Line</span><span class="token punctuation">(</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>tpl<span class="token punctuation">.</span><span class="token function">UseTemplate</span><span class="token punctuation">(</span>subtemplate<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token comment">// serialize and deserialize template</span>b<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> template2<span class="token punctuation">.</span><span class="token function">Serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>template3<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">DeserializeTemplate</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">UseTemplate</span><span class="token punctuation">(</span>template3<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">UseTemplateScaled</span><span class="token punctuation">(</span>template3<span class="token punctuation">,</span> gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> tplSize<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Line</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"Template example page 1"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">UseTemplate</span><span class="token punctuation">(</span>template2<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">UseTemplateScaled</span><span class="token punctuation">(</span>template3<span class="token punctuation">,</span> gofpdf<span class="token punctuation">.</span>PointType<span class="token punctuation">&#123;</span>X<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> tplSize<span class="token punctuation">.</span><span class="token function">ScaleBy</span><span class="token punctuation">(</span><span class="token number">1.4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Line</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">"Template example page 2"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_CreateTemplate"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_CreateTemplate.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何使用字节数组中的嵌入字体"><a href="#演示如何使用字节数组中的嵌入字体" class="headerlink" title="演示如何使用字节数组中的嵌入字体"></a>演示如何使用字节数组中的嵌入字体</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_AddFontFromBytes demonstrate how to use embedded fonts from byte array</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_AddFontFromBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddFontFromBytes</span><span class="token punctuation">(</span><span class="token string">"calligra"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> files<span class="token punctuation">.</span>CalligraJson<span class="token punctuation">,</span> files<span class="token punctuation">.</span>CalligraZ<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"calligra"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Hello World With Embedded Font!"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_EmbeddedFont"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_EmbeddedFont.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示了剪切的表格单元格"><a href="#演示了剪切的表格单元格" class="headerlink" title="演示了剪切的表格单元格"></a>演示了剪切的表格单元格</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// This example demonstrate Clipped table cells</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_ClipRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>marginCell <span class="token operator">:=</span> <span class="token number">2.</span> <span class="token comment">// margin of top/bottom of cell</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pagew<span class="token punctuation">,</span> pageh <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>mleft<span class="token punctuation">,</span> mright<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> mbottom <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetMargins</span><span class="token punctuation">(</span><span class="token punctuation">)</span>cols <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">&#123;</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> pagew <span class="token operator">-</span> mleft <span class="token operator">-</span> mright <span class="token operator">-</span> <span class="token number">100</span> <span class="token operator">-</span> <span class="token number">60</span><span class="token punctuation">&#125;</span>rows <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">50</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>word <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%d:%s"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> strings<span class="token punctuation">.</span><span class="token function">Repeat</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> i<span class="token operator">%</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>rows <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span>word<span class="token punctuation">,</span> word<span class="token punctuation">,</span> word<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> rows <span class="token punctuation">&#123;</span><span class="token boolean">_</span><span class="token punctuation">,</span> lineHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>height <span class="token operator">:=</span> lineHt <span class="token operator">+</span> marginCellx<span class="token punctuation">,</span> y <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetXY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// add a new page if the height of the row doesn't fit on the page</span><span class="token keyword">if</span> y<span class="token operator">+</span>height <span class="token operator">>=</span> pageh<span class="token operator">-</span>mbottom <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>x<span class="token punctuation">,</span> y <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">GetXY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> txt <span class="token operator">:=</span> <span class="token keyword">range</span> row <span class="token punctuation">&#123;</span>width <span class="token operator">:=</span> cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipRect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> txt<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">ClipEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>x <span class="token operator">+=</span> width<span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_ClippedTableCells"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_ClippedTableCells.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示包装表格单元格"><a href="#演示包装表格单元格" class="headerlink" title="演示包装表格单元格"></a>演示包装表格单元格</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// This example demonstrate wrapped table cells</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_Rect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>marginCell <span class="token operator">:=</span> <span class="token number">2.</span> <span class="token comment">// margin of top/bottom of cell</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pagew<span class="token punctuation">,</span> pageh <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>mleft<span class="token punctuation">,</span> mright<span class="token punctuation">,</span> <span class="token boolean">_</span><span class="token punctuation">,</span> mbottom <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetMargins</span><span class="token punctuation">(</span><span class="token punctuation">)</span>cols <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">&#123;</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> pagew <span class="token operator">-</span> mleft <span class="token operator">-</span> mright <span class="token operator">-</span> <span class="token number">100</span> <span class="token operator">-</span> <span class="token number">60</span><span class="token punctuation">&#125;</span>rows <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">30</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>word <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%d:%s"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> strings<span class="token punctuation">.</span><span class="token function">Repeat</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> i<span class="token operator">%</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>rows <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">&#123;</span>word<span class="token punctuation">,</span> word<span class="token punctuation">,</span> word<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> rows <span class="token punctuation">&#123;</span>curx<span class="token punctuation">,</span> y <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetXY</span><span class="token punctuation">(</span><span class="token punctuation">)</span>x <span class="token operator">:=</span> curxheight <span class="token operator">:=</span> <span class="token number">0.</span><span class="token boolean">_</span><span class="token punctuation">,</span> lineHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> txt <span class="token operator">:=</span> <span class="token keyword">range</span> row <span class="token punctuation">&#123;</span>lines <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">SplitLines</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>txt<span class="token punctuation">)</span><span class="token punctuation">,</span> cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>h <span class="token operator">:=</span> <span class="token function">float64</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>lineHt <span class="token operator">+</span> marginCell<span class="token operator">*</span><span class="token function">float64</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> h <span class="token operator">></span> height <span class="token punctuation">&#123;</span>height <span class="token operator">=</span> h<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// add a new page if the height of the row doesn't fit on the page</span><span class="token keyword">if</span> pdf<span class="token punctuation">.</span><span class="token function">GetY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>height <span class="token operator">></span> pageh<span class="token operator">-</span>mbottom <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>y <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">GetY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> txt <span class="token operator">:=</span> <span class="token keyword">range</span> row <span class="token punctuation">&#123;</span>width <span class="token operator">:=</span> cols<span class="token punctuation">[</span>i<span class="token punctuation">]</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> lineHt<span class="token operator">+</span>marginCell<span class="token punctuation">,</span> txt<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>x <span class="token operator">+=</span> widthpdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span>curx<span class="token punctuation">,</span> y<span class="token operator">+</span>height<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_WrappedTableCells"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_WrappedTableCells.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示在文档中包含JavaScript"><a href="#演示在文档中包含JavaScript" class="headerlink" title="演示在文档中包含JavaScript"></a>演示在文档中包含JavaScript</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetJavascript demonstrates including JavaScript in the document.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetJavascript</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetJavascript</span><span class="token punctuation">(</span><span class="token string">"print(true);"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Auto-print."</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetJavascript"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SetJavascript.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示专色的使用"><a href="#演示专色的使用" class="headerlink" title="演示专色的使用"></a>演示专色的使用</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_AddSpotColor demonstrates spot color use</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_AddSpotColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddSpotColor</span><span class="token punctuation">(</span><span class="token string">"PANTONE 145 CVC"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillSpotColor</span><span class="token punctuation">(</span><span class="token string">"PANTONE 145 CVC"</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_AddSpotColor"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_AddSpotColor.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何使用’-RegisterAlias-‘创建目录表"><a href="#演示如何使用’-RegisterAlias-‘创建目录表" class="headerlink" title="演示如何使用’ RegisterAlias ‘创建目录表"></a>演示如何使用’ RegisterAlias ‘创建目录表</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_RegisterAlias demonstrates how to use `RegisterAlias` to create a table of</span><span class="token comment">// contents.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_RegisterAlias</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AliasNbPages</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Write the table of contents. We use aliases instead of the page number</span><span class="token comment">// because we don't know which page the section will begin on.</span>numSections <span class="token operator">:=</span> <span class="token number">3</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> numSections<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Section %d begins on page &#123;mark %d&#125;"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">// Write the sections. Before we start writing, we use `RegisterAlias` to</span><span class="token comment">// ensure that the alias written in the table of contents will be replaced</span><span class="token comment">// by the current page number.</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> numSections<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RegisterAlias</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"&#123;mark %d&#125;"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">PageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Section %d, page %d of &#123;nb&#125;"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">PageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_RegisterAlias"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_RegisterAlias.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何使用’-RegisterAlias-‘创建目录表-1"><a href="#演示如何使用’-RegisterAlias-‘创建目录表-1" class="headerlink" title="演示如何使用’ RegisterAlias ‘创建目录表"></a>演示如何使用’ RegisterAlias ‘创建目录表</h2><p>这个特殊的示例演示了UTF-8别名的使用。</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_RegisterAlias_utf8 demonstrates how to use `RegisterAlias` to</span><span class="token comment">// create a table of contents. This particular example demonstrates the use of</span><span class="token comment">// UTF-8 aliases.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_RegisterAlias_utf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddUTF8Font</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">FontFile</span><span class="token punctuation">(</span><span class="token string">"DejaVuSansCondensed.ttf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AliasNbPages</span><span class="token punctuation">(</span><span class="token string">"&#123;entute&#125;"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Write the table of contents. We use aliases instead of the page number</span><span class="token comment">// because we don't know which page the section will begin on.</span>numSections <span class="token operator">:=</span> <span class="token number">3</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> numSections<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Sekcio %d komenciĝas ĉe paĝo &#123;ĉi tiu marko %d&#125;"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">// Write the sections. Before we start writing, we use `RegisterAlias` to</span><span class="token comment">// ensure that the alias written in the table of contents will be replaced</span><span class="token comment">// by the current page number.</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> numSections<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">RegisterAlias</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"&#123;ĉi tiu marko %d&#125;"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">PageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Sekcio %d, paĝo %d de &#123;entute&#125;"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">PageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_RegisterAliasUTF8"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_RegisterAliasUTF8.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示图形网格的生成"><a href="#演示图形网格的生成" class="headerlink" title="演示图形网格的生成"></a>演示图形网格的生成</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleNewGrid demonstrates the generation of graph grids.</span><span class="token keyword">func</span> <span class="token function">ExampleNewGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>gr <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">NewGrid</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">187</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span><span class="token function">TickmarksExtentX</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span><span class="token function">TickmarksExtentY</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span><span class="token function">Grid</span><span class="token punctuation">(</span>pdf<span class="token punctuation">)</span>gr <span class="token operator">=</span> gofpdf<span class="token punctuation">.</span><span class="token function">NewGrid</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">154</span><span class="token punctuation">,</span> <span class="token number">187</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span>XLabelRotate <span class="token operator">=</span> <span class="token boolean">true</span>gr<span class="token punctuation">.</span><span class="token function">TickmarksExtentX</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span>XDiv <span class="token operator">=</span> <span class="token number">5</span>gr<span class="token punctuation">.</span><span class="token function">TickmarksContainY</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span>YDiv <span class="token operator">=</span> <span class="token number">20</span><span class="token comment">// Replace X label formatter with month abbreviation</span>gr<span class="token punctuation">.</span>XTickStr <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>val <span class="token builtin">float64</span><span class="token punctuation">,</span> precision <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> time<span class="token punctuation">.</span><span class="token function">Month</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">Mod</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>gr<span class="token punctuation">.</span><span class="token function">Grid</span><span class="token punctuation">(</span>pdf<span class="token punctuation">)</span>dot <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">Circle</span><span class="token punctuation">(</span>gr<span class="token punctuation">.</span><span class="token function">X</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> gr<span class="token punctuation">.</span><span class="token function">Y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pts <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">&#123;</span><span class="token number">0.39</span><span class="token punctuation">,</span> <span class="token number">0.457</span><span class="token punctuation">,</span> <span class="token number">0.612</span><span class="token punctuation">,</span> <span class="token number">0.84</span><span class="token punctuation">,</span> <span class="token number">0.998</span><span class="token punctuation">,</span> <span class="token number">1.037</span><span class="token punctuation">,</span> <span class="token number">1.015</span><span class="token punctuation">,</span> <span class="token number">0.918</span><span class="token punctuation">,</span> <span class="token number">0.772</span><span class="token punctuation">,</span> <span class="token number">0.659</span><span class="token punctuation">,</span> <span class="token number">0.593</span><span class="token punctuation">,</span> <span class="token number">0.164</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> month<span class="token punctuation">,</span> val <span class="token operator">:=</span> <span class="token keyword">range</span> pts <span class="token punctuation">&#123;</span><span class="token function">dot</span><span class="token punctuation">(</span><span class="token function">float64</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAlpha</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token string">"Normal"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span><span class="token function">Plot</span><span class="token punctuation">(</span>pdf<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">11.5</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>x <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token builtin">float64</span> <span class="token punctuation">&#123;</span><span class="token comment">// http://www.xuru.org/rt/PR.asp</span><span class="token keyword">return</span> <span class="token number">0.227</span> <span class="token operator">*</span> math<span class="token punctuation">.</span><span class="token function">Exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.0373</span><span class="token operator">*</span>x<span class="token operator">*</span>x<span class="token operator">+</span><span class="token number">0.471</span><span class="token operator">*</span>x<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAlpha</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token string">"Normal"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span>gr<span class="token punctuation">.</span><span class="token function">X</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gr<span class="token punctuation">.</span><span class="token function">Y</span><span class="token punctuation">(</span><span class="token number">1.35</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFontSize</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"Solar energy (MWh) per month, 2016"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>gr <span class="token operator">=</span> gofpdf<span class="token punctuation">.</span><span class="token function">NewGrid</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">187</span><span class="token punctuation">,</span> <span class="token number">274</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span><span class="token function">TickmarksContainX</span><span class="token punctuation">(</span><span class="token number">2.3</span><span class="token punctuation">,</span> <span class="token number">3.4</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span><span class="token function">TickmarksContainY</span><span class="token punctuation">(</span><span class="token number">10.4</span><span class="token punctuation">,</span> <span class="token number">56.8</span><span class="token punctuation">)</span>gr<span class="token punctuation">.</span><span class="token function">Grid</span><span class="token punctuation">(</span>pdf<span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_Grid"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_Grid.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示页面框的使用"><a href="#演示页面框的使用" class="headerlink" title="演示页面框的使用"></a>演示页面框的使用</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetPageBox demonstrates the use of a page box</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetPageBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// pdfinfo (from http://www.xpdfreader.com) reports the following for this example:</span><span class="token comment">// ~ pdfinfo -box pdf/Fpdf_PageBox.pdf</span><span class="token comment">// Producer:       FPDF 1.7</span><span class="token comment">// CreationDate:   Sat Jan  1 00:00:00 2000</span><span class="token comment">// ModDate:      Sat Jan  1 00:00:00 2000</span><span class="token comment">// Tagged:         no</span><span class="token comment">// Form:           none</span><span class="token comment">// Pages:          1</span><span class="token comment">// Encrypted:      no</span><span class="token comment">// Page size:      493.23 x 739.85 pts (rotated 0 degrees)</span><span class="token comment">// MediaBox:           0.00     0.00   595.28   841.89</span><span class="token comment">// CropBox:           51.02    51.02   544.25   790.87</span><span class="token comment">// BleedBox:          51.02    51.02   544.25   790.87</span><span class="token comment">// TrimBox:           51.02    51.02   544.25   790.87</span><span class="token comment">// ArtBox:            51.02    51.02   544.25   790.87</span><span class="token comment">// File size:      1053 bytes</span><span class="token comment">// Optimized:      no</span><span class="token comment">// PDF version:    1.3</span><span class="token keyword">const</span> <span class="token punctuation">(</span>wd        <span class="token operator">=</span> <span class="token number">210</span>ht        <span class="token operator">=</span> <span class="token number">297</span>fontsize  <span class="token operator">=</span> <span class="token number">6</span>boxmargin <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">*</span> fontsize<span class="token punctuation">)</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// 210mm x 297mm</span>pdf<span class="token punctuation">.</span><span class="token function">SetPageBox</span><span class="token punctuation">(</span><span class="token string">"crop"</span><span class="token punctuation">,</span> boxmargin<span class="token punctuation">,</span> boxmargin<span class="token punctuation">,</span> wd<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>boxmargin<span class="token punctuation">,</span> ht<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>boxmargin<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">UnitToPointConvert</span><span class="token punctuation">(</span>fontsize<span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MoveTo</span><span class="token punctuation">(</span>fontsize<span class="token punctuation">,</span> fontsize<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>fontsize<span class="token punctuation">,</span> <span class="token string">"This will be cropped from printed output"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MoveTo</span><span class="token punctuation">(</span>boxmargin<span class="token operator">+</span>fontsize<span class="token punctuation">,</span> boxmargin<span class="token operator">+</span>fontsize<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>fontsize<span class="token punctuation">,</span> <span class="token string">"This will be displayed in cropped output"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_PageBox"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_PageBox.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示下标和上标文本"><a href="#演示下标和上标文本" class="headerlink" title="演示下标和上标文本"></a>演示下标和上标文本</h2><p>改编自<a href="http://www.fpdf.org/en/script/script61.php">http://www.fpdf.org/en/script/script61.php</a></p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SubWrite demonstrates subscripted and superscripted text</span><span class="token comment">// Adapted from http://www.fpdf.org/en/script/script61.php</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SubWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">const</span> <span class="token punctuation">(</span>fontSize <span class="token operator">=</span> <span class="token number">12</span>halfX    <span class="token operator">=</span> <span class="token number">105</span><span class="token punctuation">)</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// 210mm x 297mm</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontSize<span class="token punctuation">)</span><span class="token boolean">_</span><span class="token punctuation">,</span> lineHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">GetFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"Hello World!"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>halfX<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"This is standard text.\n"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span>lineHt <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SubWrite</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"H"</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"ello World!"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>halfX<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"This is text with a capital first letter.\n"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span>lineHt <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SubWrite</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"Y"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"ou can also begin the sentence with a small letter. And word wrap also works if the line is too long, like this one is."</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>halfX<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"This is text with a small first letter.\n"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span>lineHt <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"The world has a lot of km"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SubWrite</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>halfX<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"This is text with a superscripted letter.\n"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span>lineHt <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"The world has a lot of H"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SubWrite</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"O"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetX</span><span class="token punctuation">(</span>halfX<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineHt<span class="token punctuation">,</span> <span class="token string">"This is text with a subscripted letter.\n"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SubWrite"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SubWrite.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示了SetPage-方法"><a href="#演示了SetPage-方法" class="headerlink" title="演示了SetPage()方法"></a>演示了SetPage()方法</h2><p>该方法允许将内容生成延迟到添加了所有页面之后</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetPage demomstrates the SetPage() method, allowing content</span><span class="token comment">// generation to be deferred until all pages have been added.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>rnd <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">NewSource</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Make reproducible documents</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"cm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token keyword">var</span> time <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span>temperaturesFromSensors <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>maxs <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">&#123;</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> temperaturesFromSensors <span class="token punctuation">&#123;</span>temperaturesFromSensors<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0.0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">0.5</span> <span class="token punctuation">&#123;</span>time <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token keyword">for</span> j<span class="token punctuation">,</span> sensor <span class="token operator">:=</span> <span class="token keyword">range</span> temperaturesFromSensors <span class="token punctuation">&#123;</span>dataValue <span class="token operator">:=</span> rnd<span class="token punctuation">.</span><span class="token function">Float64</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxs<span class="token punctuation">[</span>j<span class="token punctuation">]</span>sensor <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>sensor<span class="token punctuation">,</span> dataValue<span class="token punctuation">)</span>temperaturesFromSensors<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> sensor<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">var</span> graphs <span class="token punctuation">[</span><span class="token punctuation">]</span>gofpdf<span class="token punctuation">.</span>GridType<span class="token keyword">var</span> pageNums <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>xMax <span class="token operator">:=</span> time<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> temperaturesFromSensors <span class="token punctuation">&#123;</span><span class="token comment">//Create a new page and graph for each sensor we want to graph.</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//Custom label per sensor</span>pdf<span class="token punctuation">.</span><span class="token function">WriteAligned</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"Temperature Sensor "</span><span class="token operator">+</span>strconv<span class="token punctuation">.</span><span class="token function">Itoa</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" (C) vs Time (min)"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>graph <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">NewGrid</span><span class="token punctuation">(</span>pdf<span class="token punctuation">.</span><span class="token function">GetX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">GetY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>graph<span class="token punctuation">.</span><span class="token function">TickmarksContainX</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> xMax<span class="token punctuation">)</span><span class="token comment">//Custom Y axis</span>graph<span class="token punctuation">.</span><span class="token function">TickmarksContainY</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> maxs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>graph<span class="token punctuation">.</span><span class="token function">Grid</span><span class="token punctuation">(</span>pdf<span class="token punctuation">)</span><span class="token comment">//Save references and locations.</span>graphs <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>graphs<span class="token punctuation">,</span> graph<span class="token punctuation">)</span>pageNums <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>pageNums<span class="token punctuation">,</span> pdf<span class="token punctuation">.</span><span class="token function">PageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token comment">// For each X, graph the Y in each sensor.</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> currTime <span class="token operator">:=</span> <span class="token keyword">range</span> time <span class="token punctuation">&#123;</span><span class="token keyword">for</span> j<span class="token punctuation">,</span> sensor <span class="token operator">:=</span> <span class="token keyword">range</span> temperaturesFromSensors <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetPage</span><span class="token punctuation">(</span>pageNums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>graph <span class="token operator">:=</span> graphs<span class="token punctuation">[</span>j<span class="token punctuation">]</span>temperature <span class="token operator">:=</span> sensor<span class="token punctuation">[</span>i<span class="token punctuation">]</span>pdf<span class="token punctuation">.</span><span class="token function">Circle</span><span class="token punctuation">(</span>graph<span class="token punctuation">.</span><span class="token function">X</span><span class="token punctuation">(</span>currTime<span class="token punctuation">)</span><span class="token punctuation">,</span> graph<span class="token punctuation">.</span><span class="token function">Y</span><span class="token punctuation">(</span>temperature<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.04</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetPage"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SetPage.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何在多个转换中正确分配图形属性"><a href="#演示如何在多个转换中正确分配图形属性" class="headerlink" title="演示如何在多个转换中正确分配图形属性"></a>演示如何在多个转换中正确分配图形属性</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetFillColor demonstrates how graphic attributes are properly</span><span class="token comment">// assigned within multiple transformations. See issue #234.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetFillColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>draw <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>trX<span class="token punctuation">,</span> trY <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformTranslateX</span><span class="token punctuation">(</span>trX<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformTranslateY</span><span class="token punctuation">(</span>trY<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineJoinStyle</span><span class="token punctuation">(</span><span class="token string">"round"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetLineWidth</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFillColor</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetAlpha</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token string">"Normal"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDashPattern</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">&#123;</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token string">"FD"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFontSize</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"Test"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetFillColor"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SetFillColor.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何旋转标题内的文本以使水印显示在每个页面上"><a href="#演示如何旋转标题内的文本以使水印显示在每个页面上" class="headerlink" title="演示如何旋转标题内的文本以使水印显示在每个页面上"></a>演示如何旋转标题内的文本以使水印显示在每个页面上</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_TransformRotate demonstrates how to rotate text within a header</span><span class="token comment">// to make a watermark that appears on each page.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_TransformRotate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>loremStr <span class="token operator">:=</span> <span class="token function">lorem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n\n"</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>margin <span class="token operator">:=</span> <span class="token number">25.0</span>pdf<span class="token punctuation">.</span><span class="token function">SetMargins</span><span class="token punctuation">(</span>margin<span class="token punctuation">,</span> margin<span class="token punctuation">,</span> margin<span class="token punctuation">)</span>fontHt <span class="token operator">:=</span> <span class="token number">13.0</span>lineHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">PointToUnitConvert</span><span class="token punctuation">(</span>fontHt<span class="token punctuation">)</span>markFontHt <span class="token operator">:=</span> <span class="token number">50.0</span>markLineHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">PointToUnitConvert</span><span class="token punctuation">(</span>markFontHt<span class="token punctuation">)</span>markY <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token number">297.0</span> <span class="token operator">-</span> markLineHt<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span>ctrX <span class="token operator">:=</span> <span class="token number">210.0</span> <span class="token operator">/</span> <span class="token number">2.0</span>ctrY <span class="token operator">:=</span> <span class="token number">297.0</span> <span class="token operator">/</span> <span class="token number">2.0</span>pdf<span class="token punctuation">.</span><span class="token function">SetHeaderFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> markFontHt<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">206</span><span class="token punctuation">,</span> <span class="token number">216</span><span class="token punctuation">,</span> <span class="token number">232</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span>margin<span class="token punctuation">,</span> markY<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformBegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformRotate</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span> ctrX<span class="token punctuation">,</span> ctrY<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> markLineHt<span class="token punctuation">,</span> <span class="token string">"W A T E R M A R K   D E M O"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">TransformEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span>margin<span class="token punctuation">,</span> margin<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> lineHt<span class="token punctuation">,</span> loremStr<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_RotateText"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_RotateText.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何使用utf-8模式的字体"><a href="#演示如何使用utf-8模式的字体" class="headerlink" title="演示如何使用utf-8模式的字体"></a>演示如何使用utf-8模式的字体</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_AddUTF8Font demonstrates how use the font</span><span class="token comment">// with utf-8 mode</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_AddUTF8Font</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> fileStr <span class="token builtin">string</span><span class="token keyword">var</span> txtStr <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token keyword">var</span> err <span class="token builtin">error</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddUTF8Font</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">FontFile</span><span class="token punctuation">(</span><span class="token string">"DejaVuSansCondensed.ttf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddUTF8Font</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">FontFile</span><span class="token punctuation">(</span><span class="token string">"DejaVuSansCondensed-Bold.ttf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddUTF8Font</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">FontFile</span><span class="token punctuation">(</span><span class="token string">"DejaVuSansCondensed-Oblique.ttf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddUTF8Font</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">"BI"</span><span class="token punctuation">,</span> example<span class="token punctuation">.</span><span class="token function">FontFile</span><span class="token punctuation">(</span><span class="token string">"DejaVuSansCondensed-BoldOblique.ttf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>fileStr <span class="token operator">=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_AddUTF8Font"</span><span class="token punctuation">)</span>txtStr<span class="token punctuation">,</span> err <span class="token operator">=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">TextFile</span><span class="token punctuation">(</span><span class="token string">"utf-8test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Text in different languages :"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>txtStr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Ln</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>txtStr<span class="token punctuation">,</span> err <span class="token operator">=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">TextFile</span><span class="token punctuation">(</span><span class="token string">"utf-8test2.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">"BI"</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"Greek text with alignStr = \"J\":"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"dejavu"</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">MultiCell</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>txtStr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"J"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>err <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_AddUTF8Font.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何生成TrueType字体子集"><a href="#演示如何生成TrueType字体子集" class="headerlink" title="演示如何生成TrueType字体子集"></a>演示如何生成TrueType字体子集</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleUTF8CutFont demonstrates how generate a TrueType font subset.</span><span class="token keyword">func</span> <span class="token function">ExampleUTF8CutFont</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> pdfFileStr<span class="token punctuation">,</span> fullFontFileStr<span class="token punctuation">,</span> subFontFileStr <span class="token builtin">string</span><span class="token keyword">var</span> subFont<span class="token punctuation">,</span> fullFont <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token keyword">var</span> err <span class="token builtin">error</span>pdfFileStr <span class="token operator">=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_UTF8CutFont"</span><span class="token punctuation">)</span>fullFontFileStr <span class="token operator">=</span> example<span class="token punctuation">.</span><span class="token function">FontFile</span><span class="token punctuation">(</span><span class="token string">"calligra.ttf"</span><span class="token punctuation">)</span>fullFont<span class="token punctuation">,</span> err <span class="token operator">=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>fullFontFileStr<span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>subFontFileStr <span class="token operator">=</span> <span class="token string">"calligra_abcde.ttf"</span>subFont <span class="token operator">=</span> gofpdf<span class="token punctuation">.</span><span class="token function">UTF8CutFont</span><span class="token punctuation">(</span>fullFont<span class="token punctuation">,</span> <span class="token string">"abcde"</span><span class="token punctuation">)</span>err <span class="token operator">=</span> ioutil<span class="token punctuation">.</span><span class="token function">WriteFile</span><span class="token punctuation">(</span>subFontFileStr<span class="token punctuation">,</span> subFont<span class="token punctuation">,</span> <span class="token number">0600</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>y <span class="token operator">:=</span> <span class="token number">24.0</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>fontHt <span class="token operator">:=</span> <span class="token number">17.0</span>lineHt <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">PointConvert</span><span class="token punctuation">(</span>fontHt<span class="token punctuation">)</span>write <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">24.0</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">200.0</span><span class="token punctuation">,</span> lineHt<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>format<span class="token punctuation">,</span> args<span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">)</span>y <span class="token operator">+=</span> lineHt<span class="token punctuation">&#125;</span>writeSize <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>fileStr <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">var</span> info os<span class="token punctuation">.</span>FileInfo<span class="token keyword">var</span> err <span class="token builtin">error</span>info<span class="token punctuation">,</span> err <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">Stat</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"%6d: size of %s"</span><span class="token punctuation">,</span> info<span class="token punctuation">.</span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddUTF8Font</span><span class="token punctuation">(</span><span class="token string">"calligra"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> subFontFileStr<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"calligra"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontHt<span class="token punctuation">)</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"cabbed"</span><span class="token punctuation">)</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"vwxyz"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"courier"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontHt<span class="token punctuation">)</span><span class="token function">writeSize</span><span class="token punctuation">(</span>fullFontFileStr<span class="token punctuation">)</span><span class="token function">writeSize</span><span class="token punctuation">(</span>subFontFileStr<span class="token punctuation">)</span>err <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>pdfFileStr<span class="token punctuation">)</span>os<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>subFontFileStr<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> pdfFileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_UTF8CutFont.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示如何调整文本下划线的厚度"><a href="#演示如何调整文本下划线的厚度" class="headerlink" title="演示如何调整文本下划线的厚度"></a>演示如何调整文本下划线的厚度</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetUnderlineThickness demonstrates how to adjust the text</span><span class="token comment">// underline thickness.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetUnderlineThickness</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// 210mm x 297mm</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetUnderlineThickness</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Thin underline"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetUnderlineThickness</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Normal underline"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetUnderlineThickness</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Thicker underline"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_UnderlineThickness"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_UnderlineThickness.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示删除的文本"><a href="#演示删除的文本" class="headerlink" title="演示删除的文本"></a>演示删除的文本</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_Cell_strikeout demonstrates striked-out text</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_Cell_strikeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// 210mm x 297mm</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> fontSize <span class="token operator">:=</span> <span class="token number">4</span><span class="token punctuation">;</span> fontSize <span class="token operator">&lt;</span> <span class="token number">40</span><span class="token punctuation">;</span> fontSize <span class="token operator">+=</span> <span class="token number">10</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">"S"</span><span class="token punctuation">,</span> <span class="token function">float64</span><span class="token punctuation">(</span>fontSize<span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">float64</span><span class="token punctuation">(</span>fontSize<span class="token punctuation">)</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_Cell_strikeout"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_Cell_strikeout.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="演示pdf中的呈现模式"><a href="#演示pdf中的呈现模式" class="headerlink" title="演示pdf中的呈现模式"></a>演示pdf中的呈现模式</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetTextRenderingMode demonstrates rendering modes in PDFs.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetTextRenderingMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">// 210mm x 297mm</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>fontSz <span class="token operator">:=</span> <span class="token function">float64</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>lineSz <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">PointToUnitConvert</span><span class="token punctuation">(</span>fontSz<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Times"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> fontSz<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>lineSz<span class="token punctuation">,</span> <span class="token string">"This document demonstrates various modes of text rendering. Search for \"Mode 3\" "</span><span class="token operator">+</span><span class="token string">"to locate text that has been rendered invisibly. This selection can be copied "</span><span class="token operator">+</span><span class="token string">"into the clipboard as usual and is useful for overlaying onto non-textual elements such "</span><span class="token operator">+</span><span class="token string">"as images to make them searchable.\n\n"</span><span class="token punctuation">)</span>fontSz <span class="token operator">=</span> <span class="token function">float64</span><span class="token punctuation">(</span><span class="token number">125</span><span class="token punctuation">)</span>lineSz <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">PointToUnitConvert</span><span class="token punctuation">(</span>fontSz<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFontSize</span><span class="token punctuation">(</span>fontSz<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextColor</span><span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetDrawColor</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span>write <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>mode <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetTextRenderingMode</span><span class="token punctuation">(</span>mode<span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">CellFormat</span><span class="token punctuation">(</span><span class="token number">210</span><span class="token punctuation">,</span> lineSz<span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Mode %d"</span><span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> mode <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> mode <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> mode<span class="token operator">++</span> <span class="token punctuation">&#123;</span><span class="token function">write</span><span class="token punctuation">(</span>mode<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_TextRenderingMode"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_TextRenderingMode.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="在顶层演示了在pdf中嵌入文件"><a href="#在顶层演示了在pdf中嵌入文件" class="headerlink" title="在顶层演示了在pdf中嵌入文件"></a>在顶层演示了在pdf中嵌入文件</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token comment">// ExampleFpdf_SetTextRenderingMode demonstrates embedding files in PDFs,</span><span class="token comment">// at the top-level.</span><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetAttachments</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token comment">// Global attachments</span>file<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"grid.go"</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>a1 <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span>Attachment<span class="token punctuation">&#123;</span>Content<span class="token punctuation">:</span> file<span class="token punctuation">,</span> Filename<span class="token punctuation">:</span> <span class="token string">"grid.go"</span><span class="token punctuation">&#125;</span>file<span class="token punctuation">,</span> err <span class="token operator">=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"LICENSE"</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>a2 <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span>Attachment<span class="token punctuation">&#123;</span>Content<span class="token punctuation">:</span> file<span class="token punctuation">,</span> Filename<span class="token punctuation">:</span> <span class="token string">"License"</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">SetAttachments</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>gofpdf<span class="token punctuation">.</span>Attachment<span class="token punctuation">&#123;</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_EmbeddedFiles"</span><span class="token punctuation">)</span>err <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_EmbeddedFiles.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="添加附件注释"><a href="#添加附件注释" class="headerlink" title="添加附件注释"></a>添加附件注释</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">ExampleFpdf_AddAttachmentAnnotation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"mm"</span><span class="token punctuation">,</span> <span class="token string">"A4"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetFont</span><span class="token punctuation">(</span><span class="token string">"Arial"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// Per page attachment</span>file<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"grid.go"</span><span class="token punctuation">)</span><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>pdf<span class="token punctuation">.</span><span class="token function">SetError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#125;</span>a <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span>Attachment<span class="token punctuation">&#123;</span>Content<span class="token punctuation">:</span> file<span class="token punctuation">,</span> Filename<span class="token punctuation">:</span> <span class="token string">"grid.go"</span><span class="token punctuation">,</span> Description<span class="token punctuation">:</span> <span class="token string">"Some amazing code !"</span><span class="token punctuation">&#125;</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddAttachmentAnnotation</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">"A first link"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetXY</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Rect</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddAttachmentAnnotation</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">"A second link (no copy)"</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_FileAnnotations"</span><span class="token punctuation">)</span>err <span class="token operator">=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_FileAnnotations.pdf</span><span class="token punctuation">&#125;</span></code></pre><h2 id="设置修改日期"><a href="#设置修改日期" class="headerlink" title="设置修改日期"></a>设置修改日期</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">ExampleFpdf_SetModificationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// pdfinfo (from http://www.xpdfreader.com) reports the following for this example :</span><span class="token comment">// ~ pdfinfo -box pdf/Fpdf_PageBox.pdf</span><span class="token comment">// Producer:       FPDF 1.7</span><span class="token comment">// CreationDate:   Sat Jan  1 00:00:00 2000</span><span class="token comment">// ModDate:        Sun Jan  2 10:22:30 2000</span>pdf <span class="token operator">:=</span> gofpdf<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">AddPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>pdf<span class="token punctuation">.</span><span class="token function">SetModificationDate</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>UTC<span class="token punctuation">)</span><span class="token punctuation">)</span>fileStr <span class="token operator">:=</span> example<span class="token punctuation">.</span><span class="token function">Filename</span><span class="token punctuation">(</span><span class="token string">"Fpdf_SetModificationDate"</span><span class="token punctuation">)</span>err <span class="token operator">:=</span> pdf<span class="token punctuation">.</span><span class="token function">OutputFileAndClose</span><span class="token punctuation">(</span>fileStr<span class="token punctuation">)</span>example<span class="token punctuation">.</span><span class="token function">Summary</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> fileStr<span class="token punctuation">)</span><span class="token comment">// Output:</span><span class="token comment">// Successfully generated pdf/Fpdf_SetModificationDate.pdf</span><span class="token punctuation">&#125;</span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;最近在做Golang创建PDF方面的项目，一通找寻后主要定位到了两个现成的PDF库，也是网上比较流行的直接引用库，一个是&lt;a href=&quot;https://github.com/signintech/gopdf&quot;&gt;gopdf&lt;/a&gt;，另一个是&lt;a href=&quot;https://</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Go" scheme="https://shuangdeyu.github.io/tags/Go/"/>
    
    <category term="PDF" scheme="https://shuangdeyu.github.io/tags/PDF/"/>
    
  </entry>
  
  <entry>
    <title>vue学习-小技巧记录</title>
    <link href="https://shuangdeyu.github.io/2024/01/19/vue-xue-xi-xiao-ji-qiao-ji-lu/"/>
    <id>https://shuangdeyu.github.io/2024/01/19/vue-xue-xi-xiao-ji-qiao-ji-lu/</id>
    <published>2024-01-18T16:00:00.000Z</published>
    <updated>2024-01-30T03:29:52.426Z</updated>
    
    <content type="html"><![CDATA[<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><h3 id="class和style的绑定"><a href="#class和style的绑定" class="headerlink" title="class和style的绑定"></a>class和style的绑定</h3><p>除了普通字符串之外，class和style的绑定还特别支持了对象和数组</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123; red: isRed &#125;<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>toggleRed<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    This should be red... but click me to toggle it.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">:style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123; color &#125;<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>toggleColor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    This should be green, and should toggle between green and blue on click.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>// 一般绑定<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dynamicId<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre><h2 id="字符串处理"><a href="#字符串处理" class="headerlink" title="字符串处理"></a>字符串处理</h2><h3 id="字符串反转"><a href="#字符串反转" class="headerlink" title="字符串反转"></a>字符串反转</h3><p><strong>message.value.split(‘’).reverse().join(‘’)</strong></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span><span class="token keyword">function</span> <span class="token function">reverseMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  message<span class="token punctuation">.</span>value <span class="token operator">=</span> message<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></code></pre><p>如果是数组反转，直接调用 reverse() 就行了</p><h2 id="数组处理"><a href="#数组处理" class="headerlink" title="数组处理"></a>数组处理</h2><h3 id="数组过滤"><a href="#数组过滤" class="headerlink" title="数组过滤"></a>数组过滤</h3><p>对数组 data 中的每个对象 row，检查其属性值是否包含过滤关键字 filterKey，如果包含，则保留该对象，最终得到一个经过过滤的新数组</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>filterKey<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="根据前缀字符串过滤数组"><a href="#根据前缀字符串过滤数组" class="headerlink" title="根据前缀字符串过滤数组"></a>根据前缀字符串过滤数组</h3><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> prefix <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token keyword">const</span> filteredNames <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span>  names<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token operator">=></span>    n<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>prefix<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="数组排序"><a href="#数组排序" class="headerlink" title="数组排序"></a>数组排序</h3><p>对数组 data 中的对象根据指定的属性 key 进行排序，排序顺序由变量 order 控制。并且通过 slice 创建了一个原数组的浅拷贝，以免改变原始数据</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">data <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  a <span class="token operator">=</span> a<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>  b <span class="token operator">=</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">===</span> b <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> a <span class="token operator">></span> b <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> order<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>[持续补充中……]</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;基础&quot;&gt;&lt;a href=&quot;#基础&quot; class=&quot;headerlink&quot; title=&quot;基础&quot;&gt;&lt;/a&gt;基础&lt;/h2&gt;&lt;h3 id=&quot;class和style的绑定&quot;&gt;&lt;a href=&quot;#class和style的绑定&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="vue" scheme="https://shuangdeyu.github.io/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>vue开发文档查找手册</title>
    <link href="https://shuangdeyu.github.io/2024/01/11/vue-kai-fa-wen-dang-cha-zhao-shou-ce/"/>
    <id>https://shuangdeyu.github.io/2024/01/11/vue-kai-fa-wen-dang-cha-zhao-shou-ce/</id>
    <published>2024-01-10T16:00:00.000Z</published>
    <updated>2024-01-18T03:01:49.372Z</updated>
    
    <content type="html"><![CDATA[<p>对于前端不是很熟悉，刚开始学vue很多概念还是很模糊的，官方文档的一些前端术语对于我这个后端来说第一世间不是很能理解</p><p>所以把官方文档里面的目录整理了下，每个条目下都有哪些内容，当做一个查找手册，至少遇到问题能够快速在文档中进行定位</p><blockquote><p>官网地址：<a href="https://cn.vuejs.org/guide/introduction.html">https://cn.vuejs.org/guide/introduction.html</a></p></blockquote><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><h3 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h3><p>模板（HTML）的相关操作</p><ul><li>动态文本插值：<code>&lt;span&gt;Message: &#123;&#123; msg &#125;&#125;&lt;/span&gt;</code></li><li>v-html 指令：插入一个html，而不是纯文本</li><li>v-bind 指令：将html中的元素的值跟变量进行动态绑定，比如给 div 动态设置 class 操作</li><li>指令 v-： 带有 v- 前缀的，见<a href="https://cn.vuejs.org/api/built-in-directives.html">内置指令</a>，有各种功能<ul><li>有些能简写，比如用 :、@ 就行</li><li>还能绑定动态属性，比如： <code>&lt;a v-on:[eventName]=&quot;doSomething&quot;&gt; ... &lt;/a&gt;</code></li></ul></li><li>数据绑定支持 js 表达式写法：比如<code>&#123;&#123; number + 1 &#125;&#125;</code>，但不支持复杂的写法</li></ul><h3 id="响应式基础"><a href="#响应式基础" class="headerlink" title="响应式基础"></a>响应式基础</h3><p>指自动追踪数据变化的功能，更新机制是 <strong>每当数据有变化时才会重现渲染DOM</strong></p><ul><li>ref()：最常用的<ul><li>Ref 可以持有任何类型的值，包括深层嵌套的对象、数组或者 JavaScript 内置的数据结构</li><li>Ref 会使它的值具有深层响应性。这意味着即使改变嵌套对象或数组时，变化也会被检测到</li></ul></li><li><code>&lt;script setup&gt;</code>：</li><li>reactive()：另一种响应式，是对象本身具有响应性<ul><li>返回的是一个原始对象的 Proxy(代理)，它和原始对象是不相等</li><li>局限性多</li></ul></li><li>ref 解包细节</li></ul><h3 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h3><p>是一种在模板中声明数据的衍生属性的方式</p><p>将复杂逻辑放在 script 中计算输出，然后直接在模板中引用，不用在模板中进行复杂逻辑计算</p><ul><li>计算属性缓存 vs 方法<ul><li><strong>计算属性值会基于其响应式依赖被缓存</strong>。一个计算属性仅会在其响应式依赖更新时才重新计算</li><li>方法调用总是会在重渲染发生时再次执行函数</li></ul></li><li>可写计算属性：计算属性默认是只读的<ul><li>可以通过同时提供 getter 和 setter 来支持计算</li></ul></li></ul><h3 id="类与样式绑定"><a href="#类与样式绑定" class="headerlink" title="类与样式绑定"></a>类与样式绑定</h3><p>讲述的是html中 class 的绑定和 css 样式的一些动态操作</p><p>Vue 专门为 class 和 style 的 v-bind 用法提供了特殊的功能增强。除了字符串外，表达式的值也可以是对象或数组</p><ul><li>绑定html class<ul><li>绑定对象</li><li>绑定数组</li><li>在组件上使用绑定</li></ul></li><li>绑定内联样式 style<ul><li>绑定对象</li><li>绑定数组</li></ul></li></ul><h3 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h3><p>条件运算</p><ul><li>v-if</li><li>v-else</li><li>v-else-if</li><li><code>&lt;template&gt;</code> 上的 v-if<ul><li>可以同时切换template包裹的多个元素</li></ul></li><li>v-show</li><li>v-if vs. v-show</li></ul><h3 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h3><p>比如后端返回列表，前端用这个渲染</p><ul><li>v-for</li><li>v-for与对象</li><li><code>&lt;template&gt;</code> 上的 v-for</li><li>v-if 和 v-for</li><li>通过key管理状态<ul><li>key是内置的特殊指令</li><li>类似于id，根据key的变化顺序重新排列元素</li><li>推荐在任何可行的时候为 v-for 提供一个 key</li></ul></li><li>组件上使用v-for</li><li>数组变化侦测<ul><li>Vue 能够侦听响应式数组的变更方法，并在它们被调用时触发相关的更新</li></ul></li><li>展示过滤或排序后的结果</li></ul><h3 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h3><ul><li>监听事件：v-on:[触发动作] 指令 (简写为 @)</li><li>内联事件处理器：通常用于简单场景</li><li>方法事件处理器：v-on 也可以接受一个方法名或对某个方法的调用</li><li>在内联处理器中调用方法</li><li>在内联事件处理器中访问事件参数：在内联事件处理器中访问原生 DOM 事件</li><li>事件修饰符：修饰符是用 . 表示的指令后缀，比如 @click.stop</li><li>按键修饰符：监听按了哪个按键</li><li>鼠标按键修饰符</li></ul><h3 id="表单输入绑定"><a href="#表单输入绑定" class="headerlink" title="表单输入绑定"></a>表单输入绑定</h3><p>在前端处理表单时，我们常常需要将表单输入框的内容同步给 JavaScript 中相应的变量。手动连接值绑定和更改事件监听器可能会很麻烦，<code>v-model</code> 指令帮我们简化了这一步骤</p><ul><li>基本用法<ul><li>文本</li><li>多行文本</li><li>复选框</li><li>单选按钮</li><li>选择器</li></ul></li><li>值绑定<ul><li>复选框</li><li>单选按钮</li><li>选择器选项</li></ul></li><li>修饰符<ul><li>.lazy</li><li>.number</li><li>.trim</li></ul></li><li>组件上的 v-model</li></ul><h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><ul><li>注册周期钩子<ul><li>举例来说，onMounted 钩子可以用来在组件完成初始渲染并创建 DOM 节点后运行代码</li></ul></li><li>生命周期图示</li></ul><p>还有其他一些钩子，会在实例生命周期的不同阶段被调用，最常用的是 onMounted、onUpdated 和 onUnmounted。所有生命周期钩子的完整参考及其用法请参考 <a href="https://cn.vuejs.org/api/composition-api-lifecycle.html">API 索引</a></p><h3 id="侦听器"><a href="#侦听器" class="headerlink" title="侦听器"></a>侦听器</h3><p>计算属性允许我们声明性地计算衍生值。然而在有些情况下，我们需要在状态变化时执行一些“副作用”：例如更改 DOM，或是根据异步操作的结果去修改另一处的状态。</p><p>在组合式 API 中，我们可以使用 watch 函数在每次响应式状态发生变化时触发回调函数</p><ul><li>侦听数据源类型</li><li>深层侦听器：deep: true</li><li>即时回调的侦听器：immediate: true</li><li>watchEffect()</li><li>回调的触发时机<ul><li>默认情况下，用户创建的侦听器回调，都会在 Vue 组件更新之前被调用</li><li>想在侦听器回调中能访问被 Vue 更新之后的 DOM，你需要指明 flush: ‘post’ 选项</li></ul></li><li>停止侦听器<ul><li>如果用异步回调创建一个侦听器，那么它不会绑定到当前组件上，你必须手动停止它，以防内存泄漏</li></ul></li></ul><h3 id="模板引用"><a href="#模板引用" class="headerlink" title="模板引用"></a>模板引用</h3><p>ref 是一个特殊的 attribute，和 v-for 章节中提到的 key 类似。它允许我们在一个特定的 DOM 元素或子组件实例被挂载后，获得对它的直接引用</p><ul><li>访问模板引用​</li><li>v-for 中的模板引用</li><li>函数模板引用<ul><li>除了使用字符串值作名字，ref attribute 还可以绑定为一个函数，会在每次组件更新时都被调用</li></ul></li><li>组件上的ref</li></ul><h3 id="组件基础"><a href="#组件基础" class="headerlink" title="组件基础"></a>组件基础</h3><p>组件允许我们将 UI 划分为独立的、可重用的部分，并且可以对每个部分进行单独的思考。在实际应用中，组件常常被组织成层层嵌套的树状结构</p><ul><li>定义一个组件</li><li>使用组件</li><li>传递 props<ul><li>Props 是一种特别的 attributes，你可以在组件上声明注册</li><li>当一个 prop 被注册后，可以像这样以自定义 attribute 的形式传递数据给它</li><li>以博客文章举例</li></ul></li><li>监听事件</li><li>通过插槽来分配内容<ul><li><code>&lt;slot /&gt;</code>：占位符，父组件传递进来的内容就会渲染在这里</li></ul></li><li>动态组件：有些场景会需要在两个组件间来回切换，比如 Tab 界面<ul><li><code>&lt;component&gt;</code> 元素和特殊的 <code>is</code> attribute</li></ul></li><li>DOM内模板解析注意事项<ul><li>大小写区分：需要转换为相应等价的 kebab-case (短横线连字符) 形式</li><li>闭合标签：必须显式地写出关闭标签</li><li>元素位置限制</li></ul></li></ul><h2 id="深入组件"><a href="#深入组件" class="headerlink" title="深入组件"></a>深入组件</h2><h3 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h3><p>组件注册有两种方式：全局注册和局部注册</p><ul><li>全局注册<ul><li><code>.component()</code> 方法</li></ul></li><li>局部注册</li><li>组件名格式<ul><li>使用 PascalCase 作为组件名的注册格式</li></ul></li></ul><h3 id="Props"><a href="#Props" class="headerlink" title="Props"></a>Props</h3><ul><li>Props声明<ul><li>使用 <code>&lt;script setup&gt;</code> 的单文件组件中：使用 <code>defineProps()</code> 宏来声明</li><li>没有使用 <code>&lt;script setup&gt;</code> 的组件中：使用 <code>props</code> 选项来声明</li></ul></li><li>传递prop的细节<ul><li>Prop名字格式：<strong>camelCase</strong> 驼峰式，传递时写为 <strong>kebab-case</strong> 形式</li><li>静态VS动态 Prop</li><li>传递不同的值类型</li><li>使用一个对象绑定多个 prop</li></ul></li><li>单向数据流<ul><li>props 都遵循着单向绑定原则</li><li>更改对象 / 数组类型的 props，对象和数组是按引用传递，可以改值，但VUE中不推荐改</li></ul></li><li>Prop 校验：即参数校验</li><li>Boolean 类型转换</li></ul><h3 id="组件事件"><a href="#组件事件" class="headerlink" title="组件事件"></a>组件事件</h3><ul><li>触发与监听事件<ul><li>使用 <code>$emit</code> 方法触发自定义事件</li><li>父组件可以通过 <code>v-on</code> (缩写为 @) 来监听事件</li><li>组件的事件监听器也支持 <code>.once</code> 修饰符</li></ul></li><li>事件参数<ul><li>所有传入 $emit() 的额外参数都会被直接传向监听器</li></ul></li><li>声明触发的事件<ul><li>组件可以显式地通过 defineEmits() 宏来声明它要触发的事件</li></ul></li><li>事件校验</li></ul><h3 id="组件v-model"><a href="#组件v-model" class="headerlink" title="组件v-model"></a>组件v-model</h3><p>v-model 可以在组件上使用以实现双向绑定</p><ul><li>v-model 的参数</li><li>多个 v-model 绑定</li><li>处理 v-model 修饰符<ul><li>带参数的 v-model 修饰符</li></ul></li></ul><h3 id="透传-Attributes"><a href="#透传-Attributes" class="headerlink" title="透传 Attributes"></a>透传 Attributes</h3><p>“透传 attribute”指的是传递给一个组件，却没有被该组件声明为 props 或 emits 的 attribute 或者 v-on 事件监听器。最常见的例子就是 class、style 和 id</p><ul><li>Attributes 继承<ul><li>对 class 和 style 的合并</li><li>v-on 监听器继承</li><li>深层组件继承</li></ul></li><li>禁用属性继承</li><li>多根节点的Attributes继承</li><li>在 JavaScript 中访问透传 Attributes</li></ul><h3 id="插槽-Slots"><a href="#插槽-Slots" class="headerlink" title="插槽 Slots"></a>插槽 Slots</h3><ul><li>插槽内容与出口<ul><li><code>&lt;slot&gt;</code> 元素是一个插槽出口 (slot outlet)，标示了父元素提供的插槽内容 (slot content) 将在哪里被渲染</li></ul></li><li>渲染作用域</li><li>默认内容：可以为插槽指定默认内容</li><li>具名插槽</li><li>动态插槽名：v-slot</li><li>作用域插槽<ul><li>具名作用域插槽</li><li>高级列表组件示例</li><li>无渲染组件</li></ul></li></ul><h3 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h3><ul><li>Prop 逐级透传问题<ul><li>provide、inject</li><li>一个父组件相对于其所有的后代组件，会作为依赖提供者。任何后代的组件树，无论层级有多深，都可以注入由父组件提供给整条链路的依赖</li></ul></li><li>Provide (提供)：为组件后代提供数据</li><li>应用层 Provide</li><li>Inject (注入)<ul><li>注入默认值</li></ul></li><li>和响应式数据配合使用<ul><li>如果你想确保提供的数据不能被注入方的组件更改，你可以使用 readonly() 来包装提供的值</li></ul></li><li>使用 Symbol 作注入名</li></ul><h3 id="异步组件"><a href="#异步组件" class="headerlink" title="异步组件"></a>异步组件</h3><p>在大型项目中，我们可能需要拆分应用为更小的块，并仅在需要时再从服务器加载相关组件</p><ul><li>基本用法：<code>defineAsyncComponent</code></li><li>加载与错误状态</li><li>搭配 <a href="https://cn.vuejs.org/guide/built-ins/suspense.html">Suspense</a> 使用</li></ul><h2 id="逻辑复用"><a href="#逻辑复用" class="headerlink" title="逻辑复用"></a>逻辑复用</h2><h3 id="组合式函数"><a href="#组合式函数" class="headerlink" title="组合式函数"></a>组合式函数</h3><p>是一个利用 Vue 的组合式 API 来封装和复用<strong>有状态逻辑</strong>的函数</p><ul><li>鼠标跟踪器示例</li><li>异步状态示例<ul><li>接收响应式状态：<code>watchEffect()</code> 、 <code>toValue()</code></li></ul></li><li>约定和最佳实践<ul><li>命名、输入参数、返回值、副作用、使用限制</li></ul></li><li>通过抽取组合式函数改善代码结构</li><li>在选项式API中使用组合式函数</li><li>与其他模式的比较</li><li>延伸阅读<ul><li>深入响应式原理：理解 Vue 响应性系统的底层细节</li><li>状态管理：多个组件间共享状态的管理模式</li><li>测试组合式函数：组合式函数的单元测试技巧</li><li>VueUse：一个日益增长的 Vue 组合式函数集合。源代码本身就是一份不错的学习资料</li></ul></li></ul><h3 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h3><p>除了 Vue 内置的一系列指令 (比如 v-model 或 v-show) 之外，Vue 还允许你注册自定义的指令</p><p>在 <code>&lt;script setup&gt;</code> 中，任何以 v 开头的驼峰式命名的变量都可以被用作一个自定义指令</p><p>在没有使用 <code>&lt;script setup&gt;</code> 的情况下，自定义指令需要通过 directives 选项注册</p><ul><li>指令钩子</li><li>简化形式</li><li>对象字面量</li><li>在组件上使用</li></ul><h3 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h3><p>插件 (Plugins) 是一种能为 Vue 添加全局功能的工具代码</p><ul><li>编写一个插件</li></ul><h2 id="内置组件"><a href="#内置组件" class="headerlink" title="内置组件"></a>内置组件</h2><h3 id="Transition"><a href="#Transition" class="headerlink" title="Transition"></a>Transition</h3><p>Vue 提供了两个内置组件，可以帮助你制作基于状态变化的过渡和动画，见以下两个组件：</p><ul><li><code>&lt;Transition&gt;</code> 组件</li><li>基于CSS的过渡效果</li><li>JavaScript 钩子</li><li>可复用过渡效果</li><li>出现时过渡</li><li>元素间过渡</li><li>过渡模式</li><li>组件间过渡</li><li>动态过渡</li></ul><h3 id="TransitionGroup"><a href="#TransitionGroup" class="headerlink" title="TransitionGroup"></a>TransitionGroup</h3><p>用于对 v-for 列表中的元素或组件的插入、移除和顺序改变添加动画效果</p><ul><li>和 <code>&lt;Transition&gt;</code> 的区别</li><li>进入/离开动画</li><li>移动动画</li><li>渐进延迟列表动画</li></ul><h3 id="KeepAlive"><a href="#KeepAlive" class="headerlink" title="KeepAlive"></a>KeepAlive</h3><p>它的功能是在多个组件间动态切换时缓存被移除的组件实例</p><ul><li>基本使用</li><li>包含/排除</li><li>最大缓存实例数</li><li>缓存实例的生命周期</li></ul><h3 id="Teleport"><a href="#Teleport" class="headerlink" title="Teleport"></a>Teleport</h3><p>它可以将一个组件内部的一部分模板“传送”到该组件的 DOM 结构外层的位置去</p><p>modal弹窗可以使用这个组件实现</p><ul><li>基本用法</li><li>搭配组件使用</li><li>禁用Teleport</li><li>多个Teleport共享目标</li></ul><h3 id="Suspense"><a href="#Suspense" class="headerlink" title="Suspense"></a>Suspense</h3><p>是一个实验性功能</p><p>用来在组件树中协调对异步依赖的处理。它让我们可以在组件树上层等待下层的多个嵌套异步依赖项解析完成，并可以在等待时渲染一个加载状态</p><ul><li>异步依赖</li><li>加载中状态</li><li>事件</li><li>错误处理</li><li>和其他组件结合</li></ul><h2 id="应用规模化"><a href="#应用规模化" class="headerlink" title="应用规模化"></a>应用规模化</h2><h3 id="单文件组件"><a href="#单文件组件" class="headerlink" title="单文件组件"></a>单文件组件</h3><p>我们能够将一个 Vue 组件的模板、逻辑与样式封装在单个文件中，叫做单文件组件，简称SFC</p><ul><li>为什么要使用SFC</li><li>SFC是如何工作的</li><li>如何看待关注点分离</li></ul><h3 id="工具链"><a href="#工具链" class="headerlink" title="工具链"></a>工具链</h3><p>介绍Vue相关的插件，脚手架，格式化等工具链</p><ul><li><p>项目脚手架</p><ul><li>Vite：优先选项</li><li>Vue CLI</li></ul></li><li><p>代码规范</p><h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3></li><li><p>客户端vs服务端路由</p></li><li><p>官方路由</p></li><li><p>从头开始实现一个简单的路由</p></li></ul><h3 id="状态管理"><a href="#状态管理" class="headerlink" title="状态管理"></a>状态管理</h3><ul><li>用响应式 API 做简单状态管理</li><li>SSR相关细节</li><li>Pinia</li></ul><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><h3 id="服务端渲染-SSR"><a href="#服务端渲染-SSR" class="headerlink" title="服务端渲染(SSR)"></a>服务端渲染(SSR)</h3><ul><li>总览<ul><li>什么是SSR</li><li>为什么要用SSR</li><li>SSR vs. SSG</li></ul></li><li>基础教程<ul><li>渲染一个应用</li><li>客户端激活</li><li>代码结构</li></ul></li><li>更通用的解决方案<ul><li>Nuxt</li><li>Quasar</li><li>Vite SSR</li></ul></li><li>书写SSR友好的代码<ul><li>服务端响应性</li><li>组件生命周期钩子</li><li>访问平台特有API</li><li>跨请求状态污染</li><li>激活不匹配</li><li>自定义指令</li><li>Teleports</li></ul></li></ul><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="生产部署"><a href="#生产部署" class="headerlink" title="生产部署"></a>生产部署</h3><ul><li>开发环境 vs. 生产环境</li><li>不使用构建工具</li><li>使用构建工具</li><li>追踪运行时错误</li></ul><h3 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h3><ul><li>分析选项</li><li>页面加载优化<ul><li>选用正确的架构</li><li>包体积与 Tree-shaking 优化</li><li>代码分割</li></ul></li><li>更新优化<ul><li>Props 稳定性</li><li>v-once</li><li>v-memo</li><li>计算属性稳定性</li></ul></li><li>通用优化<ul><li>大型虚拟列表</li><li>减少大型不可变数据的响应性开销</li><li>避免不必要的组件抽象</li></ul></li></ul><h3 id="无障碍访问"><a href="#无障碍访问" class="headerlink" title="无障碍访问"></a>无障碍访问</h3><ul><li>跳过链接</li><li>内容结构</li><li>语义化表单</li><li>规范</li><li>资源</li></ul><h3 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h3><ul><li>首要规则：不要使用无法信赖的模板</li><li>Vue 自身的安全机制</li><li>潜在的危险<ul><li>注入 HTML</li><li>URL 注入</li><li>样式注入</li><li>JavaScript 注入</li></ul></li><li>最佳实践</li><li>后端协调</li><li>服务端渲染 (SSR)</li></ul><h2 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h2><h2 id="进阶主题"><a href="#进阶主题" class="headerlink" title="进阶主题"></a>进阶主题</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;对于前端不是很熟悉，刚开始学vue很多概念还是很模糊的，官方文档的一些前端术语对于我这个后端来说第一世间不是很能理解&lt;/p&gt;
&lt;p&gt;所以把官方文档里面的目录整理了下，每个条目下都有哪些内容，当做一个查找手册，至少遇到问题能够快速在文档中进行定位&lt;/p&gt;
&lt;blockquot</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="vue" scheme="https://shuangdeyu.github.io/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>年会不能停</title>
    <link href="https://shuangdeyu.github.io/2024/01/10/nian-hui-bu-neng-ting/"/>
    <id>https://shuangdeyu.github.io/2024/01/10/nian-hui-bu-neng-ting/</id>
    <published>2024-01-09T16:00:00.000Z</published>
    <updated>2024-01-11T06:54:26.923Z</updated>
    
    <content type="html"><![CDATA[<p>这部电影真的值得，当从电影出来的时候，脑子里想法很多，心想今天一定要为这部电影写点什么，无奈胸中无墨，一坐到电脑前却什么也写不出来，就简单说两点吧</p><p>因为现实题材的原因，它天然就容易引起人的共鸣，所谓好电影大概就是如此之一吧，源自生活，贴近生活。有笑有哭，不尬煽，不牵强，一切水到渠成，看得人特别过瘾，意犹未尽</p><p>我觉得喜剧的内核就该是批判，不然笑过了，然后呢，什么也没有记住，什么也没有得到，这是空虚的，这部电影则当得起一声优秀喜剧片的夸奖，笑料当中不断穿插批判，圆融自洽</p><p>这部电影的核心我觉得可以用两个成语概括：踏踏实实，脚踏实地，其实两者意思相似，年会不能停，奋斗不能息，还得是踏踏实实打工啊，别整虚的</p><p>最后，下面这首歌浓缩了整部电影的精华思想，当然，也是电影年会上的压轴曲目，献给大家，献给广大打工人，去获得一丝慰藉吧！</p><blockquote><p>“我的未来不是梦，我认真地过每一分钟，</p><p>我的未来不是梦，我的心跟着希望在动。</p><p>我的未来不是梦，我认真地过每一分钟，</p><p>我的未来不是梦，我的心跟着希望在动。</p><p>跟着希望在动。”</p><hr><p>“你是不是像我在裁员中忐忑，守着岗位加班加点地工作。</p><p>你是不是像我就算每天背锅，也放不下五险一金的枷锁。</p><p>你是不是像我整体幻想能够，不用再看上司的脸色生活。</p><p>你是不是像我只会懦弱退缩，面对不公就应该打破沉默。”</p><hr><p>“我是马杰克，不是Magic，在K8待了几年没涨钱也没尊严，</p><p>落个头痛失眠，身体一年不如一年，</p><p>我干得兢兢业业，上司在莺莺燕燕。”</p><hr><p>“我是外包潘妮潘，脏活累活都我干，</p><p>功劳簿与我无关，说话从不兜弯弯，</p><p>我不算理想主义，我只想无愧自己，</p><p>油腻的酒局get off me，掌权黑手can’t beat off me。”</p><hr><p>“我是HR经理庄尼胡，标准件厂钳工胡师傅，</p><p>调任升职、没人在乎，不懂装懂、心里没谱，</p><p>啥叫颗粒度啊，整得我挺恍惚，</p><p>但是没关系，只要站对队伍、拍对马屁就保住前途。”</p><hr><p>“众和是众志成城天地人和，</p><p>其实不过是众星捧月、一唱一和。</p><p>基层人心惶惶，中层拉帮结党，</p><p>黑话说得很棒，表面风光，全是假象。”</p><hr><p>“总裁放个屁，总监翻成句，经理接到命令不能解密，</p><p>只想逃避，丢给基层，今晚OT，你做个PPT。”</p><hr><p>“做不满意，把他开除，万事大吉。</p><p>花天酒地，整体称兄道弟，</p><p>财务危机，贪污腐败不停，</p><p>自称扁平，等级像丛林。”</p><hr><p>“高楼大厦平地起，埋多少蝼蚁，</p><p>我是员工，不是奴隶，也想做我自己，</p><p>这么心酸压抑，有什么意义，</p><p>公司是一台机器，没有人性，只有目的地。”</p><hr><p>“我们不是螺丝钉，我们是人！</p><p>人！被无故泄愤。</p><p>愤！也会恨，不能忍。</p><p>生活很累，不要气馁，</p><p>有时会颓，不进则退，</p><p>但对你们我不会跪。</p><p>胡师傅说真话从不后悔！”</p><hr><p>“请相信，你的未来不是梦，你认真地过每一分钟，</p><p>你的未来不是梦，你的坚持都不会落空。</p><p>我的未来不是梦，从九八年到这一分钟，</p><p>我的未来不是梦，风雨过后盼一道彩虹。</p><p>盼一道彩虹！”</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;这部电影真的值得，当从电影出来的时候，脑子里想法很多，心想今天一定要为这部电影写点什么，无奈胸中无墨，一坐到电脑前却什么也写不出来，就简单说两点吧&lt;/p&gt;
&lt;p&gt;因为现实题材的原因，它天然就容易引起人的共鸣，所谓好电影大概就是如此之一吧，源自生活，贴近生活。有笑有哭，不尬煽</summary>
      
    
    
    
    <category term="影评" scheme="https://shuangdeyu.github.io/categories/%E5%BD%B1%E8%AF%84/"/>
    
    
    <category term="电影" scheme="https://shuangdeyu.github.io/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>2024展望</title>
    <link href="https://shuangdeyu.github.io/2024/01/04/2024-zhan-wang/"/>
    <id>https://shuangdeyu.github.io/2024/01/04/2024-zhan-wang/</id>
    <published>2024-01-03T16:00:00.000Z</published>
    <updated>2024-01-04T05:14:40.151Z</updated>
    
    <content type="html"><![CDATA[<p>又到新的一年啦，2023好赖怎样且不去说太多，总结一句话就是：不太好。</p><p>经历过裁员，艰难找工作，孩子确诊可能影响终生的病，家庭工作学习节奏紊乱……糟心事一件件，又一件件一堆堆，生活受挫了，心气磨平了，心也跟着彷徨了，好的会越来越好，差的会越来越差，我并不推崇挫折和磨难，能将他们当做踏脚石一飞冲天的无一不是人中龙凤，我自问做不到，很多人都做不到，但是他们又不会因为你不喜欢而不来找你，烦！</p><p>说来奇怪，随着这一年走到终点，新的一年在烟花声中被敲开门户，这一切，好像都烟消云散一般，随着终年的黑幕悄悄褪去，仿佛整个人都迎来了崭新的人生，充满光明。</p><p>呵，颇有点自欺欺人的味道。这里就不给自己打气喝鸡汤了，底气来源于底蕴，再多再好的黄金鸡汤都不及一点点积累的，看得见的底蕴来得踏实。</p><p>所以啊，新的一年，我没有给自己定什么高大上，必须完成的目标，这一年，我给自己的规划只有一个：积累。</p><p>厚积薄发我是相信的，当你对未来感到迷茫的时候，与其想破头皮思考怎么破局，还不如不断积累，吃过的苦总有一天会用上，哪怕只有一部分。</p><p>希望到达2024终点的时候再回过头来看，能做到无愧于自己，更无愧于家庭即可。</p><hr><p>虽说没有明确要完成的目标，但该有的计划还是要有的，积累也得有方向才对，只谈计划，不谈目标。</p><h4 id="更新：2024-01-04"><a href="#更新：2024-01-04" class="headerlink" title="更新：2024-01-04"></a>更新：2024-01-04</h4><table><thead><tr><th>时间段</th><th>要做什么</th><th>想要得到什么</th></tr></thead><tbody><tr><td>6:00 ~ 7:00</td><td>写小说/写文章</td><td>锻炼笔力，锻炼写作能力</td></tr><tr><td>上班途中</td><td>小说，短视频</td><td>娱乐放松一下</td></tr><tr><td>9:00 ~ 10:00</td><td>熟悉使用 etcd<br />学习 vue</td><td>开始正式工作前充一下电，吃饭的技能不能落下</td></tr><tr><td>12:00 ~ 12:30</td><td>学习写作技巧(小红书)，笔记</td><td>扩展写作面的知识和技巧</td></tr><tr><td>下班途中</td><td>看书<br />现重点：自闭症类</td><td>充电，扩展一下知识面</td></tr><tr><td>下班 ~ 睡前</td><td>孩子干预/学习干预方式</td><td>培养家庭干预能力，早日脱帽</td></tr></tbody></table><p>阶段总结：</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;又到新的一年啦，2023好赖怎样且不去说太多，总结一句话就是：不太好。&lt;/p&gt;
&lt;p&gt;经历过裁员，艰难找工作，孩子确诊可能影响终生的病，家庭工作学习节奏紊乱……糟心事一件件，又一件件一堆堆，生活受挫了，心气磨平了，心也跟着彷徨了，好的会越来越好，差的会越来越差，我并不推崇挫</summary>
      
    
    
    
    <category term="生活" scheme="https://shuangdeyu.github.io/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
    <category term="生活" scheme="https://shuangdeyu.github.io/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
  <entry>
    <title>docker安装etcd集群</title>
    <link href="https://shuangdeyu.github.io/2023/12/28/docker-an-zhuang-etcd-ji-qun/"/>
    <id>https://shuangdeyu.github.io/2023/12/28/docker-an-zhuang-etcd-ji-qun/</id>
    <published>2023-12-27T16:00:00.000Z</published>
    <updated>2024-01-04T02:22:18.684Z</updated>
    
    <content type="html"><![CDATA[<p>相比起手动安装etcd，使用docker进行安装简直不要太简单，快多了，还不用怎么踩坑，遂记录下。</p><blockquote><p>参考原文：<a href="https://blog.csdn.net/zuokaopuqingnian/article/details/87344662">https://blog.csdn.net/zuokaopuqingnian/article/details/87344662</a></p></blockquote><h2 id="1、环境规划"><a href="#1、环境规划" class="headerlink" title="1、环境规划"></a>1、环境规划</h2><p>本机：<strong>Apple M2 Pro</strong></p><p>提前规划要安装的 etcd IP:</p><table><thead><tr><th>容器</th><th>组网内IP</th><th>客户端通信端口</th><th>peer通信端口</th></tr></thead><tbody><tr><td>etcd0</td><td>192.167.0.168</td><td>2379</td><td>2380</td></tr><tr><td>etcd1</td><td>192.167.0.170</td><td>2479</td><td>2480</td></tr><tr><td>etcd2</td><td>192.167.0.172</td><td>2579</td><td>2580</td></tr></tbody></table><p>前提：安装好docker</p><h2 id="2、创建docker网络组"><a href="#2、创建docker网络组" class="headerlink" title="2、创建docker网络组"></a>2、创建docker网络组</h2><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker network <span class="token function">ls</span>  NETWORK ID     NAME      DRIVER    SCOPEc5bd3f92c0f7   bridge    bridge    localee5b4bb58cf5   etcdnet   bridge    local9ec6da6b44ce   host      host      locale7a8cfd630a6   none      null      local</code></pre><p>可以看到当前机器下有哪些docker网络组</p><p>要将3个etcd容器装在一台机器上，创建一个子网络，将3个容器运行在同一个网络中进行通信</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker network create <span class="token operator">--</span>subnet=192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0/16 etcdnet</code></pre><ul><li><strong>docker network create</strong>: 创建 Docker 网络的命令。</li><li><strong>–subnet=192.167.0.0/16</strong>: 指定了该网络的子网。这个网络的 IP 地址范围是从 192.167.0.0 到 192.167.255.255。这是一个用于定义网络中可用 IP 地址的 CIDR（Classless Inter-Domain Routing）表示法。</li><li><strong>etcdnet</strong>: 是为该网络指定的名称。在这个例子中，网络的名称被设置为 “etcdnet”。</li></ul><p>总体而言，这个命令创建了一个名为 “etcdnet” 的 Docker 网络，该网络的 IP 地址范围是 192.167.0.0 到 192.167.255.255。<br>容器连接到同一自定义网络的话，它们可以使用在该网络内定义的主机名或 IP 地址相互通信。这使得容器能够形成一个逻辑上隔离的网络群组。</p><p>以下来自GPT：</p><blockquote><p><strong>192.167.0.0/16</strong> 是一个 CIDR 表示法的 IP 地址范围，用于定义 Docker 自定义网络的子网。这个地址范围的选择通常基于你的网络规划和需求。<br>在 CIDR 表示法中，**/16** 表示子网掩码的长度，即在这个范围内有 16 位用于网络地址，剩下的 16 位用于主机地址。这允许定义 <strong>2^16</strong>（65536）个主机地址。<br>你可以根据你的实际需求选择一个适当的 IP 地址范围。有几个常见的私有 IP 地址范围，其中 <strong>192.168.0.0/16</strong> 是最常用的。<strong>192.167.0.0/16</strong> 是一个类似的私有地址范围，但并不像 <strong>192.168.0.0/16</strong> 一样广泛被用于家庭网络或企业网络。在你的场景中，你可以根据需要选择一个合适的范围。<br>总的来说，选择 IP 地址范围时，确保它不会与你实际网络中的其他地址冲突，而且最好遵循标准的私有地址范围，以避免与全球互联网上的公共 IP 地址冲突。</p></blockquote><h2 id="3、安装etcd"><a href="#3、安装etcd" class="headerlink" title="3、安装etcd"></a>3、安装etcd</h2><p>因为我是M1系统，ARM64架构的，所以特地找了一个ARM64架构的镜像（MAC可以通过开启Rosetta来运行AMD64架构的镜像），镜像下载地址在这：</p><blockquote><p><a href="https://quay.io/repository/coreos/etcd?tab=tags">https://quay.io/repository/coreos/etcd?tab=tags</a></p></blockquote><p>拉取镜像：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker pull quay<span class="token punctuation">.</span>io/coreos/etcd:v3<span class="token punctuation">.</span>5<span class="token punctuation">.</span>11-arm64</code></pre><p>完成后分别运行三个容器：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker run <span class="token operator">-</span>d <span class="token operator">-</span>p 2379:2379 <span class="token operator">-</span>p 2380:2380 <span class="token operator">--</span>restart=no <span class="token operator">--</span>net etcdnet <span class="token operator">--</span>ip 192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>168 <span class="token operator">--</span>name etcd0 quay<span class="token punctuation">.</span>io/coreos/etcd:v3<span class="token punctuation">.</span>5<span class="token punctuation">.</span>11-arm64 <span class="token operator">/</span>usr/local/bin/etcd <span class="token operator">--</span>name autumn-client0 <span class="token operator">-</span>advertise-client-urls http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>168:2379 <span class="token operator">-</span>listen-client-urls http:<span class="token operator">/</span><span class="token operator">/</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0:2379 <span class="token operator">-</span>initial-advertise-peer-urls http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>168:2380 <span class="token operator">-</span>listen-peer-urls http:<span class="token operator">/</span><span class="token operator">/</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0:2380 <span class="token operator">-</span>initial-cluster-token etcd-cluster <span class="token operator">-</span>initial-cluster autumn-client0=http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>168:2380<span class="token punctuation">,</span>autumn-client1=http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>170:2480<span class="token punctuation">,</span>autumn-client2=http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>172:2580 <span class="token operator">-</span>initial-cluster-state newdocker run <span class="token operator">-</span>d <span class="token operator">-</span>p 2479:2479 <span class="token operator">-</span>p 2480:2480 <span class="token operator">--</span>restart=no <span class="token operator">--</span>net etcdnet <span class="token operator">--</span>ip 192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>170 <span class="token operator">--</span>name etcd1 quay<span class="token punctuation">.</span>io/coreos/etcd:v3<span class="token punctuation">.</span>5<span class="token punctuation">.</span>11-arm64 <span class="token operator">/</span>usr/local/bin/etcd <span class="token operator">--</span>name autumn-client1 <span class="token operator">-</span>advertise-client-urls http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>170:2479 <span class="token operator">-</span>listen-client-urls http:<span class="token operator">/</span><span class="token operator">/</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0:2479 <span class="token operator">-</span>initial-advertise-peer-urls http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>170:2480 <span class="token operator">-</span>listen-peer-urls http:<span class="token operator">/</span><span class="token operator">/</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0:2480 <span class="token operator">-</span>initial-cluster-token etcd-cluster <span class="token operator">-</span>initial-cluster autumn-client0=http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>168:2380<span class="token punctuation">,</span>autumn-client1=http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>170:2480<span class="token punctuation">,</span>autumn-client2=http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>172:2580 <span class="token operator">-</span>initial-cluster-state newdocker run <span class="token operator">-</span>d <span class="token operator">-</span>p 2579:2579 <span class="token operator">-</span>p 2580:2580 <span class="token operator">--</span>restart=no <span class="token operator">--</span>net etcdnet <span class="token operator">--</span>ip 192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>172 <span class="token operator">--</span>name etcd2 quay<span class="token punctuation">.</span>io/coreos/etcd:v3<span class="token punctuation">.</span>5<span class="token punctuation">.</span>11-arm64 <span class="token operator">/</span>usr/local/bin/etcd <span class="token operator">--</span>name autumn-client2 <span class="token operator">-</span>advertise-client-urls http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>172:2579 <span class="token operator">-</span>listen-client-urls http:<span class="token operator">/</span><span class="token operator">/</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0:2579 <span class="token operator">-</span>initial-advertise-peer-urls http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>172:2580 <span class="token operator">-</span>listen-peer-urls http:<span class="token operator">/</span><span class="token operator">/</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0:2580 <span class="token operator">-</span>initial-cluster-token etcd-cluster <span class="token operator">-</span>initial-cluster autumn-client0=http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>168:2380<span class="token punctuation">,</span>autumn-client1=http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>170:2480<span class="token punctuation">,</span>autumn-client2=http:<span class="token operator">/</span><span class="token operator">/</span>192<span class="token punctuation">.</span>167<span class="token punctuation">.</span>0<span class="token punctuation">.</span>172:2580 <span class="token operator">-</span>initial-cluster-state new</code></pre><ul><li><strong>-d</strong>: 表示以“后台”或“守护进程”模式运行容器。</li><li><strong>-p 2379:2379 -p 2380:2380</strong>: 将容器的2379和2380端口映射到主机的相应端口，使得可以通过主机上的这些端口与etcd服务进行交互。</li><li><strong>–restart=no</strong>: 禁用容器的自动重启。</li><li><strong>–net etcdnet –ip 192.167.0.168</strong>: 将容器连接到名为 “etcdnet” 的自定义网络，并指定容器的IP地址为 “192.167.0.168”。</li><li><strong>–name etcd0</strong>: 为容器指定名称为 “etcd0”。</li><li><strong>quay.io/coreos/etcd</strong>: 使用的Docker镜像，其中包含了etcd服务。</li><li><strong>/usr/local/bin/etcd</strong>: 在容器内执行的etcd二进制文件的路径。</li></ul><p>接下来是一系列的etcd配置参数：</p><ul><li><strong>-advertise-client-urls <a href="http://192.167.0.168:2379/">http://192.167.0.168:2379</a></strong>: 指定etcd服务用于向客户端宣告自己的地址的URL。</li><li><strong>-listen-client-urls <a href="http://0.0.0.0:2379/">http://0.0.0.0:2379</a></strong>: 指定etcd服务监听客户端请求的地址。</li><li><strong>-initial-advertise-peer-urls <a href="http://192.167.0.168:2380/">http://192.167.0.168:2380</a></strong>: 指定etcd节点用于向集群宣告自己的地址的URL。</li><li><strong>-listen-peer-urls <a href="http://0.0.0.0:2380/">http://0.0.0.0:2380</a></strong>: 指定etcd节点监听其他节点发来的请求的地址。</li><li><strong>-initial-cluster-token etcd-cluster</strong>: 指定集群的令牌，确保不同的etcd集群之间不会发生冲突。</li><li><strong>-initial-cluster autumn-client0=<a href="http://192.167.0.168:2380,autumn-client1=http://192.167.0.170:2480,autumn-client2=http://192.167.0.172:2580">http://192.167.0.168:2380,autumn-client1=http://192.167.0.170:2480,autumn-client2=http://192.167.0.172:2580</a></strong>: 指定etcd集群的初始节点信息，包括各节点的名称和地址。</li><li><strong>-initial-cluster-state new</strong>: 指定初始集群状态为新集群。</li></ul><p>这个命令配置了一个etcd节点，它将在192.167.0.168地址上监听客户端和集群请求，并通过2379和2380端口对外提供服务。同时，它会加入一个初始集群，其中包括三个节点，分别是 “autumn-client0”、”autumn-client1” 和 “autumn-client2”，它们的地址分别是192.167.0.168、192.167.0.170和192.167.0.172。这个etcd集群使用了名为 “etcd-cluster” 的令牌，并且处于新集群的初始状态。</p><p>OK，三个都顺利跑起来了<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1703731031636-5173a9f7-4e58-4345-b420-fc27521b97b2.png#averageHue=%23f1f3f7&clientId=u90b8e4b3-6a4b-4&from=paste&height=156&id=u6f2e7d64&originHeight=312&originWidth=1662&originalType=binary&ratio=2&rotation=0&showTitle=false&size=103717&status=done&style=none&taskId=u1b3d20c9-a63f-4423-b58f-9e988f1cf95&title=&width=831" alt="image.png"></p><p>关于验证，一般是进入容器，执行etcd相关指令进行验证是否安装成功：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker exec <span class="token operator">-</span>it etcd0 <span class="token operator">/</span>bin/sh 或者 docker exec <span class="token operator">-</span>it 容器ID <span class="token operator">/</span>bin/sh执行etcdctl put mykey <span class="token string">"hello world"</span>或者etcdctl endpoint health等</code></pre><p>但是我在机器上验证却报错：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">OCI runtime exec failed: exec failed: unable to <span class="token function">start</span> container <span class="token keyword">process</span>: exec: <span class="token string">"/bin/sh"</span>: stat <span class="token operator">/</span>bin/sh: no such file or directory: unknown</code></pre><p>找了一圈，最后还是通过镜像信息发现了端倪<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1703731406346-c2530b47-5af2-4329-ab8f-1c272ea09619.png#averageHue=%23bad5db&clientId=u90b8e4b3-6a4b-4&from=drop&id=u2def32ba&originHeight=1948&originWidth=2986&originalType=binary&ratio=2&rotation=0&showTitle=false&size=897838&status=done&style=none&taskId=u6744e430-2fc9-43f2-a487-c1d64d6b0be&title=" alt="截屏2023-12-28 10.43.19.png"><br>镜像中有一个名为“<strong>distroless</strong>”的基础镜像，是一个轻量级的 Docker 镜像，它的设计目标是最小化容器的大小并提供足够的环境来运行特定类型的应用程序。<br>由于 <strong>distroless</strong> 镜像中不包含标准的 Linux 发行版，因此通常不包含常见的 shell，例如 Bash。因此，直接进入 <strong>distroless</strong> 容器可能需要使用其他方法而不是使用 <strong>docker exec</strong>。</p><p>换种方式，可以通过直接在后面添加shell指令来运行，只不过麻烦了点而已：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker exec <span class="token operator">-</span>it etcd0 etcdctl member list</code></pre><h2 id="4、安装可视化工具"><a href="#4、安装可视化工具" class="headerlink" title="4、安装可视化工具"></a>4、安装可视化工具</h2><p>这里使用的是一个界面相对丰富，功能相对完善的etcd工具：</p><blockquote><p><a href="https://github.com/gohutool/boot4go-etcdv3-browser">https://github.com/gohutool/boot4go-etcdv3-browser</a></p></blockquote><p>同样，直接使用docker安装：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker image pull joinsunsoft/etcdv3-browser</code></pre><p>运行：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker run <span class="token operator">-</span>d <span class="token operator">-</span>p 9980:80 <span class="token operator">--</span>name etcdv3-browser joinsunsoft/etcdv3-browser</code></pre><p>搞定，新增上那三个etcd连接，然后添加集合、键值进行验证，成功<br>默认登录账户密码是：ginghan/123456<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1703731900079-3fc24adf-4f96-477b-a3a3-52a4b5b47f01.png#averageHue=%23ea835b&clientId=u90b8e4b3-6a4b-4&from=paste&height=925&id=ua2f3dce2&originHeight=1850&originWidth=3590&originalType=binary&ratio=2&rotation=0&showTitle=false&size=314452&status=done&style=none&taskId=u4ca6b2ec-9e5d-42e2-83db-3bd34da0677&title=&width=1795" alt="image.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;相比起手动安装etcd，使用docker进行安装简直不要太简单，快多了，还不用怎么踩坑，遂记录下。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;参考原文：&lt;a href=&quot;https://blog.csdn.net/zuokaopuqingnian/article/detail</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="docker" scheme="https://shuangdeyu.github.io/tags/docker/"/>
    
    <category term="etcd" scheme="https://shuangdeyu.github.io/tags/etcd/"/>
    
  </entry>
  
  <entry>
    <title>Go连接Oracle，godror驱动使用记录</title>
    <link href="https://shuangdeyu.github.io/2023/12/15/go-lian-jie-oracle-godror-qu-dong-shi-yong-ji-lu/"/>
    <id>https://shuangdeyu.github.io/2023/12/15/go-lian-jie-oracle-godror-qu-dong-shi-yong-ji-lu/</id>
    <published>2023-12-14T16:00:00.000Z</published>
    <updated>2023-12-20T08:24:42.201Z</updated>
    
    <content type="html"><![CDATA[<p>Go连接Oracle数据库用到的驱动主要有三个：</p><ul><li><a href="https://github.com/sijms/go-ora">https://github.com/sijms/go-ora</a>：开箱即用，不用额外安装客户端驱动程序，真跨平台，但据说稳定性没其它几个好</li><li><a href="https://github.com/mattn/go-oci8">https://github.com/mattn/go-oci8</a>：安装驱动包本身之外，还要安装oracle客户端</li><li><a href="https://github.com/godror/godror">https://github.com/godror/godror</a>：安装驱动包本身之外，还要安装oracle客户端，跟oci8的区别是没安装oracle客户端的时候编译通过没问题，但使用会报错，而oci8是连编译的时候就会报错</li></ul><p>因为要支持Oracle(OCI)连接模式，所以采用godror驱动进行开发，比较坑的是oracle不支持macOS-arm64……</p><p>另外，OCI连接模式是指：在本地安装oracle客户端，通过客户端配置数据库的连接地址，而项目程序中连接的时候只要写配置名称即可，不用再显示编辑连接地址了，略显麻烦……</p><h2 id="1、安装godror"><a href="#1、安装godror" class="headerlink" title="1、安装godror"></a>1、安装godror</h2><p>咱先把测试程序写好</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token punctuation">(</span>    <span class="token string">"database/sql"</span>    <span class="token string">"fmt"</span>    <span class="token string">"os"</span>    <span class="token boolean">_</span> <span class="token string">"github.com/godror/godror"</span><span class="token punctuation">)</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> sql<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">"godror"</span><span class="token punctuation">,</span> <span class="token string">`user="userName" password="pass" connectString="host:port/service_name"`</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    err <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">Ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"oracle连接失败"</span><span class="token punctuation">)</span>        os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"oracle连接成功"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></code></pre><p>如果开启了go.mod的话直接同步下依赖就行了，如果没有开启的话执行以下命令安装驱动包：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">go get github<span class="token punctuation">.</span>com/godror/godror</code></pre><p>这时候运行的话会报错，别急，往下走。</p><h2 id="2、安装Oracle-Client"><a href="#2、安装Oracle-Client" class="headerlink" title="2、安装Oracle Client"></a>2、安装Oracle Client</h2><p>先放两个网址：<br><a href="https://link.juejin.cn/?target=https://www.oracle.com/database/technologies/instant-client/downloads.html">Oracle的Instant Client套件下载地址</a><br><a href="https://link.juejin.cn/?target=https://oracle.github.io/odpi/doc/installation.html%23scripted-installation">Oracle的Instant Client套件安装文档</a></p><p>这里选择linux的，我是在linux上验证成功的<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1702631823046-46e1ab84-85e3-4229-8ec3-39bc727c4be6.png#averageHue=%23b5b3b1&clientId=u06582060-e860-4&from=paste&height=1126&id=u2e5ed40e&originHeight=2252&originWidth=3600&originalType=binary&ratio=2&rotation=0&showTitle=false&size=599393&status=done&style=none&taskId=u48fabed1-76be-40bf-9f80-f081abb5209&title=&width=1800" alt="截屏2023-12-15 17.14.38.png"><br>选择基础包就行，比如：<strong>instantclient-basic-linux.x64-21.12.0.0.0dbru.zip</strong></p><p>上传到服务器上解压，最后得到client包，比如：**/usr/local/instantclient_21_12**</p><p>然后设置环境变量，让驱动能找到客户端<br>可以是这样，将 Instant Client 永久添加到运行时链接路径：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">sudo sh <span class="token operator">-</span>c <span class="token string">"echo /usr/local/instantclient_21_12 > /etc/ld.so.conf.d/oracle-instantclient.conf"</span>sudo ldconfig</code></pre><p>也可以添加到环境变量配置：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">vim ~<span class="token operator">/</span><span class="token punctuation">.</span>bashrc<span class="token operator">/</span><span class="token operator">/</span> 最后面添加这一行export LD_LIBRARY_PATH=<span class="token operator">/</span>usr/local/instantclient_21_12:<span class="token variable">$LD_LIBRARY_PATH</span></code></pre><p>这样就安装好了，再次运行程序就不会报错了，因为是后面写的文档，所以不贴运行图了</p><h2 id="3、OCI连接方式"><a href="#3、OCI连接方式" class="headerlink" title="3、OCI连接方式"></a>3、OCI连接方式</h2><p>到了最终目的，支持OCI连接方式了，其实也很简单</p><p>oracle常用的配置文件有：</p><ul><li>tnsnames.ora：定义用于建立连接的数据库别名的配置文件。</li><li>sqlnet.ora：这个比较全，可能包含有关连接故障转移、网络加密、日志记录和跟踪等功能的信息。</li></ul><p>这里使用tnsnames.ora就好，没有的话新建一个文件即可</p><p>另外注意，这两个文件必须放到oracle能调用到的地方，主要有两种方式来发现配置文件：</p><ul><li>直接设置环境变量<strong>TNS_ADMIN</strong>，这样的话配置文件随便你怎么放，通过变量指向即可</li><li>放到默认的<strong>network/admin</strong>目录下，这是oracle默认读取的目录，在下载的client下，比如：**/usr/local/instantclient_21_12/network/admin**</li></ul><p>这里简单点，直接放到默认目录下就行了，然后编辑：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">ORCLPDB1 =    <span class="token punctuation">(</span>DESCRIPTION =        <span class="token punctuation">(</span>ADDRESS = <span class="token punctuation">(</span>PROTOCOL = TCP<span class="token punctuation">)</span><span class="token punctuation">(</span>HOST = 127<span class="token punctuation">.</span>0<span class="token punctuation">.</span>0<span class="token punctuation">.</span>1<span class="token punctuation">)</span><span class="token punctuation">(</span>PORT = 1521<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">(</span>CONNECT_DATA =          <span class="token punctuation">(</span>SERVER = DEDICATED<span class="token punctuation">)</span>          <span class="token punctuation">(</span>SERVICE_NAME = ORCLPDB1<span class="token punctuation">)</span>        <span class="token punctuation">)</span>    <span class="token punctuation">)</span></code></pre><p>其中最头上的 <strong>ORCLPDB1</strong> 就是这个配置的名称<br>然后就是修改一下 HOST 和 PORT</p><p>配置还之后修改下代码中的连接</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">dsn := `user=<span class="token string">"lalala"</span> password=<span class="token string">"123456"</span> connectString=<span class="token string">"ORCLPDB1"</span>`</code></pre><p>可以看到 <code>connectString</code> 里面不再需要配置连接地址，而是直接配置上tnsnames.ora文件配置的名称即可</p><p>最后再次运行代码，success</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Go连接Oracle数据库用到的驱动主要有三个：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/sijms/go-ora&quot;&gt;https://github.com/sijms/go-ora&lt;/a&gt;：开箱即用，不用额外安装客户端驱动程序，真跨</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Go" scheme="https://shuangdeyu.github.io/tags/Go/"/>
    
    <category term="database" scheme="https://shuangdeyu.github.io/tags/database/"/>
    
  </entry>
  
  <entry>
    <title>macOS上使用踩坑DB2记录</title>
    <link href="https://shuangdeyu.github.io/2023/12/13/macos-shang-shi-yong-cai-keng-db2-ji-lu/"/>
    <id>https://shuangdeyu.github.io/2023/12/13/macos-shang-shi-yong-cai-keng-db2-ji-lu/</id>
    <published>2023-12-12T16:00:00.000Z</published>
    <updated>2023-12-20T08:34:12.435Z</updated>
    
    <content type="html"><![CDATA[<p>由于项目需求，需要对接很多种类的数据库，包括一些平时比较冷门甚至听都没听过的，而开发环境是MAC的M2，开发语言是Golang。</p><p>不得不说，这个开发环境对于很多数据库对接是很有难度的，首先很多数据库不支持在ARM架构系统上安装，而且Golang的数据库驱动除了主流的几个数据库之外，支持度并不是很好，很多甚至还不支持，就算支持也存在arm系统的问题，总的来说有点痛苦，踩了很多坑。</p><p>以下就记录下对接BD2的时候遇到的问题。</p><blockquote><p>DB2就是IBM开发的一种大型关系型数据库平台。</p></blockquote><h2 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h2><p>安装就不说了，不要在mac M1 M2上安装，ibm官方只提供mac intel的安装包，docker镜像也都是amd系统的，在arm系统上运行会有问题。</p><p>所以我在公司申购了一台linux服务器专门用来支持各种开发环境用。</p><p>安装就略过了，直接docker安装即可。</p><blockquote><p>直接贴上地址：<a href="https://www.yuque.com/shuangyu-rcged/network/bb7p905taxmm56sh">https://www.yuque.com/shuangyu-rcged/network/bb7p905taxmm56sh</a></p></blockquote><h2 id="二、安装Go驱动"><a href="#二、安装Go驱动" class="headerlink" title="二、安装Go驱动"></a>二、安装Go驱动</h2><p>IBM有提供针对Golang语言的DB2数据库驱动：<a href="https://github.com/ibmdb/go_ibm_db">https://github.com/ibmdb/go_ibm_db</a></p><p>其安装步骤如下：<br>1、下载golang驱动包，使用下面任一指令即可，项目中有mod模块的话就更方便了，直接同步下依赖就行</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">go get <span class="token operator">-</span>d github<span class="token punctuation">.</span>com/ibmdb/go_ibm_dbgo install github<span class="token punctuation">.</span>com/ibmdb/go_ibm_db/installer@latestgo install github<span class="token punctuation">.</span>com/ibmdb/go_ibm_db/installer@v0<span class="token punctuation">.</span>4<span class="token punctuation">.</span>5</code></pre><p>2、安装odbc驱动<br>除了下载安装golang程序驱动包之外，DB2的使用还需要安装odbc的驱动并进行一些相关配置</p><p>首先，设置驱动下载地址的环境变量，安装的时候会自动去这个地址下载，或者你也可以自己下载下来放到自己指定的目录</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">export IBM_DB_DOWNLOAD_URL=https:<span class="token operator">/</span><span class="token operator">/</span>public<span class="token punctuation">.</span>dhe<span class="token punctuation">.</span>ibm<span class="token punctuation">.</span>com/ibmdl/export/pub/software/<span class="token keyword">data</span><span class="token operator">/</span>db2/drivers/odbc_cli/v11<span class="token punctuation">.</span>5<span class="token punctuation">.</span>4/macos64_odbc_cli<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</code></pre><p>下一步，如果你已经手动下载了的话就不用进行了，需要自动下载就进行下一步<br>进入到第一步安装的golang驱动包里面的installer目录，比如我的是<code>/Users/jyj/goproject/pkg/mod/github.com/ibmdb/go_ibm_db@v0.4.5/installer</code>，里面有安装脚本<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1702433310162-6b49f2bf-c220-418c-a330-cd4ec9179946.png#averageHue=%23fafafa&clientId=ua920b183-5d70-4&from=paste&height=175&id=u153ff064&originHeight=350&originWidth=668&originalType=binary&ratio=2&rotation=0&showTitle=false&size=52087&status=done&style=none&taskId=uae4e0fbb-9542-483d-8dac-1dca3a1c6bb&title=&width=334" alt="image.png"></p><p>然后执行这条指令，自动下载驱动包：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">go run setup<span class="token punctuation">.</span>go</code></pre><p>这时执行完之后的目录，下载并解压完成驱动包<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1702433430356-4cef214c-c037-423a-955e-156be18e16a6.png#averageHue=%23faf4f4&clientId=ua920b183-5d70-4&from=paste&height=190&id=u327d1628&originHeight=380&originWidth=742&originalType=binary&ratio=2&rotation=0&showTitle=false&size=80117&status=done&style=none&taskId=ua89ddde1-6bda-48e6-a257-bc9e6753b36&title=&width=371" alt="image.png"></p><p>最后还要设置环境变量<br>可以手动设置：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">export IBM_DB_HOME=<span class="token operator">/</span>home/uname/go/src/github<span class="token punctuation">.</span>com/ibmdb/clidriverexport CGO_CFLAGS=<span class="token operator">-</span>I<span class="token variable">$IBM_DB_HOME</span><span class="token operator">/</span>includeexport CGO_LDFLAGS=<span class="token operator">-</span>L<span class="token variable">$IBM_DB_HOME</span><span class="token operator">/</span>libexport DYLD_LIBRARY_PATH=<span class="token variable">$DYLD_LIBRARY_PATH</span>:<span class="token variable">$IBM_DB_HOME</span><span class="token operator">/</span>lib</code></pre><p>也可以运行脚本自动设置，在installer目录下：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">source setenv<span class="token punctuation">.</span>sh</code></pre><p><strong>注意：</strong><br>但是，强烈建议将环境变量的设置放到’<strong>~/.zshrc</strong>‘中，因为写代码的时候编辑器可能会读取不到环境变量</p><p>整个驱动安装大致就是以上步骤了，其它windows、linux系统的看官方的github就可以了</p><h2 id="三、问题"><a href="#三、问题" class="headerlink" title="三、问题"></a>三、问题</h2><p>安装完成，那剩下的就是开跑验证了，连接代码参考官方给出的示例：</p><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token punctuation">(</span>    <span class="token string">"database/sql"</span>    <span class="token string">"fmt"</span>    <span class="token boolean">_</span> <span class="token string">"github.com/ibmdb/go_ibm_db"</span><span class="token punctuation">)</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    con <span class="token operator">:=</span> <span class="token string">"HOSTNAME=host;DATABASE=name;PORT=number;UID=username;PWD=password"</span>    db<span class="token punctuation">,</span> err <span class="token operator">:=</span> sql<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">"go_ibm_db"</span><span class="token punctuation">,</span> con<span class="token punctuation">)</span>    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    db<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></code></pre><p>1、github.com/ibmdb/go_ibm_db@v0.4.5/api/api_unix.go:14:11: fatal error: ‘sqlcli1.h’ file not found<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1702444918309-c59ab98b-1173-4dda-923b-effd4979bebc.png#averageHue=%23434242&clientId=ua920b183-5d70-4&from=paste&height=89&id=uf2c840ac&originHeight=178&originWidth=1850&originalType=binary&ratio=2&rotation=0&showTitle=false&size=38248&status=done&style=none&taskId=u03b4ef23-20e3-4209-ba42-50a6c7a2ce3&title=&width=925" alt="image.png"><br>在goland里面运行可能会报这个错误，这是因为没有读取到环境变量，而我在goland的运行配置里面加上这些驱动的环境变量也没有生效，所以上面我建议将驱动的环境变量配置到系统文件’~/.zshrc’中，作为全局，可以取消这个报错<br>如果你一开始就用命令行直接运行则没问题</p><p>另外，还可能会有这个提示：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1702438060084-dd28a741-dcf7-429d-85cd-fb215fa48f58.png#averageHue=%23e9e9e8&clientId=ua920b183-5d70-4&from=paste&height=77&id=u42672c70&originHeight=154&originWidth=712&originalType=binary&ratio=2&rotation=0&showTitle=false&size=20050&status=done&style=none&taskId=u0a87c6ad-5995-4546-9497-bf46b88cae7&title=&width=356" alt="image.png"><br>很明显是’CGO_CFLAGS’这个环境变量的问题，按照提示修改成这样</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">export CGO_CFLAGS=<span class="token string">"-I<span class="token variable">$IBM_DB_HOME</span>/include -O0 -g"</span></code></pre><p>当然，上面这两个错误基本是在使用goland编辑器运行程序的时候会报错，因为想要开发调试方便，所以必须要解决</p><p>2、building for macOS-arm64 but attempting to link with file built for macOS-x86_64<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1702438434375-4c66f2e8-98b9-43ee-b218-2f72e6190649.png#averageHue=%23373535&clientId=ua920b183-5d70-4&from=drop&id=u9209cd97&originHeight=1820&originWidth=2632&originalType=binary&ratio=2&rotation=0&showTitle=false&size=803208&status=done&style=none&taskId=u90125e41-842d-4b25-9c31-3a4dc537f65&title=" alt="截屏2023-12-13 11.32.33.png"><br>根据错误描述可知，这个驱动其实是不兼容macOS-arm64的，在我将项目部署到linux-amd64上运行成功之后，验证了这一事实的准确性。</p><p>那么如何在macOS-arm64上跑起来呢？</p><p>查询资料有说是用Rosetta 2模拟x86架构去跑的：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">arch <span class="token operator">-</span>x86_64 go run main<span class="token punctuation">.</span>go</code></pre><p>决定试一试，经过一番试验之后，得出结论，当前arm64系统安装的golang版本也是arm架构的，那么我再安装一个amd64版本的golang，用它去跑程序是不是就行了。</p><p>首先，在Rosetta总安装brew：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">arch <span class="token operator">-</span>x86_64 <span class="token operator">/</span>bin/bash <span class="token operator">-</span>c <span class="token string">"<span class="token function">$<span class="token punctuation">(</span>curl <span class="token operator">-</span>fsSL https:<span class="token operator">/</span><span class="token operator">/</span>raw<span class="token punctuation">.</span>githubusercontent<span class="token punctuation">.</span>com/Homebrew/install/HEAD/install<span class="token punctuation">.</span>sh<span class="token punctuation">)</span></span>"</span></code></pre><p>然后安装golang，放心安装，不会影响之前安装的golang环境：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">arch <span class="token operator">-</span>x86_64 brew install go@1<span class="token punctuation">.</span>19</code></pre><p>因为在命令行下运行会涉及到环境变量的修改等问题，再次借助goland可以很方便切换运行环境，并成功运行，可以达到我在mac-arm64方便开发调试的目的：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token operator">/</span><span class="token operator">/</span> 命令行运行会报错arch <span class="token operator">-</span>x86_64 <span class="token operator">/</span>usr/local/Cellar/go@1<span class="token punctuation">.</span>19/1<span class="token punctuation">.</span>19<span class="token punctuation">.</span>13/libexec/bin/go run main<span class="token punctuation">.</span>go</code></pre><p>在这里切换goroot：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1702445523348-1d2a1131-5045-468c-810f-17a3d7611f36.png#averageHue=%23ededed&clientId=ua920b183-5d70-4&from=drop&id=u06583efe&originHeight=1442&originWidth=1964&originalType=binary&ratio=2&rotation=0&showTitle=false&size=275078&status=done&style=none&taskId=u182891e0-4817-4c60-8782-e11efef22d3&title=" alt="截屏2023-12-13 13.31.38.png"></p><p>切换完再运行程序就顺利跑起来了，唯一有缺憾的是切换成amd64的golang的话，在arm64下的goland中无法使用debug功能，只能通过打印的方式进行调试了。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;由于项目需求，需要对接很多种类的数据库，包括一些平时比较冷门甚至听都没听过的，而开发环境是MAC的M2，开发语言是Golang。&lt;/p&gt;
&lt;p&gt;不得不说，这个开发环境对于很多数据库对接是很有难度的，首先很多数据库不支持在ARM架构系统上安装，而且Golang的数据库驱动除了</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="database" scheme="https://shuangdeyu.github.io/tags/database/"/>
    
    <category term="mac" scheme="https://shuangdeyu.github.io/tags/mac/"/>
    
  </entry>
  
  <entry>
    <title>k8s学习笔记(1)—kubeadm安装k8s</title>
    <link href="https://shuangdeyu.github.io/2023/12/08/k8s-xue-xi-bi-ji-1-kubeadm-an-zhuang-k8s/"/>
    <id>https://shuangdeyu.github.io/2023/12/08/k8s-xue-xi-bi-ji-1-kubeadm-an-zhuang-k8s/</id>
    <published>2023-12-07T16:00:00.000Z</published>
    <updated>2023-12-20T08:34:12.424Z</updated>
    
    <content type="html"><![CDATA[<p>k8s万里长征的第一步</p><h2 id="一、前置步骤"><a href="#一、前置步骤" class="headerlink" title="一、前置步骤"></a>一、前置步骤</h2><blockquote><p>服务器规划</p></blockquote><table><thead><tr><th><strong>节点名称</strong></th><th><strong>IP</strong></th><th>配置</th></tr></thead><tbody><tr><td>k8s-master1</td><td>192.168.2.124</td><td>centos7，4G，2CPU</td></tr><tr><td>k8s-node1</td><td>192.168.2.105</td><td>centos7，2G，2CPU</td></tr><tr><td>k8s-node2</td><td>192.168.2.106</td><td>centos7，2G，2CPU</td></tr></tbody></table><blockquote><p>关闭系统防火墙</p></blockquote><pre class="language-powershell" data-language="powershell"><code class="language-powershell">systemctl stop firewalldsystemctl disable firewalld</code></pre><blockquote><p>关闭selinux</p></blockquote><pre class="language-powershell" data-language="powershell"><code class="language-powershell">sed <span class="token operator">-</span>i <span class="token string">'s/enforcing/disabled/'</span> <span class="token operator">/</span>etc/selinux/config  <span class="token comment">#永久</span>setenforce 0  <span class="token comment"># 临时 </span></code></pre><blockquote><p>关闭swap</p></blockquote><pre class="language-powershell" data-language="powershell"><code class="language-powershell">swapoff <span class="token operator">-</span>a   <span class="token comment">#临时</span>sed <span class="token operator">-</span><span class="token function">ri</span> <span class="token string">'s/.*swap.*/#&amp;/'</span> <span class="token operator">/</span>etc/fstab  <span class="token comment">#永久</span></code></pre><blockquote><p>根据规划设置主机名</p></blockquote><pre class="language-powershell" data-language="powershell"><code class="language-powershell">hostnamectl <span class="token function">set-hostname</span> k8s-master1hostnamectl <span class="token function">set-hostname</span> k8s-node1hostnamectl <span class="token function">set-hostname</span> k8s-node2</code></pre><blockquote><p>添加hosts</p></blockquote><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">cat</span> >> <span class="token operator">/</span>etc/hosts &lt;&lt; EOF192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>2<span class="token punctuation">.</span>124 k8s-master1192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>2<span class="token punctuation">.</span>105 k8s-node1192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>2<span class="token punctuation">.</span>116 k8s-node2EOF</code></pre><blockquote><p>时间同步</p></blockquote><pre class="language-powershell" data-language="powershell"><code class="language-powershell">yum install chrony <span class="token operator">-</span>ysystemctl <span class="token function">start</span> chronydsystemctl enable chronydchronyc sources</code></pre><blockquote><p>配置ssh互信</p></blockquote><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># 直接一直回车就行</span>ssh-keygenssh-<span class="token function">copy-id</span> <span class="token operator">-</span>i ~<span class="token operator">/</span><span class="token punctuation">.</span>ssh/id_rsa<span class="token punctuation">.</span>pub root@k8s-master1ssh-<span class="token function">copy-id</span> <span class="token operator">-</span>i ~<span class="token operator">/</span><span class="token punctuation">.</span>ssh/id_rsa<span class="token punctuation">.</span>pub root@k8s-node1ssh-<span class="token function">copy-id</span> <span class="token operator">-</span>i ~<span class="token operator">/</span><span class="token punctuation">.</span>ssh/id_rsa<span class="token punctuation">.</span>pub root@k8s-node2</code></pre><blockquote><p>更换yum源</p></blockquote><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">mv</span> <span class="token operator">/</span>etc/yum<span class="token punctuation">.</span>repos<span class="token punctuation">.</span>d/CentOS-Base<span class="token punctuation">.</span>repo <span class="token operator">/</span>etc/yum<span class="token punctuation">.</span>repos<span class="token punctuation">.</span>d/CentOS-Base<span class="token punctuation">.</span>repo<span class="token punctuation">.</span>backupwget <span class="token operator">-</span>O Centos-Base<span class="token punctuation">.</span>repo http:<span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com/repo/Centos-7<span class="token punctuation">.</span>repoyum clean allyum makecacheyum <span class="token operator">-</span>y install update</code></pre><blockquote><p>允许 iptables 检查桥接流量</p></blockquote><p>允许 iptables 检查桥接流量（可选，所有节点） 若要显式加载此模块，请运行 sudo modprobe br_netfilter，通过运行 lsmod | grep br_netfilter 来验证 br_netfilter 模块是否已加载</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">sudo modprobe br_netfilterlsmod <span class="token punctuation">|</span> grep br_netfilter</code></pre><p>为了让你的 Linux 节点上的 iptables 能够正确地查看桥接流量，你需要确保在你的 sysctl 配置中将 net.bridge.bridge-nf-call-iptables 设置为 1。例如：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token function">cat</span> &lt;&lt;EOF <span class="token punctuation">|</span> sudo <span class="token function">tee</span> <span class="token operator">/</span>etc/modules-load<span class="token punctuation">.</span>d/k8s<span class="token punctuation">.</span>confbr_netfilterEOF<span class="token function">cat</span> &lt;&lt;EOF <span class="token punctuation">|</span> sudo <span class="token function">tee</span> <span class="token operator">/</span>etc/sysctl<span class="token punctuation">.</span>d/k8s<span class="token punctuation">.</span>confnet<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>bridge-nf-call-ip6tables = 1net<span class="token punctuation">.</span>bridge<span class="token punctuation">.</span>bridge-nf-call-iptables = 1EOFsudo sysctl <span class="token operator">--</span>system</code></pre><blockquote><p>升级内核</p></blockquote><p>3.10内核在大规模集群具有不稳定性,所以需要升级内核 。(所有机器都要升级到一样)</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment">#查看内核版本</span>$ uname <span class="token operator">-</span>sr  <span class="token comment">#系统更新</span>$ yum update <span class="token comment">#载入公钥</span>$ rpm <span class="token operator">--</span>import https:<span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>elrepo<span class="token punctuation">.</span>org/RPM-GPG-KEY-elrepo<span class="token punctuation">.</span>org <span class="token comment">#安装 ELRepo 最新版本</span>$ yum install <span class="token operator">-</span>y https:<span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>elrepo<span class="token punctuation">.</span>org/elrepo-release-7<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>elrepo<span class="token punctuation">.</span>noarch<span class="token punctuation">.</span>rpm <span class="token comment">#列出可以使用的 kernel 包版本</span>$ yum list available <span class="token operator">--</span>disablerepo=<span class="token operator">*</span> <span class="token operator">--</span>enablerepo=elrepo-kernel  <span class="token comment">#安装指定的 kernel 版本：(已查看版本为准,采用lt长期支持版本)</span>$ yum install <span class="token operator">-</span>y kernel-lt-5<span class="token punctuation">.</span>4<span class="token punctuation">.</span>251-1<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>elrepo <span class="token operator">--</span>enablerepo=elrepo-kernel <span class="token comment">#查看系统可用内核</span>$ <span class="token function">cat</span> <span class="token operator">/</span>boot/grub2/grub<span class="token punctuation">.</span>cfg <span class="token punctuation">|</span> grep menuentry <span class="token comment">#设置开机从新内核启动</span>$ grub2-<span class="token function">set-default</span> <span class="token string">"CentOS Linux (5.4.251-1.el7.elrepo.x86_64) 7 (Core)"</span> <span class="token comment">#查看内核启动项</span>$ grub2-editenv listsaved_entry=CentOS Linux <span class="token punctuation">(</span>5<span class="token punctuation">.</span>4<span class="token punctuation">.</span>251-1<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>elrepo<span class="token punctuation">.</span>x86_64<span class="token punctuation">)</span> 7 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span> <span class="token comment">#重启系统使内核生效：</span>$ reboot <span class="token comment">#启动完成查看内核版本是否更新：</span>$ uname <span class="token operator">-</span>r5<span class="token punctuation">.</span>4<span class="token punctuation">.</span>188-1<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>elrepo<span class="token punctuation">.</span>x86_64</code></pre><h2 id="二、安装docker"><a href="#二、安装docker" class="headerlink" title="二、安装docker"></a>二、安装docker</h2><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># 安装yum-config-manager配置工具</span>yum <span class="token operator">-</span>y install yum-utils<span class="token comment"># 设置yum源</span>yum-config-manager <span class="token operator">--</span><span class="token function">add-repo</span> http:<span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com/docker-ce/linux/centos/docker-ce<span class="token punctuation">.</span>repo<span class="token comment"># 安装docker-ce版本</span>yum install <span class="token operator">-</span>y docker-ce<span class="token comment"># 启动</span>systemctl <span class="token function">start</span> docker<span class="token comment"># 开机自启</span>systemctl enable docker<span class="token comment"># 查看版本号</span>docker <span class="token operator">--</span>version<span class="token comment"># 查看版本具体信息</span>docker version<span class="token comment"># Docker镜像源设置</span><span class="token comment"># 修改文件 /etc/docker/daemon.json，没有这个文件就创建</span><span class="token comment"># 添加以下内容后，重启docker服务：</span><span class="token function">cat</span> ><span class="token operator">/</span>etc/docker/daemon<span class="token punctuation">.</span>json&lt;&lt;EOF<span class="token punctuation">&#123;</span>   <span class="token string">"registry-mirrors"</span>: <span class="token punctuation">[</span>    <span class="token string">"https://docker.mirrors.ustc.edu.cn"</span><span class="token punctuation">,</span>    <span class="token string">"https://registry.docker-cn.com"</span><span class="token punctuation">,</span>    <span class="token string">"https://5tdtrypx.mirror.aliyuncs.com"</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span>EOF<span class="token comment"># 加载</span>systemctl reload docker<span class="token comment"># 查看</span>systemctl status docker containerd</code></pre><h2 id="三、配置-k8s-yum-源（所有节点）"><a href="#三、配置-k8s-yum-源（所有节点）" class="headerlink" title="三、配置 k8s yum 源（所有节点）"></a>三、配置 k8s yum 源（所有节点）</h2><pre class="language-none"><code class="language-none">cat &lt;&lt;EOF &gt; &#x2F;etc&#x2F;yum.repos.d&#x2F;kubernetes.repo[kubernetes]name&#x3D;Kubernetesbaseurl&#x3D;https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;kubernetes&#x2F;yum&#x2F;repos&#x2F;kubernetes-el7-x86_64&#x2F;enabled&#x3D;1gpgcheck&#x3D;0repo_gpgcheck&#x3D;0gpgkey&#x3D;https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;kubernetes&#x2F;yum&#x2F;doc&#x2F;yum-key.gpg https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;kubernetes&#x2F;yum&#x2F;doc&#x2F;rpm-package-key.gpgEOF</code></pre><h2 id="四、将-sandbox-image-镜像源设置为阿里云-google-containers-镜像源（所有节点）"><a href="#四、将-sandbox-image-镜像源设置为阿里云-google-containers-镜像源（所有节点）" class="headerlink" title="四、将 sandbox_image 镜像源设置为阿里云 google_containers 镜像源（所有节点）"></a>四、将 sandbox_image 镜像源设置为阿里云 google_containers 镜像源（所有节点）</h2><pre class="language-none"><code class="language-none"># 导出默认配置，config.toml这个文件默认是不存在的containerd config default &gt; &#x2F;etc&#x2F;containerd&#x2F;config.tomlgrep sandbox_image  &#x2F;etc&#x2F;containerd&#x2F;config.tomlsed -i &quot;s#k8s.gcr.io&#x2F;pause#registry.aliyuncs.com&#x2F;google_containers&#x2F;pause#g&quot;       &#x2F;etc&#x2F;containerd&#x2F;config.tomlgrep sandbox_image  &#x2F;etc&#x2F;containerd&#x2F;config.toml</code></pre><h2 id="五、配置-containerd-cgroup-驱动程序-systemd（所有节点）"><a href="#五、配置-containerd-cgroup-驱动程序-systemd（所有节点）" class="headerlink" title="五、配置 containerd cgroup 驱动程序 systemd（所有节点）"></a>五、配置 containerd cgroup 驱动程序 systemd（所有节点）</h2><p>kubernets 自ｖ 1.24.0 后，就不再使用 docker.shim，替换采用 containerd 作为容器运行时端点。因此需要安装 containerd（在 docker 的基础下安装），上面安装 docker 的时候就自动安装了 containerd 了。这里的 docker 只是作为客户端而已。容器引擎还是 containerd。</p><pre class="language-none"><code class="language-none">sed -i &#39;s#SystemdCgroup &#x3D; false#SystemdCgroup &#x3D; true#g&#39; &#x2F;etc&#x2F;containerd&#x2F;config.toml# 应用所有更改后,重新启动containerdsystemctl restart containerd</code></pre><h2 id="六、开始安装-kubeadm，kubelet-和-kubectl（所有节点）"><a href="#六、开始安装-kubeadm，kubelet-和-kubectl（所有节点）" class="headerlink" title="六、开始安装 kubeadm，kubelet 和 kubectl（所有节点）"></a>六、开始安装 kubeadm，kubelet 和 kubectl（所有节点）</h2><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># 不指定版本就是最新版本</span>yum install <span class="token operator">-</span>y kubelet-1<span class="token punctuation">.</span>19<span class="token punctuation">.</span>5 kubeadm-1<span class="token punctuation">.</span>19<span class="token punctuation">.</span>5 kubectl-1<span class="token punctuation">.</span>19<span class="token punctuation">.</span>5<span class="token comment"># 设置为开机自启并现在立刻启动服务 --now：立刻启动服务</span>systemctl enable <span class="token operator">--</span>now kubelet<span class="token comment"># 查看状态，这里需要等待一段时间再查看服务状态，启动会有点慢</span>systemctl status kubelet</code></pre><blockquote><p> journalctl -xefu kubelet 查看日志，发现有报错，报错如下：<br>kubelet.service: Main process exited, code=exited, status=1/FAILURE kubelet.service: Failed with result ‘exit-code’.</p></blockquote><blockquote><p>【解释】重新安装（或第一次安装）k8s，未经过 kubeadm init 或者 kubeadm join 后，kubelet 会不断重启，这个是正常现象……，执行 init 或 join 后问题会自动解决，对此官网有如下描述，也就是此时不用理会 kubelet.service。</p></blockquote><p>于是，先进行下面的kubeadm init后再来启动。<br>采用1.19.5版本，其它高版本的报错报错太多，安装失败</p><h2 id="七、使用-kubeadm-初始化集群（master-节点）"><a href="#七、使用-kubeadm-初始化集群（master-节点）" class="headerlink" title="七、使用 kubeadm 初始化集群（master 节点）"></a>七、使用 kubeadm 初始化集群（master 节点）</h2><pre class="language-none"><code class="language-none">kubeadm init \  --apiserver-advertise-address&#x3D;192.168.2.124 \  --image-repository registry.aliyuncs.com&#x2F;google_containers \  --control-plane-endpoint&#x3D;cluster-endpoint \  --kubernetes-version v1.19.5 \  --service-cidr&#x3D;10.1.0.0&#x2F;16 \  --pod-network-cidr&#x3D;10.244.0.0&#x2F;16# –image-repository string：    这个用于指定从什么位置来拉取镜像（1.13版本才有的），默认值是k8s.gcr.io，我们将其指定为国内镜像地址：registry.aliyuncs.com&#x2F;google_containers# –kubernetes-version string：  指定kubenets版本号，默认值是stable-1，会导致从https:&#x2F;&#x2F;dl.k8s.io&#x2F;release&#x2F;stable-1.txt下载最新的版本号，我们可以将其指定为固定版本（v1.22.1）来跳过网络请求。# –apiserver-advertise-address  指明用 Master 的哪个 interface 与 Cluster 的其他节点通信。如果 Master 有多个 interface，建议明确指定，如果不指定，kubeadm 会自动选择有默认网关的 interface。这里的ip为master节点ip，记得更换。# –pod-network-cidr             指定 Pod 网络的范围。Kubernetes 支持多种网络方案，而且不同网络方案对  –pod-network-cidr有自己的要求，这里设置为10.244.0.0&#x2F;16 是因为我们将使用 flannel 网络方案，必须设置成这个 CIDR。# --control-plane-endpoint     cluster-endpoint 是映射到该 IP 的自定义 DNS 名称，这里配置hosts映射：192.168.0.113   cluster-endpoint。 这将允许你将 --control-plane-endpoint&#x3D;cluster-endpoint 传递给 kubeadm init，并将相同的 DNS 名称传递给 kubeadm join。 稍后你可以修改 cluster-endpoint 以指向高可用性方案中的负载均衡器的地址。</code></pre><p>首次初始化的时候会失败，因为之前的 kubelet 没有运行，但这次初始化之后则运行了，于是：</p><blockquote><p>重置再初始化</p></blockquote><pre class="language-none"><code class="language-none">kubeadm resetrm -fr ~&#x2F;.kube&#x2F;  &#x2F;etc&#x2F;kubernetes&#x2F;* var&#x2F;lib&#x2F;etcd&#x2F;*kubeadm init \  --apiserver-advertise-address&#x3D;192.168.2.124 \  --image-repository&#x3D;registry.aliyuncs.com&#x2F;google_containers \  --control-plane-endpoint&#x3D;cluster-endpoint \  --kubernetes-version v1.19.5 \  --service-cidr&#x3D;10.1.0.0&#x2F;16 \  --pod-network-cidr&#x3D;10.244.0.0&#x2F;16# –image-repository string：    这个用于指定从什么位置来拉取镜像（1.13版本才有的），默认值是k8s.gcr.io，我们将其指定为国内镜像地址：registry.aliyuncs.com&#x2F;google_containers# –kubernetes-version string：  指定kubenets版本号，默认值是stable-1，会导致从https:&#x2F;&#x2F;dl.k8s.io&#x2F;release&#x2F;stable-1.txt下载最新的版本号，我们可以将其指定为固定版本（v1.22.1）来跳过网络请求。# –apiserver-advertise-address  指明用 Master 的哪个 interface 与 Cluster 的其他节点通信。如果 Master 有多个 interface，建议明确指定，如果不指定，kubeadm 会自动选择有默认网关的 interface。这里的ip为master节点ip，记得更换。# –pod-network-cidr             指定 Pod 网络的范围。Kubernetes 支持多种网络方案，而且不同网络方案对  –pod-network-cidr有自己的要求，这里设置为10.244.0.0&#x2F;16 是因为我们将使用 flannel 网络方案，必须设置成这个 CIDR。# --control-plane-endpoint     cluster-endpoint 是映射到该 IP 的自定义 DNS 名称，这里配置hosts映射：192.168.0.113   cluster-endpoint。 这将允许你将 --control-plane-endpoint&#x3D;cluster-endpoint 传递给 kubeadm init，并将相同的 DNS 名称传递给 kubeadm join。 稍后你可以修改 cluster-endpoint 以指向高可用性方案中的负载均衡器的地址。</code></pre><p>按提示执行下面的指令</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">mkdir <span class="token operator">-</span>p <span class="token variable">$HOME</span><span class="token operator">/</span><span class="token punctuation">.</span>kubesudo <span class="token function">cp</span> <span class="token operator">-</span>i <span class="token operator">/</span>etc/kubernetes/admin<span class="token punctuation">.</span>conf <span class="token variable">$HOME</span><span class="token operator">/</span><span class="token punctuation">.</span>kube/configsudo chown $<span class="token punctuation">(</span>id <span class="token operator">-</span>u<span class="token punctuation">)</span>:$<span class="token punctuation">(</span>id <span class="token operator">-</span>g<span class="token punctuation">)</span> <span class="token variable">$HOME</span><span class="token operator">/</span><span class="token punctuation">.</span>kube/config</code></pre><p>记住提示中node节点加入集群的命令，格式如下</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">kubeadm join 192<span class="token punctuation">.</span>168<span class="token punctuation">.</span>2<span class="token punctuation">.</span>116:6443 <span class="token operator">--</span>token bx6dlx<span class="token punctuation">.</span>30zedu4gg6co3vsp     <span class="token operator">--</span>discovery-token-ca-cert-hash sha256:0736b1babd378116c2e436a73815b1013b20c58f3277b72f0a5f6e0ad2fdac5a</code></pre><p>如忘了可以这样获取</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">kubeadm token create <span class="token operator">--</span>print-<span class="token function">join-command</span></code></pre><p>查看节点状态，为noready，需要安装网络插件</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">kubectl get nodes</code></pre><p>安装网络插件flannel，官网在github <a href="https://github.com/flannel-io/flannel">https://github.com/flannel-io/flannel</a>上<br>等待一段时间，直到所有的flannel容器都运行起来</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">kubectl apply <span class="token operator">-</span>f https:<span class="token operator">/</span><span class="token operator">/</span>raw<span class="token punctuation">.</span>githubusercontent<span class="token punctuation">.</span>com/flannel-io/flannel/master/Documentation/kube-flannel<span class="token punctuation">.</span>yml</code></pre><h2 id="八、初始化node节点"><a href="#八、初始化node节点" class="headerlink" title="八、初始化node节点"></a>八、初始化node节点</h2><p>执行kubeadm join<br>kubeadm join 192.168.2.10:6443 ……（见上方master记录的kubeadm join指令）</p><p>在master节点上查看状态</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">kubectl get nodes</code></pre><h2 id="九、测试kubernetes集群"><a href="#九、测试kubernetes集群" class="headerlink" title="九、测试kubernetes集群"></a>九、测试kubernetes集群</h2><p>在Kubernetes集群中创建一个pod，验证是否正常运行：</p><p>创建nginx容器</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">kubectl create deployment nginx <span class="token operator">--</span>image=nginx</code></pre><p>暴露对外端口</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">kubectl expose deployment nginx <span class="token operator">--</span>port=80 <span class="token operator">--</span><span class="token function">type</span>=NodePort</code></pre><p>查看nginx是否运行成功</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">kubectl get pod<span class="token punctuation">,</span>svc</code></pre><p>在浏览器访问。三个结点都可访问，说明集群已经搭建完成，</p><h2 id="十、k8s-管理平台-dashboard-环境部署"><a href="#十、k8s-管理平台-dashboard-环境部署" class="headerlink" title="十、k8s 管理平台 dashboard 环境部署"></a>十、k8s 管理平台 dashboard 环境部署</h2><p>GitHub 地址：<a href="https://link.zhihu.com/?target=https://github.com/kubernetes/dashboard">https://github.com/kubernetes/dashboard</a></p><pre class="language-none"><code class="language-none">kubectl apply -f https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;kubernetes&#x2F;dashboard&#x2F;v2.6.0&#x2F;aio&#x2F;deploy&#x2F;recommended.yamlkubectl get pods -n kubernetes-dashboard</code></pre><p>但是这个只能内部访问，所以要外部访问，要么部署 ingress，要么就是设置 service NodePort 类型。这里选择 service 暴露端口。</p><pre class="language-none"><code class="language-none">wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;kubernetes&#x2F;dashboard&#x2F;v2.6.0&#x2F;aio&#x2F;deploy&#x2F;recommended.yaml</code></pre><p>修改后的内容如下：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1691389489581-3b2d8691-eac8-4397-805b-a27365ed8886.png#averageHue=%23fbf7f6&clientId=ubdd2ab98-f809-4&from=paste&height=365&id=u5508d8b8&originHeight=303&originWidth=593&originalType=binary&ratio=2&rotation=0&showTitle=false&size=24766&status=done&style=none&taskId=u3e865fb6-dc3c-4a6c-a6f4-f4a99a12818&title=&width=714.5" alt="image.png"></p><p>部署并查看：</p><pre class="language-none"><code class="language-none">kubectl apply -f recommended.yamlkubectl get svc,pods -n kubernetes-dashboard</code></pre><p>访问 Dashboard的web界面<br>访问地址：<a href="https://nodeip:30001/">https://NodeIP:30001</a> 【必须是https】，部署在node节点的，用node节点的ip，而且google浏览器因为证书问题无法访问，用360极速可以访问</p><p>创建service account并绑定默认cluster-admin管理员集群角色：【依次执行】</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">kubectl create serviceaccount dashboard-admin <span class="token operator">-</span>n kube-systemkubectl create clusterrolebinding dashboard-admin <span class="token operator">--</span>clusterrole=cluster-admin <span class="token operator">--</span>serviceaccount=kube-system:dashboard-adminkubectl describe secrets <span class="token operator">-</span>n kube-system $<span class="token punctuation">(</span>kubectl <span class="token operator">-</span>n kube-system get secret <span class="token punctuation">|</span> awk <span class="token string">'/dashboard-admin/&#123;print $1&#125;'</span><span class="token punctuation">)</span></code></pre><p><img src="https://cdn.nlark.com/yuque/0/2022/png/115159/1642493748533-e0e0032f-76da-4720-aefa-80a06f146fb2.png#averageHue=%23f9f5f2&clientId=u5daf5834-5651-4&from=paste&id=u8408817a&originHeight=418&originWidth=1079&originalType=url&ratio=1&rotation=0&showTitle=false&size=77885&status=done&style=none&taskId=u42b877b3-a93b-4eed-92ef-076381372dc&title=" alt="image.png"></p><p>然后介绍一个更好的管理工具：<br><a href="https://www.kuboard.cn/">https://www.kuboard.cn/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;k8s万里长征的第一步&lt;/p&gt;
&lt;h2 id=&quot;一、前置步骤&quot;&gt;&lt;a href=&quot;#一、前置步骤&quot; class=&quot;headerlink&quot; title=&quot;一、前置步骤&quot;&gt;&lt;/a&gt;一、前置步骤&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;服务器规划&lt;/p&gt;
&lt;/blockquote</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="docker" scheme="https://shuangdeyu.github.io/tags/docker/"/>
    
    <category term="k8s" scheme="https://shuangdeyu.github.io/tags/k8s/"/>
    
  </entry>
  
  <entry>
    <title>如何在Mac上安装oracle</title>
    <link href="https://shuangdeyu.github.io/2023/12/07/ru-he-zai-mac-shang-an-zhuang-oracle/"/>
    <id>https://shuangdeyu.github.io/2023/12/07/ru-he-zai-mac-shang-an-zhuang-oracle/</id>
    <published>2023-12-06T16:00:00.000Z</published>
    <updated>2023-12-20T08:35:53.964Z</updated>
    
    <content type="html"><![CDATA[<p>使用电脑是Mac M1，Arm架构的，使用docker安装，网上搜了一下，发现网上公开的oracle镜像都不是Arm架构的，oracle对Arm的支持度不高，尝试了几个一直无法使用，连接的时候一直报错：<strong>Lost contact</strong>。</p><blockquote><p><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1700623477180-8e35ba36-7fe5-45a7-b8f0-f1d88d6a8ed3.png#averageHue=%23ebebeb&clientId=ucbeb6f35-8625-4&from=paste&height=166&id=u74e93705&originHeight=332&originWidth=1320&originalType=binary&ratio=2&rotation=0&showTitle=false&size=82334&status=done&style=none&taskId=u329be831-2739-4c6f-8524-7cb55fa6dc3&title=&width=660" alt="image.png"></p></blockquote><p>大多数人的解决方案都是如下几种：</p><blockquote><p><strong>方法1免费，安装utm</strong><br>然后在utm 里面安装虚拟机，debian或者ubuntu 一定要x86-64的版本，推荐debian<br>然后在虚拟机里面安装docker 环境，就可以用oracle linux的镜像了。<br><strong>方法2收费</strong><br>安装parallels desktop for arm版本，安装windows11<br>然后在里面安装oracle12c 测试可以。<br><strong>方法3收费</strong><br>安装utm，在里面安装windows11<br>然后在里面安装oracle12c 测试可以。</p></blockquote><blockquote><p>方法1比较慢，性能差，用做测试都比较勉强。推荐2，2和3性能差不多，2方便一些。</p></blockquote><p>我还是觉得太麻烦了，毕竟只是轻度使用，最终找到一个靠谱的解决方案，并且安装连接成功：</p><blockquote><p><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1700623436819-90729e13-6db4-4244-a813-23e65b00ef27.png#averageHue=%23efefef&clientId=ucbeb6f35-8625-4&from=paste&height=234&id=u6f3d00f5&originHeight=468&originWidth=1322&originalType=binary&ratio=2&rotation=0&showTitle=false&size=117706&status=done&style=none&taskId=uf612c215-9471-4ffc-b856-48be6e1eb92&title=&width=661" alt="image.png"></p></blockquote><p>下面就记录下安装过程。</p><h3 id="1、下载-Oracle-Database-19c-安装文件"><a href="#1、下载-Oracle-Database-19c-安装文件" class="headerlink" title="1、下载 Oracle Database 19c 安装文件"></a>1、<strong>下载 Oracle Database 19c 安装文件</strong></h3><ul><li>访问 Oracle 官网: <a href="https://www.oracle.com/cn/database/technologies/oracle-database-software-downloads.html#19c">https://www.oracle.com/cn/database/technologies/oracle-database-software-downloads.html#19c</a></li><li>往下翻，找到ARM架构的包</li><li><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1700623704433-7323c34e-217a-41b5-9f1a-597addea3c30.png#averageHue=%23fcfbfa&clientId=ucbeb6f35-8625-4&from=paste&height=757&id=u8a4b5301&originHeight=1514&originWidth=2370&originalType=binary&ratio=2&rotation=0&showTitle=false&size=306396&status=done&style=none&taskId=u66088a74-f387-4b3d-b624-752b396f454&title=&width=1185" alt="image.png"></li><li>下载并保存到你的机器上，不需要解压。</li></ul><h3 id="2、下载-Docker-Images-源码"><a href="#2、下载-Docker-Images-源码" class="headerlink" title="2、下载 Docker Images 源码"></a><strong>2、下载 Docker Images 源码</strong></h3><ul><li>访问 Docker 官方 GitHub 仓库：<a href="https://github.com/oracle/docker-images">https://github.com/oracle/docker-images</a></li><li>直接下载zip包，不需要clone。</li><li>解压缩下载的 ZIP 文件。</li></ul><p>资源准备完成：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1700623858082-294a2d87-0dfa-4a76-81b9-bfe0fae2e70b.png#averageHue=%23a7aba5&clientId=ucbeb6f35-8625-4&from=paste&height=53&id=uea167601&originHeight=106&originWidth=608&originalType=binary&ratio=2&rotation=0&showTitle=false&size=20198&status=done&style=none&taskId=ua024160c-adcc-4334-b55a-71c11258a05&title=&width=304" alt="image.png"></p><h3 id="3、构建-Oracle-19c-Docker-镜像"><a href="#3、构建-Oracle-19c-Docker-镜像" class="headerlink" title="3、构建 Oracle 19c Docker 镜像"></a>3、<strong>构建 Oracle 19c Docker 镜像</strong></h3><ul><li><p>进入 <strong>docker-images-main/OracleDatabase/SingleInstance/dockerfiles/19.3.0</strong> 目录</p></li><li><p>将下载的 <strong>LINUX.ARM64_1919000_db_home.zip</strong> 文件复制到该目录下。</p></li><li><p>打开目录下的 <strong>Dockerfile</strong> 文件，修改将安装包换成自己下载的</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">ARG INSTALL_FILE_1=<span class="token string">"LINUX.ARM64_1919000_db_home.zip"</span></code></pre></li><li><p>然后在该目录下执行命令，构建镜像，等待构建完成</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token punctuation">.</span><span class="token operator">/</span>buildContainerImage<span class="token punctuation">.</span>sh <span class="token operator">-</span>v 19<span class="token punctuation">.</span>3<span class="token punctuation">.</span>0 <span class="token operator">-</span>e</code></pre></li></ul><h3 id="4、运行-Oracle-19c-Docker-容器"><a href="#4、运行-Oracle-19c-Docker-容器" class="headerlink" title="4、运行 Oracle 19c Docker 容器"></a>4、<strong>运行 Oracle 19c Docker 容器</strong></h3><p><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1700629837510-13181eab-fc9a-49e4-a81a-5b1665de5115.png#averageHue=%23f5f6f8&clientId=ucbeb6f35-8625-4&from=paste&height=62&id=u2df2e14d&originHeight=124&originWidth=1968&originalType=binary&ratio=2&rotation=0&showTitle=false&size=28626&status=done&style=none&taskId=u5160face-b2f9-4a83-8a90-fb0469c00d4&title=&width=984" alt="image.png"><br>构建完成后能看到这个镜像，表示镜像构建成功，然后就是运行它：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker run <span class="token operator">-</span>d <span class="token operator">-</span>p 1521:1521 <span class="token operator">--</span>name oracle-local oracle/database:19<span class="token punctuation">.</span>3<span class="token punctuation">.</span>0-ee</code></pre><p>进入容器执行命令，不需要用root身份进入，直接进入即可：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker exec <span class="token operator">-</span>it <span class="token punctuation">[</span>容器id<span class="token punctuation">]</span> <span class="token operator">/</span>bin/bash</code></pre><p>在容器中依次执行以下命令：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token operator">/</span><span class="token operator">/</span> 登录oraclesqlplus <span class="token operator">/</span>nolog<span class="token operator">/</span><span class="token operator">/</span> 连接到 sysdba 数据库，这次成功了，之前就是卡在这里，报‘Lost contact’错误conn <span class="token operator">/</span>as sysdba<span class="token operator">/</span><span class="token operator">/</span> 修改system用户的密码为systemalter user system identified by system<span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">/</span> 修改sys用户的密码为sysalter user sys identified by sys<span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">/</span> 本来是想创建一个用户用来连接的，但是报‘ORA-65096: invalid common user or role name’这个错误<span class="token operator">/</span><span class="token operator">/</span> 查询说是当前数据库是容器数据库<span class="token punctuation">(</span>CDB<span class="token punctuation">)</span>，它不允许创建任何本地用户。要切换到可插拔数据库<span class="token punctuation">(</span>PDB<span class="token punctuation">)</span>，然后执行该操作或创建一个普通用户<span class="token operator">/</span><span class="token operator">/</span> 这里只是测试用，能保证连接就行了，就不继续尝试了create user jyj identified by 123456<span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> 这里更正一个错误 <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>最新两版的oracle CDB容器中用户名必须加 <span class="token string">'c##'</span> 前缀才能创建成功，授权也一样，比如下面所示：create user c<span class="token comment">##jyj identified by 123456;</span><span class="token operator">/</span><span class="token operator">/</span> 修改密码规则为永不过期ALTER PROFILE DEFAULT LIMIT PASSWORD_LIFE_TIME UNLIMITED<span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">/</span> 重启下数据库shutdown immediate<span class="token punctuation">;</span>startup<span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">/</span> 退出，搞定<span class="token keyword">exit</span></code></pre><h3 id="5、连接oracle数据库"><a href="#5、连接oracle数据库" class="headerlink" title="5、连接oracle数据库"></a>5、连接oracle数据库</h3><p><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1700630748806-6f77b504-7e24-4b3f-aabd-15774ea0a0f4.png#averageHue=%23b7b7b6&clientId=ucbeb6f35-8625-4&from=paste&height=641&id=u70a6e88a&originHeight=1560&originWidth=1664&originalType=binary&ratio=2&rotation=0&showTitle=false&size=421748&status=done&style=none&taskId=ue40cab43-8826-4797-9a94-5b33e07fe7c&title=&width=684" alt="image.png"><br>这里服务名或SID不知道的话，重新登录容器中数据库上，查询一下即可：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token operator">/</span><span class="token operator">/</span> 服务名查询show parameter service_name<span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">/</span> SID查询<span class="token function">select</span> instance_name <span class="token keyword">from</span> v<span class="token variable">$instance</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">/</span> 版本号查询<span class="token function">select</span> version <span class="token keyword">from</span> v<span class="token variable">$instance</span><span class="token punctuation">;</span></code></pre><h3 id="6、补充：创建用户"><a href="#6、补充：创建用户" class="headerlink" title="6、补充：创建用户"></a>6、补充：创建用户</h3><p>上面说了CDB容器中用户名必须加 ‘c##’ 前缀才能创建成功，这里不推荐使用这个方法，因为我用Golang程序的驱动去连接，会出现问题，url解析会报错，因为连接的时候用户名也得带上c##<br>所以还是老老实实按照常规方法创建用户连接</p><p>以下是创建步骤：</p><ol><li><p><strong>切换到 PDB：</strong> 使用 <strong>ALTER SESSION</strong> 语句来切换到指定的 PDB。假设你要切换到名为 <strong>your_pdb_name</strong> 的 PDB：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token operator">/</span><span class="token operator">/</span> 查看PDB列表show pdbs<span class="token punctuation">;</span>ALTER SESSION <span class="token function">SET</span> CONTAINER = your_pdb_name<span class="token punctuation">;</span></code></pre></li><li><p><strong>创建用户：</strong> 在所选的 PDB 中创建用户。以下是创建用户的示例：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">CREATE USER your_username IDENTIFIED BY your_password<span class="token punctuation">;</span></code></pre><p>替换 <strong>your_username</strong> 和 <strong>your_password</strong> 为实际的用户名和密码。</p></li><li><p><strong>授予权限：</strong> 给新创建的用户授予适当的权限。以下是授予权限的示例：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">GRANT CONNECT<span class="token punctuation">,</span> RESOURCE TO your_username<span class="token punctuation">;</span></code></pre><p>根据需要，你可能需要授予其他权限。</p></li><li><p><strong>连接到数据库：</strong> 使用客户端连接到数据库。在连接字符串中指定所选的 PDB、用户名和密码。例如，如果使用 SQL*Plus：</p><pre class="language-none"><code class="language-none">sqlplus your_username&#x2F;your_password@your_pdb_name</code></pre><p>或者使用其他数据库客户端工具，确保在连接字符串中正确指定了 PDB 名称、用户名和密码。</p></li></ol><p>注意：连接的时候服务名就是你所选的PDB的名称，因为你是在这个PDB下操作的。</p><p><strong>还有一个坑：</strong><br><strong>实际使用的时候可能会遇到ORA-01918、ORA-01950等等问题，按照网上别人的案例操作怎么都不成功，主要原因还是CDB和PDB的问题，在PDB中创建的用户记得要先切换到PDB中才能进行下一步操作，不然会遇到用户不存在等问题</strong><br><strong>即上面的第一步：切换到 PDB</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;使用电脑是Mac M1，Arm架构的，使用docker安装，网上搜了一下，发现网上公开的oracle镜像都不是Arm架构的，oracle对Arm的支持度不高，尝试了几个一直无法使用，连接的时候一直报错：&lt;strong&gt;Lost contact&lt;/strong&gt;。&lt;/p&gt;
&lt;</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="database" scheme="https://shuangdeyu.github.io/tags/database/"/>
    
    <category term="mac" scheme="https://shuangdeyu.github.io/tags/mac/"/>
    
  </entry>
  
  <entry>
    <title>Teamcity自动部署Go项目初尝试</title>
    <link href="https://shuangdeyu.github.io/2023/12/06/teamcity-zi-dong-bu-shu-go-xiang-mu-chu-chang-shi/"/>
    <id>https://shuangdeyu.github.io/2023/12/06/teamcity-zi-dong-bu-shu-go-xiang-mu-chu-chang-shi/</id>
    <published>2023-12-05T16:00:00.000Z</published>
    <updated>2023-12-28T02:58:12.275Z</updated>
    
    <content type="html"><![CDATA[<p>首先介绍一下TeamCity是什么：</p><blockquote><p>TeamCity 是一款由 JetBrains 开发的强大的持续集成（Continuous Integration，CI）和持续部署（Continuous Deployment，CD）工具。它帮助开发团队自动化构建、测试和部署过程，以确保软件项目的质量和快速交付。</p></blockquote><p>其实就是类似于Jenkins的CI/CD工具，但界面更加美化，操作更简单，今天就来尝试一下使用teamcity自动构建部署Go程序。</p><h2 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h2><p>安装就不多说了，网上教程很多，各个环境的都有，我是mac环境，通过docker方式安装，按照下面这个教程来安装的：<br><a href="https://www.yuque.com/shuangyu-rcged/network/ueyyn4quawwbeyiw">https://www.yuque.com/shuangyu-rcged/network/ueyyn4quawwbeyiw</a><br>安装的镜像主要包含两部分：</p><ol><li><p>teamcity-server：<br>:::tips<br>teamcity的服务端部分，提供管理和操作<br>:::</p></li><li><p>teamcity-agent：<br>:::tips<br>作用是在 CI/CD 流程中负责具体的构建、测试和部署任务。TeamCity 是一个分布式 CI/CD 系统，可以在多个 Agent 上并行执行构建任务，提高了构建和测试的效率</p></li><li><p>构建代码： TeamCity Agent 负责拉取源代码，并在本地环境中进行编译、构建、打包等操作，生成可执行文件、库文件或者其他构建产物。</p></li><li><p>运行测试： Agent 可以运行单元测试、集成测试等各种测试用例。它会执行预先配置好的测试任务，并将测试结果反馈给 TeamCity 服务器。</p></li><li><p>代码分析： TeamCity Agent 可以执行代码静态分析、代码质量检查等任务，帮助开发团队发现代码中的问题，提供代码质量报告。</p></li><li><p>部署应用程序： 在持续交付流程中，Agent 可以负责将构建好的应用程序部署到测试环境、预生产环境或生产环境中。这包括复制文件、设置配置、运行数据库迁移等操作。</p></li><li><p>执行自动化任务： TeamCity Agent 可以执行各种自动化任务，例如数据库迁移、静态文件生成、文档生成等，以便将应用程序部署到可运行状态。</p></li></ol><p>TeamCity Agent 与 TeamCity 服务器进行通信，接收来自服务器的构建任务，执行任务，然后将结果报告给服务器。它可以运行在不同的操作系统上，并且支持多种编程语言和构建工具。通过分布式部署，TeamCity Agent 能够提供高度可扩展性，以适应不同规模的项目和团队需求。<br>:::</p><p>如果是在本机安装则简单多了，直接解压运行即可：<br><a href="https://www.yuque.com/shuangyu-rcged/network/bwosfkchn7pwdatg">https://www.yuque.com/shuangyu-rcged/network/bwosfkchn7pwdatg</a></p><p>区别：<br>相较于docker安装，本机安装则更加简单，踩的坑很少，因为docker安装的话会缺少环境，导致go程序无法构建，要做很多步骤，这下面会说到<br>但折腾一番也不失为是件有意义的事情，折腾的过程其实就是学习新知识的过程</p><h2 id="二、在teamcity-agent上安装go环境"><a href="#二、在teamcity-agent上安装go环境" class="headerlink" title="二、在teamcity-agent上安装go环境"></a>二、在teamcity-agent上安装go环境</h2><p>这对我来说应该不是第二步，因为我踩过坑，知道有这么个问题，所以提前放到这里了</p><p>因为执行编译和构建的是teamcity-agent，所以只需要在agent上安装环境即可，安装方式就是进入docker容器的指令模式，进行安装：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">docker exec <span class="token operator">-</span>it <span class="token operator">-</span>u root <span class="token punctuation">&#123;</span>容器id<span class="token punctuation">&#125;</span> <span class="token operator">/</span>bin/bash</code></pre><p>注意登录的时候使用root身份登录，因为会有权限问题</p><p>然后就是正常的，在linux中安装go环境的步骤：</p><pre class="language-powershell" data-language="powershell"><code class="language-powershell">cd <span class="token operator">/</span>usr/localwget https:<span class="token operator">/</span><span class="token operator">/</span>dl<span class="token punctuation">.</span>google<span class="token punctuation">.</span>com/go/go1<span class="token punctuation">.</span>20<span class="token punctuation">.</span>5<span class="token punctuation">.</span>linux-arm64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gztar <span class="token operator">-</span>xvf go1<span class="token punctuation">.</span>20<span class="token punctuation">.</span>5<span class="token punctuation">.</span>linux-arm64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz<span class="token function">rm</span> <span class="token operator">-</span>rf go1<span class="token punctuation">.</span>20<span class="token punctuation">.</span>5<span class="token punctuation">.</span>linux-arm64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gzexport GOROOT=<span class="token operator">/</span>usr/local/goexport PATH=<span class="token variable">$PATH</span>:<span class="token variable">$GOROOT</span><span class="token operator">/</span>binexport GOPATH=<span class="token operator">/</span>home/goprojectexport GOPROXY=https:<span class="token operator">/</span><span class="token operator">/</span>goproxy<span class="token punctuation">.</span>cnexport GO111MODULE=ongo env</code></pre><p>能打印出go的环境信息就说明安装成功了</p><p>ok，本以为万事大吉，回到teamcity执行构建，发现还是报错：<strong>go not found</strong></p><p>再次进入docker容器，执行 go env 发现环境没有生效，期间找了很多网上资料，什么在 /root/.bashrc 中设置环境变量，在 /etc/bash.bashrc 中设置环境变量，虽然最后重新进入或者重启容器的确都能打印出环境变量，但到了teamcity中构建的时候还是 <strong>go not found</strong></p><p>着实费了一番功夫，其实要解决这个问题很简单，请看下面。</p><h2 id="三、在teamcity中创建项目并添加构建步骤"><a href="#三、在teamcity中创建项目并添加构建步骤" class="headerlink" title="三、在teamcity中创建项目并添加构建步骤"></a>三、在teamcity中创建项目并添加构建步骤</h2><p>在左上角创建一个项目，然后进入设置</p><h3 id="1、VCS设置"><a href="#1、VCS设置" class="headerlink" title="1、VCS设置"></a><strong>1、VCS设置</strong></h3><p>其实就是代码仓库，根据自己实际使用的平台设置即可，其它还有很多项目设置，因为是初步尝试，所以没有深入研究，就先不管了，这个就够用了<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1698979012994-5243269b-36be-4e27-9421-a555323f830e.png#averageHue=%23e4e3e2&clientId=u21b98660-fac4-4&from=paste&height=1405&id=u3f44f2db&originHeight=2810&originWidth=3736&originalType=binary&ratio=2&rotation=0&showTitle=false&size=1067209&status=done&style=none&taskId=u9f452eda-e2eb-482f-9503-00f1c307fba&title=&width=1868" alt="截屏2023-11-03 10.30.58.png"></p><h3 id="2、构建步骤设置"><a href="#2、构建步骤设置" class="headerlink" title="2、构建步骤设置"></a><strong>2、构建步骤设置</strong></h3><p>这一步就是真正对构建部署的设置，也是最重要的设置，点击 Build 设置里面的 Build Steps 即可出现设置界面，下面是我已经设置好的界面，总共有4个步骤：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1698979493321-1d5a3fca-7c2a-4e0a-a74e-67a319b6afa0.png#averageHue=%23fefefe&clientId=u21b98660-fac4-4&from=paste&height=704&id=uf3133242&originHeight=1408&originWidth=3140&originalType=binary&ratio=2&rotation=0&showTitle=false&size=454758&status=done&style=none&taskId=uc1773fba-a771-471f-b3d3-940e93b3a43&title=&width=1570" alt="截屏2023-11-03 10.44.42.png"></p><p>构建流程规划：<br>这里没有打包成docker，走的还是最原始的编译运行的形式，其大致流程如下<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1698980102104-d00ddd6f-900b-4894-9e54-aa7a29caa8cf.png#averageHue=%23fcfaf9&clientId=u21b98660-fac4-4&from=paste&height=308&id=u61f89dc6&originHeight=616&originWidth=1990&originalType=binary&ratio=2&rotation=0&showTitle=false&size=86568&status=done&style=none&taskId=u41f5486e-4ac1-40ee-be3f-7944a84bb89&title=&width=995" alt="构建流程.png"></p><p>然后看下我的测试项目结构：<br>dockerfile忽略，这次还没用到，主要的就是main.go、和start.sh这两个文件，前者是程序，后者是快速运行程序的脚本，注意开启go.mod，不然在agent中编译的时候还得自己手动下载包<br><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1698980359802-8725a461-7cd6-42f9-a9fd-b53b8ec6f9bf.png#averageHue=%23e5e5e5&clientId=u21b98660-fac4-4&from=paste&height=194&id=u88ffc68c&originHeight=388&originWidth=312&originalType=binary&ratio=2&rotation=0&showTitle=false&size=25954&status=done&style=none&taskId=u438755bc-5756-45f8-af8f-9f7c1709ebf&title=&width=156" alt="image.png"></p><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token string">"github.com/gin-gonic/gin"</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    router <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    router<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">&#123;</span>            <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Luckly Successful!"</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    err <span class="token operator">:=</span> router<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">":7788"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"Run services error"</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span><span class="token assign-left variable">current_date</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +%Y-%m-%d<span class="token variable">`</span></span><span class="token function">sudo</span> <span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token variable"><span class="token variable">$(</span>pidof /Users/yuyuyu/tmp/test_go_teamcity/test_go_teamcity<span class="token variable">)</span></span><span class="token function">sudo</span> <span class="token function">nohup</span> /Users/yuyuyu/tmp/test_go_teamcity/test_go_teamcity  <span class="token operator">></span> /Users/yuyuyu/tmp/test_go_teamcity/test_go_teamcity-<span class="token variable">$&#123;current_date&#125;</span>.log  <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span></code></pre><p>再回到构建步骤，一步步分析：</p><h4 id="2-1-编译"><a href="#2-1-编译" class="headerlink" title="2.1 编译"></a>2.1 编译</h4><p><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1698980927698-03614570-f629-4f4a-af6f-f4eb5a185c50.png#averageHue=%23fefefe&clientId=u21b98660-fac4-4&from=paste&height=927&id=ua1e5107e&originHeight=1854&originWidth=3240&originalType=binary&ratio=2&rotation=0&showTitle=false&size=485550&status=done&style=none&taskId=u9439dc19-a5c2-4569-bfb0-b227bbbc06d&title=&width=1620" alt="image.png"></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">GOROOT</span><span class="token operator">=</span>/usr/local/go<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$GOROOT</span>/bin<span class="token builtin class-name">export</span> <span class="token assign-left variable">GOPATH</span><span class="token operator">=</span>/home/goproject<span class="token builtin class-name">export</span> <span class="token assign-left variable">GOPROXY</span><span class="token operator">=</span>https://goproxy.cn<span class="token builtin class-name">export</span> <span class="token assign-left variable">GO111MODULE</span><span class="token operator">=</span>on<span class="token function">rm</span> <span class="token parameter variable">-rf</span> .git<span class="token function">rm</span> <span class="token parameter variable">-rf</span> .gitignore<span class="token function">rm</span> <span class="token parameter variable">-rf</span> README.mdgo mod tidy<span class="token assign-left variable">GOOS</span><span class="token operator">=</span>darwin <span class="token assign-left variable">GOARCH</span><span class="token operator">=</span>arm64 go build <span class="token parameter variable">-a</span> <span class="token parameter variable">-o</span> test_go_teamcity main.go</code></pre><p>上面不是说在agent中装好go环境后，怎么构建都报 go not found 的错误吗，这里只要每次构建的时候加上设置环境变量的指令就行了<br>agent会将代码仓库的代码拉取到它本地，<code>/opt/buildagent/work</code> 中的某个项目目录，然后执行 go build 编译就行了<br>这里我加了交叉编译，因为远程服务器设置的是我自己的电脑，要在mac上执行，不加的话是运行不了的</p><h4 id="2-2-打包"><a href="#2-2-打包" class="headerlink" title="2.2 打包"></a>2.2 打包</h4><p>构建类型跟上一步一样，也选择 ‘Command Line’类型，执行指令如下：</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-cvf</span> test_go_teamcity.tar.gz start.sh test_go_teamcity</code></pre><p>最终编译好之后我们需要的只有执行程序test_go_teamcity和start.sh，将这两个文件打包就行了</p><h4 id="2-3-上传"><a href="#2-3-上传" class="headerlink" title="2.3 上传"></a>2.3 上传</h4><p><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1698981742298-7f3c4ec6-fbbe-43e0-a8ad-546edd4aab02.png#averageHue=%23e6c57e&clientId=u21b98660-fac4-4&from=paste&height=909&id=u211d023f&originHeight=1818&originWidth=3022&originalType=binary&ratio=2&rotation=0&showTitle=false&size=429014&status=done&style=none&taskId=uea42cf5a-2ab3-452f-9b7d-1a7b4d9aadc&title=&width=1511" alt="image.png"><br>将打包好的压缩包上传到远程服务器，就是线上环境，这里测试我用的是自己的电脑，其中<br><strong>Target</strong>：格式是 [服务器ip:上传文件放置的位置]，是服务器的地址<br><strong>Paths to sources</strong>：源文件的位置，%system.teamcity.build.workingDir% 就是这个项目工作目录，最终就是 /opt/buildagent/work/aebbfdbb93b9d7dc/test_go_teamcity.tar.gz<br>用户名密码就是远程服务器的用户名密码</p><h4 id="2-4-运行"><a href="#2-4-运行" class="headerlink" title="2.4 运行"></a>2.4 运行</h4><p><img src="https://cdn.nlark.com/yuque/0/2023/png/115159/1698982120900-c5bec2a9-1135-4446-8aac-5f53c0f8f494.png#averageHue=%23e5c47e&clientId=u21b98660-fac4-4&from=paste&height=763&id=u57dc4e20&originHeight=1526&originWidth=2656&originalType=binary&ratio=2&rotation=0&showTitle=false&size=328331&status=done&style=none&taskId=u93ed0818-19c9-426c-92d8-7b0a019f80f&title=&width=1328" alt="image.png"></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /Users/jyj/tmp/test_go_teamcity<span class="token function">sudo</span> <span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> test_go_teamcity.tar.gz<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> test_go_teamcity.tar.gz<span class="token function">sudo</span> <span class="token function">chmod</span> +x test_go_teamcity<span class="token function">sudo</span> <span class="token function">chmod</span> +x start.sh<span class="token function">sudo</span> ./start.sh</code></pre><p>在远程服务器上执行的命令，也就是解压缩刚才传过来的包，然后运行程序即可，注意权限问题</p><h2 id="四、结束"><a href="#四、结束" class="headerlink" title="四、结束"></a>四、结束</h2><p>最后在浏览器输入 <a href="http://localhost:7788/">http://localhost:7788</a><br>看一下运行成功了没</p><p>teamcity初尝试就到此为止了，总体用下来操作还是很简单的，界面也美观，跟jenkins比各有优劣，还有很多功能后续慢慢再试验</p><p><strong>如果想要以先编译再上传运行的方式部署Go程序的话，可以把go环境安装好的teamcity-agent容器打包成镜像，上传到自己的仓库，方便下次使用</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;首先介绍一下TeamCity是什么：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;TeamCity 是一款由 JetBrains 开发的强大的持续集成（Continuous Integration，CI）和持续部署（Continuous Deployment，CD）工具。它帮助</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Go" scheme="https://shuangdeyu.github.io/tags/Go/"/>
    
    <category term="CI/CD" scheme="https://shuangdeyu.github.io/tags/CI-CD/"/>
    
  </entry>
  
  <entry>
    <title>mysql开发规范</title>
    <link href="https://shuangdeyu.github.io/2021/01/26/mysql-kai-fa-gui-fan/"/>
    <id>https://shuangdeyu.github.io/2021/01/26/mysql-kai-fa-gui-fan/</id>
    <published>2021-01-25T16:00:00.000Z</published>
    <updated>2023-12-21T06:48:45.914Z</updated>
    
    <content type="html"><![CDATA[<p>非原创，引用自阿里的《java开发手册》中的mysql数据库规范，这里做个记录和参考。</p><h2 id="建表规约"><a href="#建表规约" class="headerlink" title="建表规约"></a>建表规约</h2><p>1、 【<strong>强制</strong>】 表达是与否概念的字段，必须使用 is_xxx 的方式命名，数据类型是 unsigned tinyint（1 表示是，0 表示否）。或者无其他表示类型、状态的情况下，也可以用 status 命名，数据类型是 enum （Y 表示是，N 表示否）。</p><blockquote><p>说明：任何字段如果为非负数，必须是 unsigned 。<br>注意： 数据库表示是与否的值，使用 tinyint 类型，坚持 is_xxx 的命名方式是为了明确其取值含义与取值范围。<br>正例：表达逻辑删除的字段名 is_deleted ，1 表示删除，0 表示未删除。</p></blockquote><p>2、【<strong>强制</strong>】 表名、字段名必须使用小写字母或数字，禁止出现数字开头，禁止两个下划线中间只出现数字。数据库字段名的修改代价很大，因为无法进行预发布，所以字段名称需要慎重考虑。</p><blockquote><p>说明： MySQL 在 Windows 下不区分大小写，但在 Linux 下默认是区分大小写。因此，数据库名、表名、字段名，都不允许出现任何大写字母，避免节外生枝。<br>正例： aliyun_admin ， rdc_config ，level3_name<br>反例： AliyunAdmin ， rdcConfig ， level_3_name</p></blockquote><p>3、 【<strong>强制</strong>】 表名不使用复数名词。</p><blockquote><p>说明：表名应该仅仅表示表里面的实体内容，不应该表示实体数量，对应于 DO 类名也是单数形式，符合表达习惯。</p></blockquote><p>4、 【<strong>强制</strong>】 禁用保留字，如 desc 、 range 、 match 、 delayed 等，请参考 MySQL 官方保留字。</p><p>5、 【<strong>强制</strong>】 主键索引名为 pk_ 字段名；唯一索引名为 uk_字段名 ； 普通索引名则为 idx_字段名。</p><blockquote><p>说明： pk_  即 primary key；uk_ 即  unique key；idx_ 即 index 的简称。</p></blockquote><p>6、 【<strong>强制</strong>】 小数类型为 decimal ，禁止使用 float 和 double 。</p><blockquote><p>说明： float 和 double 在存储的时候，存在精度损失的问题，很可能在值的比较时，得到不正确的结果。如果存储的数据范围超过 decimal 的范围，建议将数据拆成整数和小数分开存储。</p></blockquote><p>7、 【<strong>强制</strong>】 如果存储的字符串长度几乎相等，使用 char 定长字符串类型。</p><p>8、 【<strong>强制</strong>】 varchar 是可变长字符串，不预先分配存储空间，长度不要超过 5000，如果存储长度大于此值，定义字段类型为 text ，独立出来一张表，用主键来对应，避免影响其它字段索引效率。</p><p>9、 【<strong>强制</strong>】 表必备三字段： id ,  gmt_create ,  gmt_modified 。</p><blockquote><p>说明：其中 id 必为主键，类型为 bigint unsigned 、单表时自增、步长为 1。 gmt_create,gmt_modified 的类型均为 datetime 类型，前者现在时表示主动创建，后者过去分词表示被动更新。</p></blockquote><p>10、 【<strong>推荐</strong>】 表的命名最好是加上“业务名称_表的作用”，或者加上表示库名的前缀。</p><blockquote><p>正例： alipay_task /  force_project /  trade_config / s_config</p></blockquote><p>11、 【<strong>推荐</strong>】 库名与应用名称尽量一致。</p><p>12、 【<strong>推荐</strong>】 如果修改字段含义或对字段表示的状态追加时，需要及时更新字段注释。</p><p>13、 【<strong>推荐</strong>】 字段允许适当冗余，以提高查询性能，但必须考虑数据一致。冗余字段应遵循：</p><blockquote><ol><li>不是频繁修改的字段。</li><li>不是 varchar 超长字段，更不能是 text 字段。<br>正例：商品类目名称使用频率高，字段长度短，名称基本一成不变，可在相关联的表中冗余存储类目名称，避免关联查询。</li></ol></blockquote><p>14、 【<strong>推荐</strong>】 单表行数超过 500 万行或者单表容量超过 2 GB ，才推荐进行分库分表。</p><blockquote><p>说明：如果预计三年后的数据量根本达不到这个级别，请不要在创建表时就分库分表。</p></blockquote><p>15、 【<strong>推荐</strong>】 合适的字符存储长度，不但节约数据库表空间、节约索引存储，更重要的是提升检索速度。</p><blockquote><p>正例：如下表，其中无符号值可以避免误存负数，且扩大了表示范围。</p></blockquote><table><thead><tr><th>对象</th><th>年龄区间</th><th>类型</th><th>字节</th><th>表示范围</th></tr></thead><tbody><tr><td>人</td><td>150岁之内</td><td>tinyint unsigned</td><td>1</td><td>无符号值：0 到 255</td></tr><tr><td>龟</td><td>数百岁</td><td>smallint unsigned</td><td>2</td><td>无符号值：0 到 65535</td></tr><tr><td>恐龙化石</td><td>数千万年</td><td>int unsigned</td><td>4</td><td>无符号值：0 到约 42.9 亿</td></tr><tr><td>太阳</td><td>约 50 亿年</td><td>bigint unsigned</td><td>8</td><td>无符号值：0 到约 10 的 19 次方</td></tr></tbody></table><h2 id="索引规约"><a href="#索引规约" class="headerlink" title="索引规约"></a>索引规约</h2><p>1、 【<strong>强制</strong>】 业务上具有唯一特性的字段，即使是多个字段的组合，也必须建成唯一索引。</p><blockquote><p>说明：不要以为唯一索引影响了 insert 速度，这个速度损耗可以忽略，但提高查找速度是明显的 ； 另外，即使在应用层做了非常完善的校验控制，只要没有唯一索引，根据墨菲定律，必然有脏数据产生。</p></blockquote><p>2、 【<strong>强制</strong>】 超过三个表禁止 join 。需要 join 的字段，数据类型必须绝对一致 ； 多表关联查询时，保证被关联的字段需要有索引。</p><blockquote><p>说明：即使双表 join 也要注意表索引、 SQL 性能。</p></blockquote><p>3、 【<strong>强制</strong>】 在 varchar 字段上建立索引时，必须指定索引长度，没必要对全字段建立索引，根据实际文本区分度决定索引长度即可。</p><blockquote><p>说明：索引的长度与区分度是一对矛盾体，一般对字符串类型数据，长度为 20 的索引，区分度会高达 90%以上，可以使用 count(distinct left( 列名, 索引长度 )) / count( * ) 的区分度来确定。</p></blockquote><p>4、 【<strong>强制</strong>】 页面搜索严禁左模糊或者全模糊，如果需要请走搜索引擎来解决。</p><blockquote><p>说明：索引文件具有 B - Tree 的最左前缀匹配特性，如果左边的值未确定，那么无法使用此索引。</p></blockquote><p>5、 【<strong>推荐</strong>】 如果有 order by 的场景，请注意利用索引的有序性。 order by 最后的字段是组合索引的一部分，并且放在索引组合顺序的最后，避免出现 file_sort 的情况，影响查询性能。</p><blockquote><p>正例： where a =?  and b =?  order by c; 索引： a_b_c<br>反例：索引中有范围查找，那么索引有序性无法利用，如： WHERE a &gt;10  ORDER BY b; 索引a_b 无法排序。</p></blockquote><p>6、 【<strong>推荐</strong>】 利用覆盖索引来进行查询操作，避免回表。</p><blockquote><p>说明：如果一本书需要知道第 11 章是什么标题，会翻开第 11 章对应的那一页吗？目录浏览一下就好，这个目录就是起到覆盖索引的作用。<br>正例：能够建立索引的种类分为主键索引、唯一索引、普通索引三种，而覆盖索引只是一种查询的一种效果，用 explain 的结果， extra 列会出现： using index 。</p></blockquote><p>7、 【<strong>推荐</strong>】 利用延迟关联或者子查询优化超多分页场景。</p><blockquote><p>说明： MySQL 并不是跳过 offset 行，而是取 offset + N 行，然后返回放弃前 offset 行，返回N 行，那当 offset 特别大的时候，效率就非常的低下，要么控制返回的总页数，要么对超过特定阈值的页数进行 SQL 改写。<br>正例：先快速定位需要获取的 id 段，然后再关联：<br>SELECT a.* FROM 表 1 a, (select id from 表 1 where 条件 LIMIT 100000,20 ) b where a.id=b.id</p></blockquote><p>8、 【<strong>推荐</strong>】 SQL 性能优化的目标：至少要达到  range 级别，要求是 ref 级别，如果可以是 consts最好。</p><blockquote><p>说明：</p><ol><li>consts 单表中最多只有一个匹配行 （ 主键或者唯一索引 ） ，在优化阶段即可读取到数据。</li><li>ref 指的是使用普通的索引 （normal index） 。</li><li>range 对索引进行范围检索。<br>反例： explain 表的结果， type = index ，索引物理文件全扫描，速度非常慢，这个 index 级别比较 range 还低，与全表扫描是小巫见大巫。</li></ol></blockquote><p>9、 【<strong>推荐</strong>】 建组合索引的时候，区分度最高的在最左边。</p><blockquote><p>正例：如果 where a =?  and b =? ，如果 a 列的几乎接近于唯一值，那么只需要单建 idx_a索引即可。<br>说明：存在非等号和等号混合时，在建索引时，请把等号条件的列前置。如： where c &gt;?  and d =? 那么即使 c 的区分度更高，也必须把 d 放在索引的最前列，即索引 idx_d_c。</p></blockquote><p>10、 【<strong>推荐</strong>】 防止因字段类型不同造成的隐式转换，导致索引失效。</p><p>11、 【<strong>参考</strong>】 创建索引时避免有如下极端误解：</p><blockquote><ol><li>宁滥勿缺。认为一个查询就需要建一个索引。</li><li>宁缺勿滥。认为索引会消耗空间、严重拖慢更新和新增速度。</li><li>抵制惟一索引。认为业务的惟一性一律需要在应用层通过“先查后插”方式解决。</li></ol></blockquote><h2 id="SQL语句"><a href="#SQL语句" class="headerlink" title="SQL语句"></a>SQL语句</h2><p>1、 【强制】 不要使用 count(列名) 或 count(常量) 来替代 count(＊) ， count(＊) 是 SQL92 定义的标准统计行数的语法，跟数据库无关，跟 NULL 和非 NULL 无关。</p><blockquote><p>说明： count(*) 会统计值为 NULL 的行，而 count( 列名 ) 不会统计此列为 NULL 值的行。</p></blockquote><p>2、 【<strong>强制</strong>】 count(distinct col) 计算该列除 NULL 之外的不重复行数，注意  count(distinct col 1,  col 2 ) 如果其中一列全为 NULL ，那么即使另一列有不同的值，也返回为 0。</p><p>3、 【<strong>强制</strong>】 当某一列的值全是 NULL 时， count(col) 的返回结果为 0，但 sum(col) 的返回结果为NULL ，因此使用 sum() 时需注意 NPE 问题。</p><blockquote><p>正例：可以使用如下方式来避免 sum 的 NPE 问题： SELECT IF(ISNULL(SUM(g)) ,0, SUM(g)) FROM table;</p></blockquote><p>4、 【<strong>强制</strong>】使用 ISNULL() 来判断是否为 NULL 值。</p><blockquote><p>说明： NULL 与任何值的直接比较都为 NULL。<br>1 ） NULL&lt;&gt;NULL 的返回结果是 NULL ，而不是 false 。<br>2 ） NULL=NULL 的返回结果是 NULL ，而不是 true 。<br>3 ） NULL&lt;&gt;1 的返回结果是 NULL ，而不是 true 。</p></blockquote><p>5、 【<strong>强制</strong>】 在代码中写分页查询逻辑时，若 count 为 0 应直接返回，避免执行后面的分页语句。</p><p>6、 【<strong>强制</strong>】不得使用外键与级联，一切外键概念必须在应用层解决。</p><blockquote><p>说明：以学生和成绩的关系为例，学生表中的 student_id 是主键，那么成绩表中的 student_id 则为外键。如果更新学生表中的 student_id ，同时触发成绩表中的 student_id 更新，即为级联更新。外键与级联更新适用于单机低并发，不适合分布式、高并发集群 ； 级联更新是强阻塞，存在数据库更新风暴的风险 ； 外键影响数据库的插入速度。</p></blockquote><p>7、 【<strong>强制</strong>】禁止使用存储过程，存储过程难以调试和扩展，更没有移植性。</p><p>8、 【<strong>强制</strong>】数据订正（特别是删除、修改记录操作）时，要先 select ，避免出现误删除，确认无误才能执行更新语句。</p><p>9、 【<strong>推荐</strong>】 in 操作能避免则避免，若实在避免不了，需要仔细评估 in 后边的集合元素数量，控制在 1000 个之内。</p><p>10、 【<strong>参考</strong>】如果有国际化需要，所有的字符存储与表示，均以 utf-8 编码，注意字符统计函数的区别。</p><blockquote><p>说明：<br>SELECT LENGTH( “轻松工作” )； 返回为 12<br>SELECT CHARACTER _ LENGTH( “轻松工作” )； 返回为 4<br>如果需要存储表情，那么选择 utf8mb 4 来进行存储，注意它与 utf-8 编码的区别。</p></blockquote><p>11、 【<strong>参考</strong>】  TRUNCATE TABLE 比  DELETE 速度快，且使用的系统和事务日志资源少，但 TRUNCATE 无事务且不触发 trigger ，有可能造成事故，故不建议在开发代码中使用此语句。</p><blockquote><p>说明： TRUNCATE TABLE 在功能上与不带  WHERE 子句的  DELETE 语句相同。</p></blockquote><h2 id="ORM-映射"><a href="#ORM-映射" class="headerlink" title="ORM  映射"></a>ORM  映射</h2><p>以下有众多名词属于java技术栈，请根据自己使用的语言对照参考</p><p>1、 【<strong>强制</strong>】在表查询中，一律不要使用 * 作为查询的字段列表，需要哪些字段必须明确写明。</p><blockquote><p>说明：<br>1 ） 增加查询分析器解析成本。<br>2 ） 增减字段容易与 resultMap 配置不一致。<br>3）无用字段增加网络消耗，尤其是 text 类型的字段。</p></blockquote><p>2、 【<strong>强制</strong>】 POJO 类的布尔属性不能加 is ，而数据库字段必须加 is_，要求在 resultMap 中进行字段与属性之间的映射。</p><blockquote><p>说明：参见定义 POJO 类以及数据库字段定义规定，在 resultMap 中 增加映射，是必须的。在 MyBatis Generator 生成的代码中，需要进行对应的修改。</p></blockquote><p>3、 【<strong>强制</strong>】不要用 resultClass 当返回参数，即使所有类属性名与数据库字段一一对应，也需要定义 ； 反过来，每一个表也必然有一个 POJO 类与之对应。</p><blockquote><p>说明：配置映射关系，使字段与 DO 类解耦，方便维护。</p></blockquote><p>4、 【<strong>强制</strong>】sql. xml 配置参数使用：#{}，#param# 不要使用 ${} 此种方式容易出现 SQL 注入。</p><p>5、 【<strong>强制</strong>】 iBATIS 自带的 queryForList(String statementName , int start , int size) 不推荐使用。</p><blockquote><p>说明：其实现方式是在数据库取到 statementName 对应的 SQL 语句的所有记录，再通过 subList 取 start , size 的子集合。<br>正例：<br>    Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();<br>    map.put(“start”, start);<br>    map.put(“size”, size);</p></blockquote><p>6、 【<strong>强制</strong>】不允许直接拿 HashMap 与 Hashtable 作为查询结果集的输出。</p><blockquote><p>说明： resultClass=”Hashtable” ，会置入字段名和属性值，但是值的类型不可控。</p></blockquote><p>7、 【<strong>强制</strong>】更新数据表记录时，必须同时更新记录对应的 gmt _ modified 字段值为当前时间。</p><p>8、 【<strong>推荐</strong>】不要写一个大而全的数据更新接口。传入为 POJO 类，不管是不是自己的目标更新字段，都进行 update table set c1=value1,c2=value2,c3=value3;  这是不对的。执行 SQL 时，不要更新无改动的字段，一是易出错 ； 二是效率低 ； 三是增加 binlog 存储。</p><p>9、 【<strong>参考</strong>】@Transactional 事务不要滥用。事务会影响数据库的 QPS ，另外使用事务的地方需要考虑各方面的回滚方案，包括缓存回滚、搜索引擎回滚、消息补偿、统计修正等。</p><p>10、 【<strong>参考</strong>】&lt; isEqual &gt;中的 compareValue 是与属性值对比的常量，一般是数字，表示相等时带上此条件 ； <isNotEmpty> 表示不为空且不为 null 时执行 ； <isNotNull> 表示不为 null 值时执行。</p><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><p>1、 【<strong>强制</strong>】 数据库设计过程中需要做好注释，记录设计文档，文档类型不限，可以是excel也可以是其它，方便浏览整体的数据库结构。</p><p>2、 【<strong>强制</strong>】 数据库设计好之后由设计人员进行讲解，讲解方式不限，可以是开会，也可以是单独讲解，但必须有讲解过程让参与开发的人员熟悉。</p><p>3、 【<strong>强制</strong>】 由于多人协作开发，所以任何的数据修改都必须在指定的项目群里通知到位，有歧义的需要讨论之后才能确定修改。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;非原创，引用自阿里的《java开发手册》中的mysql数据库规范，这里做个记录和参考。&lt;/p&gt;
&lt;h2 id=&quot;建表规约&quot;&gt;&lt;a href=&quot;#建表规约&quot; class=&quot;headerlink&quot; title=&quot;建表规约&quot;&gt;&lt;/a&gt;建表规约&lt;/h2&gt;&lt;p&gt;1、 【&lt;strong</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Mysql" scheme="https://shuangdeyu.github.io/tags/Mysql/"/>
    
  </entry>
  
  <entry>
    <title>记录平时遇到的问题(1)</title>
    <link href="https://shuangdeyu.github.io/2021/01/21/ji-lu-ping-shi-yu-dao-de-wen-ti-1/"/>
    <id>https://shuangdeyu.github.io/2021/01/21/ji-lu-ping-shi-yu-dao-de-wen-ti-1/</id>
    <published>2021-01-20T16:00:00.000Z</published>
    <updated>2023-12-21T06:59:20.599Z</updated>
    
    <content type="html"><![CDATA[<p>记录一下自己平时开发过程中遇到的问题，和一些思考总结，有些问题可能是反复遇到的，有个记录下次查找起来也方便。</p><h2 id="mysql连接数调不上去"><a href="#mysql连接数调不上去" class="headerlink" title="mysql连接数调不上去"></a>mysql连接数调不上去</h2><p>修改mysql的配置文件my.cnf，发现其中的连接数、打开文件数等多个配置怎么调都是固定的，起初以为是my.cnf未生效导致的，所以按照这个思路花了大量的时间去寻找解决方法。</p><p>最后还是没有解决问题，后来偶然的实验下，发现通过<code>SET GLOBAL max_connections = 100000;</code>指令设置的方式也无法改变连接数。</p><p>再往下实验，发现设置为一个小一点的数值却成功了，这时候才发觉应该是哪里有一个最大数限制了，循着这个思路去找，果然找到了真正的原因，原来是<code>mysqld.service</code>服务文件中有一个’<strong>LimitNOFILE</strong>‘参数限制了最大文件数。</p><p>但是 max_connections 上限为100000，目前mysql最新版本是8，其上限值也是100000。</p><p><strong>解决方法：</strong> 查找 mysqld.service 启动文件，将文件中的参数<code>LimitNOFILE</code>调整为系统允许范围内的较高数值，然后通过<code>systemctl daemon-reload</code>更新下启动文件，再重启mysql服务即可。</p><p><strong>总结：</strong> 查找，定位问题的时候，需要灵活反向思考，如果一个方向很久都查不出问题，那就往反方向思考一下，既然往高了调参数没什么变化，那么，试一下往低了调？</p><h2 id="数据库大量并发写操作会导致程序堵塞很卡"><a href="#数据库大量并发写操作会导致程序堵塞很卡" class="headerlink" title="数据库大量并发写操作会导致程序堵塞很卡"></a>数据库大量并发写操作会导致程序堵塞很卡</h2><p>实际项目中发现mysql的写性能很低，大量并发写的时候会很慢，导致程序卡死，接口响应慢等问题。</p><p><strong>解决方法：</strong> 避免并发写，销峰处理，可以使用队列的方式，等请求完成后延后写入数据库。</p><p>已经实践并解决的方式是使用redis的list格式进行处理，将定时读取时间内的缓存队列读取出来，拼接成批量插入的sql语句，直到本次读取队列中没有数据的时候，执行插入语句，既避免了接口处理的时候执行插入操作，也避免了单条数据的插入。</p><h2 id="redis并发写入数据丢失"><a href="#redis并发写入数据丢失" class="headerlink" title="redis并发写入数据丢失"></a>redis并发写入数据丢失</h2><p>使用 redis 的 list 类型做消息队列，通过这个队列将要写到 mysql 的数据延后批量写入。</p><p>使用 jmeter 测并发的时候发现，10000 线程的时候，写到 redis 的数据会丢失，而且丢失数量是不规则的； 5000 线程以内则一切正常。</p><p>首先查看连接数是否配置足够高，发现redis.conf中的连接数往高了调不会生效，与mysql连接数调不上去的问题类似，果然发现redis还有个隐藏的limit.conf限制了最高连接数，参数同样是<code>LimitNOFILE</code>。</p><p>连接数调整后发现还是没解决问题，继续观察发现代码没有打印抛出错误信息，加上后打印错误信息是<code>connection pool timeout</code>，应该是连接池的问题。</p><p><strong>解决方法：</strong> 修改redis的limit.conf中的<code>LimitNOFILE</code>参数，配置文件参考路径为<code>/etc/systemd/system/redis-sentinel.service.d/limit.conf</code>。</p><p>程序中建立连接的时候在<code>redis.Options</code>中配置连接池等属性即可，参考代码如下：</p><pre class="language-go" data-language="go"><code class="language-go">RedisClient <span class="token operator">=</span> redis<span class="token punctuation">.</span><span class="token function">NewClient</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>redis<span class="token punctuation">.</span>Options<span class="token punctuation">&#123;</span>Network<span class="token punctuation">:</span>     <span class="token string">"tcp"</span><span class="token punctuation">,</span>Addr<span class="token punctuation">:</span>        <span class="token function">LoadIni</span><span class="token punctuation">(</span><span class="token string">"Redis"</span><span class="token punctuation">,</span> <span class="token string">"redis_host"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Password<span class="token punctuation">:</span>    <span class="token function">LoadIni</span><span class="token punctuation">(</span><span class="token string">"Redis"</span><span class="token punctuation">,</span> <span class="token string">"redis_password"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>DB<span class="token punctuation">:</span>          comhelper<span class="token punctuation">.</span><span class="token function">StringToInt</span><span class="token punctuation">(</span><span class="token function">LoadIni</span><span class="token punctuation">(</span><span class="token string">"Redis"</span><span class="token punctuation">,</span> <span class="token string">"redis_database"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>DialTimeout<span class="token punctuation">:</span> time<span class="token punctuation">.</span><span class="token function">Duration</span><span class="token punctuation">(</span>comhelper<span class="token punctuation">.</span><span class="token function">StringToInt</span><span class="token punctuation">(</span><span class="token function">LoadIni</span><span class="token punctuation">(</span><span class="token string">"Redis"</span><span class="token punctuation">,</span> <span class="token string">"redis_timeout"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span>PoolSize<span class="token punctuation">:</span>     <span class="token number">10</span><span class="token punctuation">,</span>PoolTimeout<span class="token punctuation">:</span>  <span class="token number">2</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Minute<span class="token punctuation">,</span>IdleTimeout<span class="token punctuation">:</span>  <span class="token number">10</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Minute<span class="token punctuation">,</span>ReadTimeout<span class="token punctuation">:</span>  <span class="token number">2</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Minute<span class="token punctuation">,</span>WriteTimeout<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Minute<span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></code></pre><p><strong>总结：</strong> 写测试程序的时候也要严谨，抛出错误信息，观察测试结果要深入，发现测试结果的规律。</p><h2 id="后端的灵活配置"><a href="#后端的灵活配置" class="headerlink" title="后端的灵活配置"></a>后端的灵活配置</h2><p>后端需要做一些灵活配置的工作，来应对随时可能变动的需求</p><p>比如，将一些触发事件配置到数据库中，初始化的时候读取这些配置的事件，打入到代码中运行，然后做一个管理界面来管理这些事件的配置，一旦有增删改之后，重置程序中运行的事件信息即可，做到了灵活管控。</p><p>其它还有一些会变动的信息，比如帮助，协议等内容，也做到数据库中进行管控，这样需要改变的时候只要修改数据库中的数据就行了，不需要app上修改然后再次发布版本。</p><h2 id="TCP长连接采坑"><a href="#TCP长连接采坑" class="headerlink" title="TCP长连接采坑"></a>TCP长连接采坑</h2><p>问题描述：物联网设备与后端建立tcp长连接进行通信，车辆定时会上报车辆状态指令到服务器。</p><p>但这不是心跳，所以服务器没有回应车辆，一段时间之后（测下来是1小时多点），发现车辆中途自身ip会变，所以导致通信连接资源还是旧的，服务器发到车辆的数据实际上是发不出去的。</p><ul><li>tcp_keepalive_time</li></ul><p>tcp长连接的时候除了代码层面需要有心跳监测机制外，服务器(linux)内核也有个参数会对长连接进行监测，这个参数是<code>net.ipv4.tcp_keepalive_time</code>。</p><p>它指示TCP发送keepalive探测消息的间隔时间（秒），用于确认TCP连接是否有效，防止两边建立连接但不发送数据的攻击。超过这个值设定的时间未向服务器端发送数据，将会被‘切断’。</p><p>所以服务器内核<code>keepalive</code>相关参数需要配置合理。</p><ul><li>运营商问题</li></ul><p>车辆的连接ip是网络运营商提供的，国内运营商的超时时间一般是5分钟，超过时间未进行通信连接就会断开，这个因素也排除了，因为可以设置车辆小于5分钟上报指令。</p><p>但不排除运营商中途切换连接ip的行为，所以可能是运营商中途强制切了ip</p><ul><li>设备问题</li></ul><p>设备定时上报的时间间隔太长，导致连接被运营商或服务器断开，这个问题上面也描述过，可以修改定时上报的间隔；</p><p>看门狗问题，看门狗会导致设备重启重连等操作，这个也可以通过指令设置，可以排除掉。</p><ul><li>服务器问题</li></ul><p>服务器正常情况下不会主动踢掉连接，测试的时候本地开了四个客户端保持长连接，长时间之后没有发生断线的情况，而且收发正常。</p><p>所以考虑大概率是运营商强制切换了ip或者设备中控的问题（这些测试都是在心跳包没有开启的情况，即设备定时上报服务端没有回应应答）。</p><p>服务端优化：因为客户端中途换了ip，但是服务端检测到断线是在换ip之后的，所以没有执行掉线这个逻辑来清空连接的socket资源和重新建立连接资源。</p><p>所以在客户端换了ip之后服务端下发指令不成功，需要检测到掉线然后等到客户端下一条指令上报才能建立新的连接资源；优化根据客户端的ip判断服务端存储的资源是否匹配，不匹配的更新资源。</p><h2 id="TCP-连接出现大量的-connection-timed-out-错误"><a href="#TCP-连接出现大量的-connection-timed-out-错误" class="headerlink" title="TCP 连接出现大量的 connection timed out 错误"></a>TCP 连接出现大量的 connection timed out 错误</h2><p><strong>前提条件</strong>：服务器可打开文件数，最大连接数已经调到百万级别了，发起的tcp连接数是20000，为什么还会出现这么多连接超时呢？</p><p><strong>什么是connect timeout ?</strong> </p><p>也就是client 发出 syn 包，server端在你指定的时间内没有回复ack，一直连不上就导致连接超时了。server 端为什么没有回复ack。</p><p>因为syn包的回复是内核层的，要么网络层丢包，要么就是内核层back_log的queue(队列)满了。</p><p>然后查看TCP的内核参数 <code>tcp_max_syn_backlog</code></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">cat</span> /proc/sys/net/ipv4/tcp_max_syn_backlog</code></pre><p>发现只有128，这个参数的作用是设置对于还未获得对方确认的连接请求，可保存在队列中的最大数目，也就是<code>连接等待队列的长度</code>，数值越大，可容纳的连接数越多。</p><p>同时控制等待连接数的参数还有一个 <code>somaxconn</code>，光设置一个是不行的，这个参数定义了系统中每一个端口最大的监听队列的长度。</p><p>同时设置好以上两个参数的适当值后，就没出现连接超时了。</p><h2 id="慎用Golang的锁操作"><a href="#慎用Golang的锁操作" class="headerlink" title="慎用Golang的锁操作"></a>慎用Golang的锁操作</h2><p>在测试物联网设备TCP服务器高并发的时候遇到接口访问特别慢的问题，通过打时间点定位到了两个主要的问题</p><p>一 是大量的数据库操作随着并发增大拖垮了整体性能</p><p>二 发现有大量的时间卡在<code>UserConnInfo.Lock.Lock()</code>这条语句上，这是一个互斥锁的操作</p><p>所谓互斥锁，就是加锁之后，这个资源其它人就不能操作了，在大并发下，很容易在这里卡住时间</p><p>后来优化使用了读写锁，因为我们的TCP连接资源是读多写少的情况，写只是在客户端连接和离线的时候才会进行操作，而读却是每条指令上报上来都会进行操作的</p><p>所以这种情况更适合使用读写锁，读锁的时候并不会阻塞其它进程协程对同一个资源的读取，所以不会发生上面这种卡在Lock的情况。</p><p>其它需要注意的是：</p><p>1、锁操作用好后一定要释放</p><p>2、减少锁的持有时间，一般释放锁我们喜欢用<code>defer</code>来释放，但在return之前我们可能有很多不需要锁的操作，造成了时间上的浪费，看下面这个例子就清楚了</p><pre class="language-bash" data-language="bash"><code class="language-bash">func <span class="token function-name function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    m.Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>defer m.Unlock<span class="token punctuation">(</span><span class="token punctuation">)</span>    item :<span class="token operator">=</span> <span class="token punctuation">..</span>.    http.Get<span class="token punctuation">(</span><span class="token punctuation">)</span>  // 各种耗时的 IO 操作<span class="token punctuation">&#125;</span>// 改为func <span class="token function-name function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    m.Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>    item :<span class="token operator">=</span> <span class="token punctuation">..</span>.    m.Unlock<span class="token punctuation">(</span><span class="token punctuation">)</span>    http.Get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></code></pre><h2 id="善用解耦手段，保证主业务流程畅通"><a href="#善用解耦手段，保证主业务流程畅通" class="headerlink" title="善用解耦手段，保证主业务流程畅通"></a>善用解耦手段，保证主业务流程畅通</h2><p>还是以物联网设备TCP项目为例，高并发下写和更新数据库发生阻塞，这中间有竞争资源的锁操作，因为数据库的阻塞而造成程序中锁等待时间过长。</p><p>这时候客户调用api响应时间达到十秒这么长，造成了灾难性的体验。</p><p>所以需要考虑在调用设备控制api的这段过程中，能不能将数据库的相关业务解耦开，因为客户的主要体验是调用api，达到控制设备的目的，很多数据库操作是不需要实时的。</p><p>所以在数据库操作和设备指令的收发时的锁处理做了一个解耦操作，通过MQ队列到事件服务中处理数据库业务的操作。</p><p>在不考虑数据库的性能上，api可以非常快速的响应给客户，实现tcp通信的无阻塞，极大改善api的体验。</p><p>但数据库的阻塞会造成其它服务响应出现问题，也无法做到全部解耦，所以根源上解决还是需要处理大并发下的数据库优化问题</p><h2 id="Rabbitmq使用注意事项"><a href="#Rabbitmq使用注意事项" class="headerlink" title="Rabbitmq使用注意事项"></a>Rabbitmq使用注意事项</h2><p>Rabbitmq（以下简称mq）具有高并发的特性（天生具备高并发高可用的erlang语言编写），除此之外，还可以持久化，保证消息不易丢失，高可用，实现集群部署，提供灵活的路由和可靠性，可视化管理等等的优点，所以用它来做消息队列的处理具有足够可靠性。</p><p>在使用mq做消息延时功能的时候发现死信消息到期后无法转移的问题。</p><p>先解释下什么是死信消息，mq本身是不具备延时功能的，我们还可以通过ttl（设置超时时间）+ DLX（一个死信队列）+ Router（转发队列）的方式来实现延时功能。ttl可以设置在消息上，也可以设置在队列上。</p><p>那死信其实也就是一个普通的消息队列而已，它没有消费者，用来存储有超时时间的消息，并设置过期时间路由到哪一个队列，当消息到期后就会自动转移到转移队列中，转移队列有消费者进行消费，就实现了一个延时队列的功能。</p><p>上面说到ttl（过期时间）可以设置在消息上，也可以设置在队列上，无法转移的原因是过期时间设置在消息上了，但是每个消息的过期时间是不一致的，有可能过期时间长的消息先进入到队列里，队列是先进先出的，那么正常情况下所有的消息必须得等到头消息到期后，后续的过期消息才会自动转移到其它队列中。</p><p><strong>优化方法：</strong> 以过期时间为节点在队列上设置过期时间，比如有三条消息时间都为20秒，那么创建一个队列‘queue—20’，在队列上设置消息的过期时间为20秒。</p><p>并将消息推到‘queue—20’这个队列上，那么当不同时间的消息很多的话，创建的队列也会很多，所以这些队列都算临时队列，需要删除机制。</p><p>但是不能通过“auto_delete”这个属性来设置，因为死信队列是没有消费者的，“auto_delete”需要消费者解除绑定才会生效，只能通过队列的“x-expires”参数来设置。</p><p>但这个参数的数值要比过期时间长，不然最后一条消息会因为队列的删除而不会转移到转移队列中。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;记录一下自己平时开发过程中遇到的问题，和一些思考总结，有些问题可能是反复遇到的，有个记录下次查找起来也方便。&lt;/p&gt;
&lt;h2 id=&quot;mysql连接数调不上去&quot;&gt;&lt;a href=&quot;#mysql连接数调不上去&quot; class=&quot;headerlink&quot; title=&quot;mysql连</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="经验" scheme="https://shuangdeyu.github.io/tags/%E7%BB%8F%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>2020回顾</title>
    <link href="https://shuangdeyu.github.io/2021/01/13/2020-hui-gu/"/>
    <id>https://shuangdeyu.github.io/2021/01/13/2020-hui-gu/</id>
    <published>2021-01-12T16:00:00.000Z</published>
    <updated>2023-12-21T07:27:05.852Z</updated>
    
    <content type="html"><![CDATA[<p>又到了一年的结尾，最近几年除了应付公司的年终总结，没有自发地好好做过总结了，以致于一年一年就这样不明不白得过去了，回顾起来…都不知道能回顾啥，往往觉着这几年就像一片空白的历史，不可知，不可追溯，这是很可怕的一件事情，人生短短几十年，这些蒸发的年月日就像是我削减的寿命，不求事事俱细，但总得留下和记得些什么，总结和记录也不是非得年终来做。</p><p>2020是极其特殊的一年，不管是对我个人来说还是对全世界来说，疫情当头，生活多少都受到了点影响，好在国内都顺利过来了，虽然现在也挺严峻，现在回想起来也挺不真实的，这一年见证了多少个足以载入史册的重大事件，新冠疫情席卷全球、股市多次熔断、美国各种暴乱、英国完成脱欧、民典法颁布……总的来说，2020年对全世界来说并不好过，值得纪念吗？很值得，但并不愉快。</p><p>对我而言，这一年同样极其特殊，实现了我人生中的几大突破，当然也有迷茫过、不愉快过、怀疑过、放弃过等等负面情绪，我觉得我这一年可以用一个词来总结，那就是“<strong>幸福</strong>”。</p><article class="message message-immersive is-primary"><div class="message-body message-self"> <i class="fa fa-home" aria-hidden="true"></i> 家庭 </div></article><p>我想在往后的生活中，家庭会排在我心目中的第一位。</p><p>1月领证，合法同居，男女朋友升级为夫妻，当天也是惊心动魄，先是跑错了地方，再是户口本太旧需要换新，前后耽搁了许多时间，做完体检再跑去办事大厅已经是踩着他们下班的点了，好在复印店的小哥和民政工作人员善良，为我们加班办理，终于在这个相识7周年之日结为夫妻了，从此我算是有了真正意义上属于自己的家庭。</p><p>然后是国庆举办了我们的婚礼，不得不说办婚礼真是个费钱又费力的事情，更何况我还是两边各办一次，难怪之前参加同学朋友的婚礼的时候，他们都说累，这次算是切身体会到了，办完婚礼，这个婚也就圆满了，我的身份完成了一次突破和升级，从此我身上多了一个<strong>丈夫</strong>的标签。</p><p>万万没想到，我的身份即将再次迎来重大突破。</p><p>10月中旬发现老婆怀孕了，而且已经一个半月了，后知后觉的我们既惊喜又后怕，惊喜的是一个生命突然的降临，生活持续不断得有盼头，有期待，后怕的是这一个半月内她经历了两次婚礼的劳累，还有一次时长半天的爬山运动，明明已经有先兆流产的迹象了，我们还以为是太过劳累所致，怀孕的前三个月是最容易流产的，经过这一番折腾，这小东西还能如此顽强地成长，真想给他取名叫“坚强”。</p><p>有了孩子(虽然还没出生)之后，我自身发生了很多变化，首先是随之而来的压力，让我真正认识到我在这个家庭中需要担当的责任 —— 一切为了家人的幸福，有时候成长的确是一瞬间的事情，毕竟结完婚之后我还是没有那么强烈的紧迫感，整体还是很懒散的状态，现在不一样了，孩子还没出生，未来的很多事情都得开始思考和准备了。</p><p>其次是对待父母的心态发生了改变，说实话我跟父母的关系不是很亲密，马上就要成为父亲这个角色了，现在跟他们的很多交流会有意识地站在父亲的角度来思考，这也算是一种和解吧。</p><hr><article class="message message-immersive is-primary"><div class="message-body message-self"> <i class="fa fa-desktop" aria-hidden="true"></i> 工作 </div></article><p>这一年，工作上面有突破，而且是挺重要的突破，虽然这个突破不是很大。</p><p>但我觉得我今年的工作仍旧是“失败”的，因为对于工作的总结，总是不足大于收获，好坏都记个账吧。</p><p><strong>收获</strong></p><p>今年应该是我职业生涯以来最有突破性的一年，从纯开发转型到了技术管理（后端），当然开发在日常工作中占比仍旧很重。</p><p>很多之前理论性的知识在这一年中也得到了足够的实践：</p><ul><li>搭建了自动化部署系统，极大节省了人力、</li><li>搭建成熟的内部测试环境，方便开发人员的同时，避免出现环境不一致引起的无意义bug</li><li>进行了微服务的实践并且已经实现，成功搭建基于Go的一套微服务开发模式</li><li>向团队输出我觉得很有帮助的一些技术、理念和方法，比如自动部署的重要性、代码版本管理方式、大中台小前台的理念（没明确提出，但是一直在实践，比如微服务）、灵活配置的重要性等</li><li>。。。。。。</li></ul><p>在以上这些实践过程中，我自身的技术肯定是得到了一定的沉淀和积累，以前我只是这些技术中的一个纯使用者，现在，自信点，我能说我是一个初级架构者。</p><p>最宝贵的是，作为一个技术管理，我几乎参与了所有项目立项开始以来的讨论和整体的后端设计，任务分发等工作，这是很难得的经验，因为很多公司，大部分开发人员都只是执行者，没有很全面地参与到整个项目的流程中来，一般都是开发老大或者组长设计好相关架构后，再分配任务给相应的开发人员，那么开发人员实现的过程中由于没有了解项目整个的细节，往往会出现很多逻辑性的错误。</p><p>以上就是这一年的收获了吧，我觉得不多，更多的是自身个人技术的一个小突破，至于带给公司的帮助，应该说没有达到公司目前发展速度下近未来规划应有的技术支持。</p><p><strong>不足</strong></p><p>说实话，诚惶诚恐。</p><p>我觉得我还没有准备好做一个管理者，特别是技术管理者，因为我自身的技术还是比较浅薄的，远没有达到作为一个技术老大该有的储备，所以我常常在自我怀疑，我能够胜任这个职位吗？我能够把握住这个机会吗？我能够带好我的团队吗？</p><p>再加上我自身的性格和交流缺陷，就更让我深陷这种迷茫和怀疑，也让我对以后要走的路捉摸不定。</p><p>一方面想全身心的投入到技术提升上，毕竟过硬的技术是一切技术人员的基石，没有足够的技术储备，不管是提升技术研发的高度还是转型做技术管理，都会显得捉襟见肘。</p><p>另一方面又想抓住机会做管理，毕竟有了家庭，年龄也上来了，全身心研究技术的话肯定不像以前那样有那么多的时间和精力了，技术的瓶颈可能管理的瓶颈刻度更低，来得更快。</p><p>所以目前我仍旧处于一个非常尴尬的境地，做管理的同时也做了过多的研发工作，捉襟见肘之下导致两个都没有做的很好，我想不管是继续深入技术研发还是转型做技术管理，这是我目前急待解决的问题，有限的精力之下天平必定只能侧重一边。</p><hr><article class="message message-immersive is-primary"><div class="message-body message-self"> <i class="fa fa-book" aria-hidden="true"></i> 生活和学习 </div></article><p>今年的生活是美满的，干成了两件大事，买房和结婚，虽然日常偶尔也会有点烦恼和争吵，但大部分时候都是和谐的，和家里也没发生大的矛盾，总之，就是未来可期。</p><p>理财是我继家庭和工作之后计划投入的最重要的事情，今年可支配的资金一直很少，所以理财财报没有什么值得说道的地方，也没有继续深入地学习，但我觉得理财是可以做一辈子的事情，也是可以应对未来很多危机的方式，前提是学好理财，至少让自己在忙碌的工作之外还能有一份其它收入，多少暂且不论。</p><p>关于学习，今年算是毕业以来最糟糕的一年，没有完整地看完一本书，没有完整地看完一部学习视频，没有学习其它新东西，反而深陷游戏，虽然游戏之外写过游戏文章，做过游戏摄影，还想着做游戏视频，但基于本人比较浮躁，看不到短期的成果后逐渐放弃了。</p><hr><article class="message message-immersive is-primary"><div class="message-body message-self"> <i class="fa fa-edit" aria-hidden="true"></i> 计划 </div></article><p>明年就要当爸爸了，留给我的空余时间应该不会很多，这里就少立几个flag好了。</p><ul><li>看完至少五本书，小说不算</li><li>理财收益较今年翻一番，多研究，少操作</li><li>技术上实现至少一到两个大突破，方向还没想好</li><li>如果是个女儿，重新捡起摄影的爱好，给她拍美美的照片</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;又到了一年的结尾，最近几年除了应付公司的年终总结，没有自发地好好做过总结了，以致于一年一年就这样不明不白得过去了，回顾起来…都不知道能回顾啥，往往觉着这几年就像一片空白的历史，不可知，不可追溯，这是很可怕的一件事情，人生短短几十年，这些蒸发的年月日就像是我削减的寿命，不求事</summary>
      
    
    
    
    <category term="闲谈" scheme="https://shuangdeyu.github.io/categories/%E9%97%B2%E8%B0%88/"/>
    
    
    <category term="生活" scheme="https://shuangdeyu.github.io/tags/%E7%94%9F%E6%B4%BB/"/>
    
    <category term="总结" scheme="https://shuangdeyu.github.io/tags/%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>塞尔达传说.英杰之诗</title>
    <link href="https://shuangdeyu.github.io/2020/04/18/sai-er-da-chuan-shuo.ying-jie-zhi-shi/"/>
    <id>https://shuangdeyu.github.io/2020/04/18/sai-er-da-chuan-shuo.ying-jie-zhi-shi/</id>
    <published>2020-04-17T16:00:00.000Z</published>
    <updated>2023-12-22T07:12:02.956Z</updated>
    
    <content type="html"><![CDATA[<p>米法 —— 最柔之水<br>乌尔波扎 —— 最强之刀<br>达尔克尔 —— 最坚之盾<br>力巴尔 —— 最疾之箭</p><p><strong>敬四英杰</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-061529c1f1b43a1f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-feb11d66ff69eb75.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-d2f83cad8400612b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-accd955d02ee84f5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-8dba32873c007d72.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-11a78fb462ec2a19.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-cd9ec7faf8f2f6b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-c1cfcc2a19d822a4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-3274716209ad191c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-995ebc222130f54b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-f27045a054937c13.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-ecc22c64e75a5762.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-a81f97d46506cbb1.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-6fae910436ed4dac.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-0434203f1aa5a127.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-f29931d224c77537.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-18b40076c215a3c9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-5f6eae59d7cf2ae7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p><p><img src="https://upload-images.jianshu.io/upload_images/716745-7a421bfe50660873.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;米法 —— 最柔之水&lt;br&gt;乌尔波扎 —— 最强之刀&lt;br&gt;达尔克尔 —— 最坚之盾&lt;br&gt;力巴尔 —— 最疾之箭&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;敬四英杰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/</summary>
      
    
    
    
    <category term="游戏" scheme="https://shuangdeyu.github.io/categories/%E6%B8%B8%E6%88%8F/"/>
    
    
    <category term="Nintendo" scheme="https://shuangdeyu.github.io/tags/Nintendo/"/>
    
  </entry>
  
  <entry>
    <title>centos7 安装golang环境</title>
    <link href="https://shuangdeyu.github.io/2020/04/03/centos7-an-zhuang-golang-huan-jing/"/>
    <id>https://shuangdeyu.github.io/2020/04/03/centos7-an-zhuang-golang-huan-jing/</id>
    <published>2020-04-02T16:00:00.000Z</published>
    <updated>2023-12-20T08:34:12.413Z</updated>
    
    <content type="html"><![CDATA[<p>由于经常需要在各个服务器上安装golang的环境，每次安装的时候都要在网上找教程，还会遇到一些问题，所以还是自己记录一下，防止浪费时间在寻找完整教程上，当然最好是特意加强记忆，下次就不用看教程了。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><strong>方法一、yum安装</strong></p><p>这种方法简单方便，而且安装的go版本也是最新版本，所以不必担心自动安装版本过低的问题。</p><pre class="language-none"><code class="language-none"># yum install golang</code></pre><p>但是安装过程中可能会出现 <code>没有可用软件包 golang</code> 的情况，这是因为缺少 <code>EPEL源</code> ，所以软件仓库中找不到安装的软件包，只要先安装一下erel源即可。</p><pre class="language-none"><code class="language-none"># yum install epel-release</code></pre><p>安装完成后查看go版本号，成功显示就表示安装成功。</p><pre class="language-none"><code class="language-none"># go versiongo version go1.13 linux&#x2F;amd64</code></pre><p><strong>方法二、二进制包安装</strong></p><p>安装包在<a href="https://golang.google.cn/dl/">官网</a>可以下载。</p><p>由于之前安装了go1.13，所以我下载的是go1.12的包，以进行区分。</p><pre class="language-none"><code class="language-none"># wget -P &#x2F;var&#x2F;download https:&#x2F;&#x2F;dl.google.com&#x2F;go&#x2F;go1.12.10.linux-amd64.tar.gz</code></pre><p>然后解压到 /usr/lib 目录，这里跟之前安装的版本所在目录相同，但是需要将之前安装的go文件夹名称改成’golang-1.13’，以免产生冲突。</p><pre class="language-none"><code class="language-none"># tar -zxf &#x2F;var&#x2F;download&#x2F;go1.12.10.linux-amd64.tar.gz -C &#x2F;usr&#x2F;lib&#x2F;</code></pre><p>然后将解压的go文件夹名改成’golang’，进行一个简单的版本切换，再执行查看版本号的指令，发现变成了1.12版本。</p><pre class="language-none"><code class="language-none"># go versiongo version go1.12.10 linux&#x2F;amd64</code></pre><h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><p>通过编辑 <code>/etc/profile</code> 文件配置环境变量。</p><pre class="language-none"><code class="language-none"># vim &#x2F;etc&#x2F;profile在文件的末尾添加如下代码：export GOROOT&#x3D;&#x2F;usr&#x2F;lib&#x2F;golangexport GOPATH&#x3D;&#x2F;var&#x2F;goprojectexport PATH&#x3D;$PATH:$GOROOT&#x2F;bin# source &#x2F;etc&#x2F;profile</code></pre><p>其中工作路径为 ‘/var/goproject’ ，即我们编写的代码放到这个目录下面运行。</p><p>这样golang的环境就搭建好了，可以通过以下指令查看环境参数。</p><pre class="language-none"><code class="language-none"># go env</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;由于经常需要在各个服务器上安装golang的环境，每次安装的时候都要在网上找教程，还会遇到一些问题，所以还是自己记录一下，防止浪费时间在寻找完整教程上，当然最好是特意加强记忆，下次就不用看教程了。&lt;/p&gt;
&lt;h3 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安装&quot; class=&quot;h</summary>
      
    
    
    
    <category term="技术" scheme="https://shuangdeyu.github.io/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Go" scheme="https://shuangdeyu.github.io/tags/Go/"/>
    
  </entry>
  
</feed>
